(self.webpackChunktradingview=self.webpackChunktradingview||[]).push([[60348],{129586:(e,t,i)=>{"use strict";function n(e){return"object"==typeof e&&"metaInfo"in e}function r(e){return null==e}var s;i.d(t,{TelemetryGroup:()=>s,hasMetaInfo:()=>n,isAbsentParam:()=>r}),function(e){e.Fast="fast",e.Medium="medium",e.Slow="slow"}(s||(s={}))},603774:(e,t,i)=>{"use strict";i.d(t,{logPineMetaInfoIssues:()=>o});var n=i(735566),r=i(136734);function s(e,t,i){(0,r.getPersistentLogger)()?.addPersistentLogEntry(`Detected meta info (id: ${e.id}) issue: ${t}. Source: ${i}`,n.LOGLEVEL.ERROR,"PineMetaInfoValidation")}function o(e,t){t&&t.defaults&&t.defaults.inputs&&!t.defaults.inputs.text&&s(t,'no "defaults.inputs.text" value',e),t&&t.inputs&&(t.inputs.find((e=>"text"===e.id))||s(t,'no input with id "text"',e))}},791488:(e,t,i)=>{"use strict";i.d(t,{EMPTY_SOURCE_CODE:()=>u,PINE_SCRIPT_MODIFIED_LOCK:()=>d,RE_MESSAGE_LINE_WITH_DIGITS:()=>c,TV_SCRIPT_DELETED:()=>o,TV_SCRIPT_LEGACY_PINE_PROCESSED:()=>l,TV_SCRIPT_MODIFICATION_ACTIVE:()=>r,TV_SCRIPT_MODIFIED:()=>s,TV_SCRIPT_RENAMED:()=>a,pineTelemetryGroups:()=>p});var n=i(129586);const r="TVScriptModificationActive",s="TVScriptModified",o="TVScriptDeleted",a="TVScriptRenamed",l="TVScriptLegacyPineProcessed",u="Cannot save empty source code",d="pine_script_modified_lock",c=/[l|L]ines? (\d*)/,p=new Map([["delete",n.TelemetryGroup.Fast],["get",n.TelemetryGroup.Fast],["is_auth_to_get",n.TelemetryGroup.Fast],["is_auth_to_write",n.TelemetryGroup.Fast],["parse_title",n.TelemetryGroup.Fast],["rename",n.TelemetryGroup.Fast],["lib_list",n.TelemetryGroup.Fast],["list",n.TelemetryGroup.Medium],["eval_pine_ex",n.TelemetryGroup.Medium],["translate_light",n.TelemetryGroup.Medium],["process_legacy",n.TelemetryGroup.Slow],["publish",n.TelemetryGroup.Slow],["save",n.TelemetryGroup.Slow],["translate",n.TelemetryGroup.Slow],["translate_source",n.TelemetryGroup.Slow],["gen_alert",n.TelemetryGroup.Slow]])},197677:(e,t,i)=>{"use strict";i.d(t,{pineFacadeFetch:()=>p});var n=i(735566),r=i(803912),s=i(881992),o=i(129586),a=i(175203),l=i(791488);const u=(0,n.getLogger)("Chart.Study.Versioning");function d(e,t){const i=new URL(function(e){return e.split("/").map((e=>encodeURIComponent(e))).join("/")}(e),(0,s.getPineFacadeUrl)());for(const e in t){const n=t[e];(0,o.isAbsentParam)(n)||i.searchParams.set(e,String(n))}return i.toString()}function c(e,t){const i={method:e,mode:"cors",credentials:"include"};return"POST"===e&&t&&(i.body=function(e){const t=new FormData;for(const i of Object.keys(e))t.append(i,e[i]);return t}(t)),i}async function p({urlPath:e,urlParams:t,data:i,method:n="GET"}){const s=d(e,t),o=c(n,i),p=function(e){u.logNormal(`Requesting pine facade scripts, url: ${e}`);const t=e.split("/")[0],i=l.pineTelemetryGroups.get(t),n=Date.now();return t=>{const r=Date.now()-n;if(a.telemetry.sendReport("pine",`${i}_group_time_frame`,{value:r}),t)return a.telemetry.sendReport("pine",`${i}_group_ok`),void u.logNormal(`Requesting pine facade scripts finished, url: ${e}`)
;a.telemetry.sendReport("pine",`${i}_group_error`),u.logError(`Requesting pine facade scripts failed, url: ${e}`)}}(e);try{const e=await(0,r.fetch)(s,o);if(!e.ok)throw function(e){return e.status>=500?"Server error, try again or contact support.":413===e.status?"The size of the script compilation request is too large.":420===e.status?"Script title is too long. Max allowed length is 128 characters.":403===e.status?"To use it, ask the author to publish the script.":e.status>=400?"Request error, try again or contact support.":"Something went wrong, try again or contact support."}(e);const t=await e.json();return p(!0),t}catch(e){throw p(!1),e}}},881992:(e,t,i)=>{"use strict";i.d(t,{applyGlobalScriptListeners:()=>m,getOnlyPineStudies:()=>I,getPineFacadeUrl:()=>d,getUserName:()=>u,handleResult:()=>p,handleSaveResult:()=>f,handleTranslateResult:()=>h,isPineReasonData:()=>T,onDeleteScript:()=>v,onLegacyScriptProceed:()=>_,onModifyScript:()=>S,onModifyScriptActiveChanged:()=>y,onRenameScript:()=>g});var n=i(251954),r=i(226722),s=i(971417),o=i(791488),a=i(401843),l=i(129586);function u(){return window.user&&window.user.username}function d(){const e=new URL(window.PINE_URL,location.origin);return e.pathname.endsWith("/")||(e.pathname+="/"),e.href}function c(e){if("object"==typeof e.reason)return e.reason;if(e.reason2)return e.reason2;const t={errors:[],warnings:[]};if((0,l.hasMetaInfo)(e.result)){const i=e.result&&e.result.metaInfo;i&&void 0!==i.warnings&&i.warnings.forEach((e=>t.warnings.push({message:e})))}if(e.reason){(Array.isArray(e.reason)?e.reason:e.reason.split("\n")).forEach((e=>{const i=e.match(o.RE_MESSAGE_LINE_WITH_DIGITS),n=i&&i.length&&Number(i[1]),r={message:e};if("number"==typeof n){r.start={line:n,column:0};const e=r.message.split(": ");e.shift(),r.message=e.join(": ")}t.errors.push(r)}))}return t}function p(e){if(e.success)return e.result;if(e.error)throw e.error;throw c(e)}function h(e){if(e.success)return{success:e.success,metaInfo:e.result.metaInfo,compileErrors:c(e)};throw new a.PineCompileFailErrorImpl(c(e),e.result.metaInfo)}function f(e){if(e.error)throw e.error;return{success:e.success,metaInfo:e.result.metaInfo,compileErrors:c(e)}}function y(e,t,i){const s={scriptIdPart:e,scriptVersionToUpdate:t,active:i};r.TVXWindowEvents.emit(o.TV_SCRIPT_MODIFICATION_ACTIVE,JSON.stringify(s)),n.emit(o.TV_SCRIPT_MODIFICATION_ACTIVE,s),setTimeout((async()=>{const e=await(window.scriptUpdater?.());e?.onModifyScriptActiveChanged(s)}))}function S(e,t,i,s){const a={scriptMetaInfo:e,scriptVersionToUpdate:t,compilationFailed:i,compileErrors:s};r.TVXWindowEvents.emit(o.TV_SCRIPT_MODIFIED,JSON.stringify(a)),n.emit(o.TV_SCRIPT_MODIFIED,a),window.scriptUpdater?.()?.then((e=>e.onTVScriptModified({...a,isSelfCall:!0})))}function v(e){const t={scriptIdPart:e};r.TVXWindowEvents.emit(o.TV_SCRIPT_DELETED,JSON.stringify(t)),n.emit(o.TV_SCRIPT_DELETED,t),setTimeout((async()=>{const e=await(window.scriptUpdater?.());await(e?.onTVScriptDeleted({...t,isSelfCall:!0}))}))}function g(e,t){const i={scriptIdPart:e,scriptName:t}
;r.TVXWindowEvents.emit(o.TV_SCRIPT_RENAMED,JSON.stringify(i)),n.emit(o.TV_SCRIPT_RENAMED,i),setTimeout((async()=>{const e=await(window.scriptUpdater?.());e?.onTVScriptRenamed({...i,isSelfCall:!0})}))}function _(e){const t={scriptMetaInfo:e};r.TVXWindowEvents.emit(o.TV_SCRIPT_LEGACY_PINE_PROCESSED,JSON.stringify(t)),n.emit(o.TV_SCRIPT_LEGACY_PINE_PROCESSED,t),setTimeout((async()=>{const e=await(window.scriptUpdater?.());e?.onTVScriptLegacyPineProcessed(t)}))}function m(e,t,i){r.TVXWindowEvents.on(o.TV_SCRIPT_MODIFICATION_ACTIVE,(async e=>{const t=await(window.scriptUpdater?.());t?.onModifyScriptActiveChanged(JSON.parse(e))})),r.TVXWindowEvents.on(o.TV_SCRIPT_MODIFIED,(async e=>{i.clear();const t=await(window.scriptUpdater?.());t?.onTVScriptModified(JSON.parse(e))})),r.TVXWindowEvents.on(o.TV_SCRIPT_DELETED,(async n=>{e.clear(),t.clear(),i.clear();const r=await(window.scriptUpdater?.());await(r?.onTVScriptDeleted(JSON.parse(n)))})),r.TVXWindowEvents.on(o.TV_SCRIPT_RENAMED,(async e=>{i.clear();const t=await(window.scriptUpdater?.());t?.onTVScriptRenamed(JSON.parse(e))})),r.TVXWindowEvents.on(o.TV_SCRIPT_LEGACY_PINE_PROCESSED,(async e=>{i.clear();const t=await(window.scriptUpdater?.());t?.onTVScriptLegacyPineProcessed(JSON.parse(e))}))}function I(e){return e.filter((e=>{const t=(0,s.extractPineId)(e.metaInfo().id);return t&&(0,s.isCustomPineId)(t)}))}function T(e){return"object"==typeof e&&null!==e&&("errors"in e||"warnings"in e)}},401843:(e,t,i)=>{"use strict";i.d(t,{PineCompileFailErrorImpl:()=>n});class n extends Error{constructor(e,t){super("Pine translation failed"),this.reason=e,this.metaInfo=t}}},427233:(e,t,i)=>{"use strict";i.d(t,{RequestCache:()=>r,SingleRequestCache:()=>s});var n=i(900608);class r{constructor(){this._cache=new Map,window.loginStateChange&&window.loginStateChange.subscribe(this,this.clear)}get(e){return this._cache.get(e)}set(e,t){this._cache.set(e,t)}delete(e){return this._cache.delete(e)}clear(){this._cache.clear()}}class s extends r{constructor(){super(),this._key=(0,n.guid)()}reset(e){super.set(this._key,e)}get(){return super.get(this._key)}clear(){super.clear()}}},398851:(e,t,i)=>{"use strict";i.d(t,{formatStudyError:()=>s,triesTranslateError:()=>r});var n=i(444372);function r(e){return o.get(e)||e}function s(e){return e.format({boldHighlightStart:"<b>",boldHighlightEnd:"</b>"})}
const o=new Map([["You cannot see this pivot timeframe on this resolution",n.t(null,void 0,i(525059))],["The data vendor doesn't provide volume data for this symbol.",n.t(null,void 0,i(81657))],['Histogram is too large, please increase "Row Size" input.',n.t(null,void 0,i(872819))],["Histogram is too large, please reduce 'Row Size' input.",n.t(null,void 0,i(566751))],['Histogram is too large, please increase "Ticks Per Row" input.',n.t(null,void 0,i(594966))],["This script is invite-only. To request access, please contact its author.",n.t(null,void 0,i(276989))],["Volume Profile indicator available only on our upgraded plans.",n.t(null,void 0,i(139903))],["VOLUME_BIST_MIXED",n.t(null,void 0,i(469156))],["Runtime error",n.t(null,void 0,i(660630))],["Access error",n.t(null,void 0,i(377401))],["User-defined error",n.t(null,void 0,i(708580))],["Compilation error",n.t(null,void 0,i(212086))],["Metric error",n.t(null,void 0,i(283111))],["There's no data for your selected period and chart timeframe.",n.t(null,void 0,i(843716))],["The request took too long to process. Ensure you have a stable internet connection. If the issue persists, try decreasing the length of the requested time interval.",n.t(null,void 0,i(499274))],["Unexpected error in Deep Backtesting mode. Contact support for more information.",n.t(null,void 0,i(356815))],["check study unexpected error",n.t(null,void 0,i(83524))],["To calculate the VWAP indicator, more data is needed. Zoom out or scroll left to load more historical data.",n.t(null,void 0,i(841446))],["VWAP is waiting for more data",n.t(null,void 0,i(781030))],["The Bar Magnifier feature is only available to Premium users",n.t(null,void 0,i(945328))],["The bar magnifier is only available to the Premium plan or higher.",n.t(null,void 0,i(935601))]])},418450:(e,t,i)=>{"use strict";i.d(t,{TranslatedString:()=>n});class n{constructor(e,t){this._originalText=e,this._translatedText=t}originalText(){return this._originalText}translatedText(){return this._translatedText}format(e){const t={},i={};for(const r of Object.keys(e)){const s=e[r];s instanceof n?(t[r]=s.originalText(),i[r]=s.translatedText()):(t[r]=s.toString(),i[r]=s.toString())}const r=this._originalText.format(t),s=this._translatedText.format(i);return new n(r,s)}}},886338:(e,t,i)=>{"use strict";i.d(t,{Version:()=>r});var n=i(650151);class r{constructor(e,t){this._major=e,this._minor=t}major(){return this._major}minor(){return this._minor}isZero(){return 0===this._major&&0===this._minor}toString(){return this._major+"."+this._minor}compareTo(e){return this._major<e._major?-1:this._major>e._major?1:this._minor<e._minor?-1:this._minor>e._minor?1:0}isLess(e){return this.compareTo(e)<0}isLessOrEqual(e){return this.compareTo(e)<=0}isEqual(e){return 0===this.compareTo(e)}isGreater(e){return this.compareTo(e)>0}isGreaterOrEqual(e){return this.compareTo(e)>=0}static parse(e){if(e instanceof r)return new r(e.major(),e.minor());if("number"==typeof e)return(0,n.assert)(Math.floor(e)===e,"Version should not be a float number"),new r(e,0)
;if("string"==typeof e){const t=e.split(".");if(1===t.length){const i=parseInt(t[0],10);return(0,n.assert)(!isNaN(i),"Bad version string: "+e),new r(i,0)}if(2===t.length){const i=parseInt(t[0],10);(0,n.assert)(!isNaN(i),"Bad version string: "+e);const s=parseInt(t[1],10);return(0,n.assert)(!isNaN(s),"Bad version string: "+e),new r(i,s)}throw new Error("Bad version string (one dot expected): "+e)}throw new Error("Bad version: "+e)}}r.ZERO=new r(0,0)},751094:(e,t,i)=>{"use strict";i.d(t,{WatchedObject:()=>n.WatchedObject});var n=i(158942)},239949:(e,t,i)=>{"use strict";i.d(t,{InvalidationLevel:()=>n,InvalidationMask:()=>a,defaultInvalidationLevel:()=>o});var n,r=i(650151);class s{constructor(e=o){this._paneInvalidationLevel=o,this._leftPriceScalesInvalidationMap=new Map,this._rightPriceScalesInvalidationMap=new Map,this._legendWidgetInvalidated=!1,this._invalidationLevel=e}fullInvalidation(){return this._invalidationLevel}invalidateAll(e){this._invalidationLevel=Math.max(this._invalidationLevel,e)}invalidatePane(e){this._paneInvalidationLevel=Math.max(this._invalidationLevel,e)}invalidateLegendWidgetLayout(){this._legendWidgetInvalidated=!0}invalidatePriceScale(e,t,i){const n="left"===e?this._leftPriceScalesInvalidationMap:this._rightPriceScalesInvalidationMap,r=n.get(t)||o;n.set(t,Math.max(r,i))}invalidationLevelForPane(){return Math.max(this._paneInvalidationLevel,this._invalidationLevel)}legendWidgetLayoutInvalidated(){return this._legendWidgetInvalidated||this._invalidationLevel===n.Full}getterForPriceScaleInvalidationLevelBySide(e){const t="left"===e?this._leftPriceScalesInvalidationMap:this._rightPriceScalesInvalidationMap;return e=>Math.max(t.get(e)||o,this._invalidationLevel)}priceScaleSideMaxLevel(e){const t="left"===e?this._leftPriceScalesInvalidationMap:this._rightPriceScalesInvalidationMap;let i=this._invalidationLevel;return t.size>0&&t.forEach((e=>{e>i&&(i=e)})),i}merge(e){this._invalidationLevel=Math.max(this._invalidationLevel,e._invalidationLevel),this._paneInvalidationLevel=Math.max(this._paneInvalidationLevel,e._paneInvalidationLevel),e._leftPriceScalesInvalidationMap.forEach(((e,t)=>{const i=this._leftPriceScalesInvalidationMap.get(t)||o;this._leftPriceScalesInvalidationMap.set(t,Math.max(i,e))})),e._rightPriceScalesInvalidationMap.forEach(((e,t)=>{const i=this._rightPriceScalesInvalidationMap.get(t)||o;this._rightPriceScalesInvalidationMap.set(t,Math.max(i,e))})),this._legendWidgetInvalidated=this._legendWidgetInvalidated||e._legendWidgetInvalidated}}!function(e){e[e.None=0]="None",e[e.Cursor=1]="Cursor",e[e.Light=2]="Light",e[e.Full=3]="Full"}(n||(n={}));const o=n.None;class a{constructor(e=o){this._panesOrderChanged=!1,this._keepVisibleTimeRangeOnResize=!1,this._timeScaleInvalidation={level:o,animations:[],invalidateStubs:!1},this._invalidatedPanes=new Map,this._additionalActions=[],this._invalidationLevel=e}invalidateAll(e){this._invalidationLevel!==e&&(this._invalidationLevel=Math.max(this._invalidationLevel,e),this._invalidatedPanes.forEach((e=>{e.invalidateAll(this._invalidationLevel)})))}
invalidateAllPane(e,t){this._invalidatedPanes.has(e)||this._invalidatedPanes.set(e,new s(this._invalidationLevel)),(0,r.ensureDefined)(this._invalidatedPanes.get(e)).invalidateAll(t)}invalidatePriceScale(e,t,i,n){this._invalidatedPanes.has(e)||this._invalidatedPanes.set(e,new s(this._invalidationLevel)),(0,r.ensureDefined)(this._invalidatedPanes.get(e)).invalidatePriceScale(t,i,n)}invalidateTimeScale(e,t=!1){this._timeScaleInvalidation.level=Math.max(this._timeScaleInvalidation.level,e),this._timeScaleInvalidation.invalidateStubs=this._timeScaleInvalidation.invalidateStubs||t}invalidatePanesOrder(){this._panesOrderChanged=!0}lockVisibleTimeRangeOnResize(){this._keepVisibleTimeRangeOnResize=!0}fullInvalidation(){return this._invalidationLevel}maxPaneInvalidation(){const e=[];return this._invalidatedPanes.forEach((t=>{e.push(t.fullInvalidation())})),Math.max(...e,this._invalidationLevel)}invalidationForPane(e){return this._invalidatedPanes.get(e)||new s(this._invalidationLevel)}invalidationForTimeScale(){return{...this._timeScaleInvalidation,level:Math.max(this._timeScaleInvalidation.level,this._invalidationLevel)}}validationActions(){return this._additionalActions}addValidationAction(e){this._additionalActions.push(e)}merge(e){this._invalidationLevel=Math.max(this._invalidationLevel,e._invalidationLevel),this._panesOrderChanged=this._panesOrderChanged||e._panesOrderChanged,this._keepVisibleTimeRangeOnResize=this._keepVisibleTimeRangeOnResize||e._keepVisibleTimeRangeOnResize,this._invalidatedPanes.forEach((e=>{e.invalidateAll(this._invalidationLevel)})),e._invalidatedPanes.forEach(((e,t)=>{this._invalidatedPanes.has(t)||this._invalidatedPanes.set(t,new s(this._invalidationLevel)),(0,r.ensureDefined)(this._invalidatedPanes.get(t)).merge(e)})),this._timeScaleInvalidation.level=Math.max(this._timeScaleInvalidation.level,e._timeScaleInvalidation.level),this._timeScaleInvalidation.invalidateStubs=this._timeScaleInvalidation.invalidateStubs||e._timeScaleInvalidation.invalidateStubs;for(let t=0;t<e._additionalActions.length;t++)this._additionalActions.push(e._additionalActions[t]);for(const t of e._timeScaleInvalidation.animations)this._applyTimeScaleAnimationInvalidation(t)}panesOrderInvalidated(){return this._panesOrderChanged}isVisibleTimeRangeLockedOnResize(){return this._keepVisibleTimeRangeOnResize}setTimeScaleAnimation(e,t){this._removeTimeScaleAnimation(),this._timeScaleInvalidation.animations.push({type:0,value:e,rightOffsetPx:t}),this._invalidationLevel=Math.max(this._invalidationLevel,n.Light)}stopTimeScaleAnimation(){this._removeTimeScaleAnimation(),this._timeScaleInvalidation.animations.push({type:1}),this._invalidationLevel=Math.max(this._invalidationLevel,n.Light)}static cursor(){return new a(n.Cursor)}static light(){return new a(n.Light)}static full(){return new a(n.Full)}static timeScale(e,t=!1){const i=new a;return i.invalidateTimeScale(e,t),i}static panesOrder(){const e=a.full();return e.invalidatePanesOrder(),e}static invalidateLegendWidgetLayout(e){const t=new a;return t._invalidatedPanes.set(e,new s),
t._invalidatedPanes.get(e)?.invalidateLegendWidgetLayout(),t}static validateAction(e){const t=new a;return t._additionalActions.push(e),t}_applyTimeScaleAnimationInvalidation(e){switch(e.type){case 0:this.setTimeScaleAnimation(e.value,e.rightOffsetPx);break;case 1:this._removeTimeScaleAnimation()}}_removeTimeScaleAnimation(){const e=this._timeScaleInvalidation.animations.findIndex((e=>0===e.type));if(-1!==e){const[t]=this._timeScaleInvalidation.animations.splice(e,1);t.value.onFinish?.(!1)}}}},498075:(e,t,i)=>{"use strict";i.d(t,{isLineToolState:()=>o,isMainSeriesState:()=>r,isStudyLineToolState:()=>a,isStudyState:()=>s});var n=i(529751);function r(e){return"MainSeries"===e.type}function s(e){return Boolean(e.type)&&e.type.toLowerCase().startsWith("study")}function o(e){return Boolean(e.type)&&(0,n.isLineToolName)(e.type)}function a(e){return Boolean(e.type)&&(0,n.isStudyLineToolName)(e.type)}},644036:(e,t,i)=>{"use strict";i.d(t,{DataSource:()=>p,getTranslatedStringForSource:()=>d,toInputDisplayFlags:()=>c});var n=i(418450),r=i(816433),s=i(900608),o=i(547465),a=i(923995),l=i(820028),u=i(479483);function d(e,t){return new n.TranslatedString(t.name(),t.title(e))}function c(e){switch(e){case r.TitleDisplayTarget.DataWindow:return u.InputDisplayFlags.DataWindow;case r.TitleDisplayTarget.StatusLine:case r.TitleDisplayTarget.Alerts:return u.InputDisplayFlags.StatusLine}}class p{constructor(e){this.isSeries=!1,this._isDestroyed=!1,this._hasAlert=new l.WatchedValue(!1),this._alertStatus=new l.WatchedValue(0),this._alertCreationAvailable=new l.WatchedValue(a.alertsAvailable),this._zorder=0,this._priceScale=null,this._ownerSource=null,this._userEditEnabled=!0,this._priceScaleChanged=new o.Delegate,this._isSelectionEnabled=!0,this._instanceId=(0,s.randomHashN)(6),this._ownerSourceChanged=new o.Delegate,this._zOrderChanged=new o.Delegate,this._id=new l.WatchedValue(e??(0,s.randomHashN)(6)),a.alertsAvailable&&Promise.resolve().then((()=>{this._isDestroyed||this._hasAlert.subscribe(this._updateAlertCreationAvailable.bind(this),{callWithLast:!0})}))}destroy(){this._isDestroyed=!0}id(){return this._id.value()}idWV(){return this._id.readonly()}instanceId(){return this._instanceId}preferNoScale(){return!1}setId(e){this._id.setValue(e)}zorder(){return this._zorder}setZorder(e){"number"==typeof e&&this._zorder!==e&&(this._zorder=e,this._zOrderChanged.fire(e))}preferredZOrder(){return null}isSpeciallyZOrderedSource(){return!1}title(e){return this.name()}priceScale(){return this._priceScale}hasPriceScale(){return null!==this._priceScale}setPriceScale(e){this._priceScale!==e&&(this._priceScale=e,this._priceScaleChanged.fire(e))}priceScaleChanged(){return this._priceScaleChanged}ownerSource(){return this._ownerSource}setOwnerSource(e){const t=this._ownerSource;this._ownerSource=e,this._ownerSourceChanged.fire(t,e)}ownerSourceChanged(){return this._ownerSourceChanged}zOrderChanged(){return this._zOrderChanged}isSavedInChart(e){return!0}isSavedInStudyTemplates(){return!0}isRemovedByStudyTemplates(){return!0}hasContextMenu(){return!0}
showInObjectTree(){return!0}setUserEditEnabled(e){this._userEditEnabled=e}userEditEnabled(){return this._userEditEnabled}canBeHidden(){return this.userEditEnabled()}isUserDeletable(){return this.userEditEnabled()}properties(){return null}propertyByPath(e){const t=e.split(".");if(t.length<1)throw new Error("Invalid path");const i=t[0];if("properties"===i){const e=this.properties();return 1===t.length?e:e.childByPath(t.slice(1).join("."))}throw new Error(`Unknown property root: ${i}`)}isVisible(){return this.properties().visible.value()}dataWindowView(){return null}priceAxisViews(e,t){return null}timeAxisViews(){return null}updateAllViews(e){}paneViews(e){return null}labelPaneViews(e){return null}isFailed(){return!1}isLoading(){return!1}isPhantom(){return!1}isChildStudy(){return!1}hasChildren(){return!1}canHaveChildren(){return!1}onClickOutside(e,t){}getSourceIcon(){return null}state(e){return null}doesMovingAffectsUndo(){return!0}isMultiPaneAvailable(){return!1}isMultiPaneEnabled(){return!1}copiable(){return!1}cloneable(){return!1}movable(){return!1}allowsMovingBetweenPanes(){return!0}isIncludedInAutoScale(){return!1}isHoveredEnabled(){return this.isSelectionEnabled()}showOnTopOnHovering(){return!0}isSelectionEnabled(){return this._isSelectionEnabled}setSelectionEnabled(e){this._isSelectionEnabled=e}firstValue(){return null}priceRange(e,t,i){return null}autoScaleInfo(e,t,i){return{range:this.priceRange(e,t,i)}}stateForAlert(){return null}async stateForAlertAsync(){return this.stateForAlert()}canHasAlert(){return!1}canHasAlertOnLineTools(){return!1}hasAlert(){return this._hasAlert.readonly()}alertCreationAvailable(){return this._alertCreationAvailable.readonly()}hasStateForAlert(){return a.alertsAvailable}idForAlert(){return this._id.value()}alertStatus(){return this._alertStatus.readonly()}_getAlertCreationAvailable(){return a.alertsAvailable&&this.hasStateForAlert()}_updateAlertCreationAvailable(){a.alertsAvailable&&this._alertCreationAvailable.setValue(this._getAlertCreationAvailable())}}},816433:(e,t,i)=>{"use strict";var n;i.d(t,{TitleDisplayTarget:()=>n}),function(e){e[e.DataWindow=1]="DataWindow",e[e.StatusLine=2]="StatusLine",e[e.Alerts=3]="Alerts"}(n||(n={}))},678949:(e,t,i)=>{"use strict";function n(e){return e?.symbolSource&&e.symbolSource()===e||void 0!==e?.isActingAsSymbolSource}function r(e){return n(e)&&"quotesProvider"in e}function s(e){return n(e)&&e.isActingAsSymbolSource().value()}i.d(t,{isActingAsSymbolSource:()=>s,isSymbolSource:()=>n,isSymbolSourceWithQuotesProvider:()=>r})},529751:(e,t,i)=>{"use strict";i.d(t,{isImageToolName:()=>c,isLineDrawnWithPressedButton:()=>l,isLineToolDrawWithoutPoints:()=>d,isLineToolFinishRequiredWhenCreatedByApi:()=>u,isLineToolName:()=>a,isMtpPredictorToolName:()=>s,isStudyLineToolName:()=>o,isTextToolName:()=>p})
;const n=new Set(["LineStudyMtpAnalysis","LineStudyMtpDecisionPoint","LineStudyMtpRiskReward","LineStudyMtpElliotWaveMain","LineStudyMtpElliotWaveMajor","LineStudyMtpElliotWaveMinor","LineStudyMtpDownWave1OrA","LineStudyMtpDownWave2OrB","LineStudyMtpDownWave3","LineStudyMtpDownWave4","LineStudyMtpDownWave5","LineStudyMtpDownWaveC","LineStudyMtpUpWave1OrA","LineStudyMtpUpWave2OrB","LineStudyMtpUpWave3","LineStudyMtpUpWave4","LineStudyMtpUpWave5","LineStudyMtpUpWaveC"]),r=new Set(["LineToolFibRetracement","LineToolFibChannel","LineToolFibSpeedResistanceArcs","LineToolProjection","LineToolTrendBasedFibExtension","LineToolElliott","LineToolFibCircles","LineToolVertLine","LineToolCrossLine","LineToolBarsPattern","LineToolTrendBasedFibTime","LineToolFibTimeZone","LineToolCircleLines","LineToolDateRange","LineToolPriceRange","LineToolDateAndPriceRange","LineToolParallelChannel","LineToolTrendAngle","LineToolTrendLine","LineToolInfoLine","LineToolArrowMark","LineToolPitchfan","LineToolGannSquare","LineToolFibSpeedResistanceFan","LineToolGannComplex","LineToolGannFixed","LineToolGannFan","LineToolFibWedge","LineToolPitchfork","LineToolDisjointAngle","LineToolFlatBottom","LineToolIcon","LineToolEmoji","LineToolSticker","LineToolRotatedRectangle","LineToolFibSpiral","LineToolHeadAndShoulders","LineToolTriangle","LineToolTrianglePattern","LineTool5PointsPattern","LineToolThreeDrivers","LineToolABCD","LineToolPolyline","LineToolPath","LineToolPrediction","LineToolPriceLabel","LineToolPriceNote","LineToolTextNote","LineToolNote","LineToolNoteAbsolute","LineToolArrowMarker","LineToolSignpost","LineToolBrush","LineToolArc","LineToolCallout","LineToolBalloon","LineToolComment","LineToolText","LineToolHorzLine","LineToolHorzRay","LineToolRectangle","LineToolCircle","LineToolEllipse","LineToolTimeCycles","LineToolSineLine","LineToolGhostFeed","LineToolBezierQuadro","LineToolBezierCubic","LineToolArrow","LineToolRay","LineToolExtended","LineToolSchiffPitchfork","LineToolSchiffPitchfork2","LineToolInsidePitchfork","LineToolTextAbsolute","LineToolArrowMarkLeft","LineToolArrowMarkRight","LineToolArrowMarkUp","LineToolArrowMarkDown","LineToolFlagMark","LineToolCypherPattern","LineToolElliottImpulse","LineToolElliottTriangle","LineToolElliottTripleCombo","LineToolElliottCorrection","LineToolElliottDoubleCombo","LineToolRiskRewardLong","LineToolRiskRewardShort","LineToolPosition","LineToolOrder","LineToolHighlighter","LineToolTable","LineToolImage"]);function s(e){return n.has(e)}function o(e){return"LineToolRegressionTrend"===e||"LineToolVbPFixed"===e||"LineToolFixedRangeVolumeProfile"===e||"LineToolAnchoredVolumeProfile"===e||"LineToolAnchoredVWAP"===e}function a(e){return r.has(e)||o(e)}function l(e){return"LineToolBrush"===e||"LineToolHighlighter"===e}function u(e){return l(e)||"LineToolPath"===e||"LineToolPolyline"===e||"LineToolGhostFeed"===e}function d(e){return"LineToolTweet"===e||"LineToolIdea"===e||"LineToolImage"===e}function c(e){return"LineToolImage"===e}function p(e){switch(e){case"LineToolBalloon":case"LineToolComment":
case"LineToolText":case"LineToolTextAbsolute":case"LineToolCallout":case"LineToolNote":case"LineToolNoteAbsolute":case"LineToolSignpost":return!0}return!1}r.add("LineToolTweet"),r.add("LineToolIdea")},470416:(e,t,i)=>{"use strict";i.d(t,{PriceDataSource:()=>u,isPriceDataSource:()=>l});var n=i(650151),r=i(597773),s=i(644036),o=i(547465),a=i(678949);function l(e){return e instanceof u}class u extends s.DataSource{constructor(e,t){super(t),this._formatterChanged=new o.Delegate,this._priceStepChanged=new o.Delegate,this._currencyChanged=new o.Delegate,this._unitChanged=new o.Delegate,this._priceRangeReadyChanged=new o.Delegate,this._dataRangeUpdated=new o.Delegate,this._priceStep=null,this._signature=new r.WatchedValue(null),this._priceRangeReady=!0,this._model=e}base(){return 0}model(){return this._model}currencyChanged(){return this._currencyChanged}isCurrencySource(){return!0}isDisplayedInLegend(){return!0}unitChanged(){return this._unitChanged}isUnitSource(){return!0}signature(){return this._signature.readonly()}priceRange(e,t,i){return null}isDraggable(){return!0}priceLineColor(e){return e}formatterChanged(){return this._formatterChanged}priceStep(e){return this._priceStep}priceStepChanged(){return this._priceStepChanged}isIncludedInAutoScale(){return!0}tableViewValuesProvider(){return null}chartFloatingTooltipValuesProvider(){return this.valuesProvider()}correctScaleMargins(e){return e}priceRangeReady(){return this._priceRangeReady}priceRangeReadyChanged(){return this._priceRangeReadyChanged}disablePriceRangeReady(){const e=this.priceScale();null===e||e.isAutoScale()||e.mainSource()!==this||(this._priceRangeReady=!1,e.recalculatePriceRangeOnce()),this._priceRangeReadyChanged.fire(!1)}statusView(){return null}legendView(){return null}marketStatusModel(){return null}dataUpdatedModeModel(){return null}dataProblemModel(){return null}alertSourceModel(){return null}canHasAlertOnLineTools(){return!0}dataRangeUpdated(){return this._dataRangeUpdated}_onIndexDiffsApplied(e){const[t,i]=(0,n.ensureNotNull)(this._plotsDataRange());let r=1/0,s=-1/0;for(const t of e)r=Math.min(r,t.old,t.new),s=Math.max(s,t.old,t.new);this._dataRangeUpdated.fire({type:"partial",startIndex:Math.max(r,t),endIndex:Math.min(s,i)})}_plotsDataRange(){return null}_enablePriceRangeReady(){this._priceRangeReady=!0,this._priceRangeReadyChanged.fire(!0)}_onSourceCurrencyChanged(){(0,a.isActingAsSymbolSource)(this)||this._currencyChanged.fire()}_onSourceUnitChanged(){(0,a.isActingAsSymbolSource)(this)||this._unitChanged.fire()}_onSourcePriceRangeReadyChanged(e){(0,a.isActingAsSymbolSource)(this)||e||this.disablePriceRangeReady()}}},730936:(e,t,i)=>{"use strict";i.d(t,{iterateAndPatchObjectsByMap:()=>h,patchPropertiesAsync:()=>p,processLegacy:()=>f});var n=i(650151),r=i(735566),s=i(136734),o=i(925049),a=i(345848),l=i(603774),u=i(111332),d=i(779893);const c=(0,r.getLogger)("Pine.ScriptLib");function p(e,t,i,n=null,o,l){return c.logNormal("patchPropertiesAsync"),l=l??void 0===o,new Promise(((p,f)=>{if(!t.TVScriptMetaInfoExprs)return void p(e)
;const y=t.TVScriptMetaInfoExprs.tree||"",S=t.TVScriptMetaInfoExprs.patchMap||{};(function(e,t){(0,a.trackEvent)("Pine","ScriptLib.evalMetaInfoExprs");const i=d.Deferred(),n={username:window.user&&window.user.username,source:e,inputs:JSON.stringify(t||{})};return(0,u._pineFacadeAjax)("POST","/eval_pine_ex/",n).done(((e,t)=>{e.error?i.reject((0,u._readableError)(e.error,t)):e.success?i.resolve(e.result):i.reject((0,u.safetyGetReason)(e))})).fail((e=>{(0,u._anyRequestAsyncFail)(i,e)})),i.promise()})(y,i).done((i=>{if(!i)return void p(e);if(n?.aborted)return;const a=e.childs().inputs.childs().text.value(),u=i.rootValues;h([e,t.defaults,t],S,((t,i,n)=>{const r=u[n],s=t[0],a=t[1],d=t[2];if(l||void 0!==o?.[n]&&o[n]!==r)if(a?.hasOwnProperty(i)&&d?.hasOwnProperty(i)&&c.logError(`Inconsistent meta info structure: both defaults and meta have property ${i}`),a?.hasOwnProperty(i)){const t=s[i];e.childs()?.patchMetaInfoDefaults?.value()?((l||t.value()===a[i])&&t.setValue(r),a[i]=r):t.setValue(r)}else d[i]=r})),void 0!==o&&Object.keys(u).forEach((e=>{void 0!==o[e]&&(o[e]=u[e])}));const d=e.childs().inputs.childs().text.value();a&&!d&&(0,s.getPersistentLogger)()?.addPersistentLogEntry(`Detected invalid meta info evaluation expression result: IL code input value is empty, id: ${t.fullId}`,r.LOGLEVEL.ERROR,"PineMetaInfoValidation"),p(e)})).fail((e=>{f(e)}))}))}function h(e,t,i){const r=Object.keys(t);for(let s=0;s<r.length;s++){const o=r[s],a=t[o],l=o.split(".");"defaults"===l[0]&&l.splice(0,1),(0,n.assert)(l.length>1,"Unexpectedly short json path");let u=[...e];for(let e=0;e<l.length-1;++e){const t=l[e];u=u.map((e=>e?e[t]:null))}i(u,l[l.length-1],a)}}function f(e,t){(0,a.trackEvent)("Pine","ScriptLib.processLegacy");const i=(0,o.createDeferredPromise)(),n=window.user&&window.user.username,r="/process_legacy/"+encodeURIComponent(e)+"/?user_name="+encodeURIComponent(n),s=t?{source:t}:{};return(0,u._pineFacadeAjax)("POST",r,s).done((e=>{e.error?i.reject((0,u._readableError)(e.error)):e.success?((0,l.logPineMetaInfoIssues)("ScriptLib.processLegacy",e.result.metaInfo),i.resolve(e.result.metaInfo)):i.reject((0,u.safetyGetReason)(e))})).fail((e=>{(0,u._anyRequestAsyncFail)(i,e)})),i.promise}},232915:(e,t,i)=>{"use strict";i.d(t,{StatusProviderBase:()=>n});class n{size(){return"13px"}bold(){return!1}titleTooltip(){}}},236578:(e,t,i)=>{"use strict";i.d(t,{StatusView:()=>n});class n{constructor(e){this._text="",this._color="",this._size="13px",this._bold=!1,this._statusProvider=e}text(){return this._text}getSplitTitle(){return[this._text]}getInputsTitles(){return null}titleTooltip(){return this._statusProvider.titleTooltip()}bold(){return this._bold}size(){return this._size}}},301320:(e,t,i)=>{"use strict";i.d(t,{migrateMetaInfoAndPropState:()=>d});var n=i(650151),r=i(807958),s=i(536794);const o=["PennantCP@tv-basicstudies","WedgeCP@tv-basicstudies"],a=["DoubleTopCP@tv-basicstudies","BullishFlagCP@tv-basicstudies","HeadAndShouldersCP@tv-basicstudies","TripleTopCP@tv-basicstudies"];class l{targetMetaInfoVersion(){return 53}migrateMetaInfo(e){
const t=e,i=e;if(i._metainfoVersion=53,void 0!==t.defaults&&void 0!==t.defaults.inputs&&(o.includes(t.id)||a.includes(t.id)&&Number(t.version)<156)){const e=t.defaults.inputs["Invert Pattern"];i.id=this._getNewIdStudies(t.id,e)}}migratePropState(e){}_getNewIdStudies(e,t){return e.startsWith("WedgeCP")?t?"WedgeFallingCP@tv-basicstudies":"WedgeRisingCP@tv-basicstudies":e.startsWith("PennantCP")?t?"PennantBearishCP@tv-basicstudies":"PennantBullishCP@tv-basicstudies":e.startsWith("DoubleTopCP")&&t?"DoubleBottomCP@tv-basicstudies":e.startsWith("BullishFlagCP")&&t?"BearishFlagCP@tv-basicstudies":e.startsWith("HeadAndShouldersCP")&&t?"HeadAndShouldersInverseCP@tv-basicstudies":e.startsWith("TripleTopCP")&&t?"TripleBottomCP@tv-basicstudies":e}}const u=[new class{targetMetaInfoVersion(){return 47}migrateMetaInfo(e){const t=e,i=e;if(i._metainfoVersion=47,!t.defaults||void 0===t.defaults.precision)return void(i.format={type:"inherit"});const n=t.defaults&&t.defaults.precision,r=(0,s.isNumber)(n)?n:parseInt(n);0===r?i.format={type:"volume"}:isFinite(r)?i.format={type:"price",precision:r}:i.format={type:"inherit"},delete t.defaults.precision}migratePropState(e){}},new class{targetMetaInfoVersion(){return 50}migrateMetaInfo(e){const t=e,i=e;if(i._metainfoVersion=50,void 0===t.defaults||void 0===t.defaults.ohlcPlots||void 0===t.ohlcPlots)return;const r=t.ohlcPlots,s=t.defaults.ohlcPlots,o=(0,n.ensureDefined)((0,n.ensureDefined)(i.defaults).ohlcPlots);for(const e of Object.keys(s)){const t=s[e];if("ohlc_candles"===t.plottype){let i=!1;const n=r[e];void 0!==n&&(i=!!n.drawBorder,delete n.drawBorder),o[e]={borderColor:"#000000",drawBorder:i,...t}}}}migratePropState(e){}},new class{targetMetaInfoVersion(){return 53}migrateMetaInfo(e){const t=e,i=e;if(i._metainfoVersion=53,void 0!==t.defaults){if(void 0!==t.defaults.ohlcPlots&&void 0!==t.ohlcPlots){const e=Object.keys(t.ohlcPlots),r=t.defaults.ohlcPlots,s=(0,n.ensureDefined)((0,n.ensureDefined)(i.defaults).ohlcPlots);for(const t of e){const e=r[t];if(void 0===e||void 0===e.visible)continue;const i=e.visible?15:0;delete e.visible,s[t]={display:i,...e}}}if(void 0!==t.defaults.styles&&void 0!==t.plots){const e=t.plots.map((e=>e.id)),r=t.defaults.styles,s=(0,n.ensureDefined)((0,n.ensureDefined)(i.defaults).styles);for(const t of e){const e=r[t];if(void 0===e||void 0===e.visible)continue;const i=e.visible?15:0;delete e.visible,s[t]={display:i,...e}}}}}migratePropState(e){if(e.ohlcPlots)for(const t of Object.keys(e.ohlcPlots)){const i=(0,n.ensureDefined)(e.ohlcPlots[t]);void 0!==i.visible&&(i.display=i.visible?15:0,delete i.visible)}if(e.styles)for(const t of Object.keys(e.styles)){const i=(0,n.ensureDefined)(e.styles[t]);void 0!==i.visible&&(i.display=i.visible?15:0,delete i.visible)}}}];function d(e,t){const i=r.StudyMetaInfo.versionOf(e),s=e;void 0===s._serverMetaInfoVersion&&(s._serverMetaInfoVersion=i);const o=["PennantCP@tv-basicstudies","WedgeCP@tv-basicstudies"].includes(e.id);u.forEach((r=>{(i<0||i>=r.targetMetaInfoVersion())&&!o||(r.migrateMetaInfo(e),
void 0!==t&&r.migratePropState(t),(0,n.assert)(e._metainfoVersion===r.targetMetaInfoVersion()))}))}u.push(new l),u.sort((function(e,t){return e.targetMetaInfoVersion()-t.targetMetaInfoVersion()}))},340993:(e,t,i)=>{"use strict";function n(e,t="shift",i){return{studyConstructorAsyncGetter:e,colorRotationMode:t,colorRotationComparator:i}}i.d(t,{addStudyInfoToMap:()=>s,createStudyInfo:()=>n,getStudyClassName:()=>a,getStudyInfoByName:()=>o});const r=new Map;function s(e,t){r.set(e,t)}function o(e){return r.get(e)}function a(e){for(const[t,i]of r.entries())if(i.studyConstructor===e)return t;return null}},128090:(e,t,i)=>{"use strict";i.d(t,{createStudy:()=>T,hasConfirmInputs:()=>w,isCompareOrOverlayStudy:()=>m,isESDStudy:()=>v,isFundamentalStudy:()=>S,isOverlayStudy:()=>_,isRollDatesStudy:()=>g,isStudy:()=>p,isStudyStrategy:()=>f,isStudyStub:()=>y,isSymbolicStudy:()=>C,studyColorRotationMode:()=>P,useSameColorRotationComparator:()=>L});var n=i(688987),r=i(650151),s=(i(931924),i(807958)),o=i(507733),a=i(79428),l=i(340993),u=i(644036);const d=(0,l.createStudyInfo)((()=>Promise.all([i.e(32856),i.e(18880),i.e(2353),i.e(24951),i.e(80233),i.e(24913),i.e(25214),i.e(53159),i.e(88741),i.e(32565),i.e(7351),i.e(69955),i.e(7815),i.e(23301),i.e(27860),i.e(5071),i.e(31882),i.e(90390),i.e(59987),i.e(53226),i.e(1346),i.e(28070),i.e(134),i.e(44293),i.e(81183),i.e(66368),i.e(76858),i.e(57539)]).then(i.bind(i,605071)).then((e=>e.Study))));(0,l.addStudyInfoToMap)("Study",d),(0,l.addStudyInfoToMap)("study_PivotPointsStandard",(0,l.createStudyInfo)((()=>Promise.all([i.e(32856),i.e(18880),i.e(2353),i.e(24951),i.e(80233),i.e(24913),i.e(25214),i.e(53159),i.e(88741),i.e(32565),i.e(7351),i.e(69955),i.e(7815),i.e(23301),i.e(27860),i.e(5071),i.e(31882),i.e(90390),i.e(59987),i.e(53226),i.e(1346),i.e(28070),i.e(134),i.e(44293),i.e(81183),i.e(66368),i.e(76858),i.e(57539)]).then(i.bind(i,698703)).then((e=>e.study_PivotPointsStandard))))),(0,l.addStudyInfoToMap)("study_Overlay",(0,l.createStudyInfo)((()=>Promise.all([i.e(32856),i.e(18880),i.e(2353),i.e(24951),i.e(80233),i.e(24913),i.e(25214),i.e(53159),i.e(88741),i.e(32565),i.e(7351),i.e(69955),i.e(7815),i.e(23301),i.e(27860),i.e(5071),i.e(31882),i.e(90390),i.e(59987),i.e(53226),i.e(1346),i.e(28070),i.e(134),i.e(44293),i.e(81183),i.e(66368),i.e(76858),i.e(57539)]).then(i.bind(i,333807)).then((e=>e.study_Overlay))),"sexyColors")),(0,l.addStudyInfoToMap)("study_Compare",(0,l.createStudyInfo)((()=>Promise.all([i.e(32856),i.e(18880),i.e(2353),i.e(24951),i.e(80233),i.e(24913),i.e(25214),i.e(53159),i.e(88741),i.e(32565),i.e(7351),i.e(69955),i.e(7815),i.e(23301),i.e(27860),i.e(5071),i.e(31882),i.e(90390),i.e(59987),i.e(53226),i.e(1346),i.e(28070),i.e(134),i.e(44293),i.e(81183),i.e(66368),i.e(76858),i.e(57539)]).then(i.bind(i,576722)).then((e=>e.StudyCompare))),"sexyColors")),(0,l.addStudyInfoToMap)("study_Volume",(0,
l.createStudyInfo)((()=>Promise.all([i.e(32856),i.e(18880),i.e(2353),i.e(24951),i.e(80233),i.e(24913),i.e(25214),i.e(53159),i.e(88741),i.e(32565),i.e(7351),i.e(69955),i.e(7815),i.e(23301),i.e(27860),i.e(5071),i.e(31882),i.e(90390),i.e(59987),i.e(53226),i.e(1346),i.e(28070),i.e(134),i.e(44293),i.e(81183),i.e(66368),i.e(76858),i.e(57539)]).then(i.bind(i,42212)).then((e=>e.VolumeStudy))))),(0,l.addStudyInfoToMap)("study_VbPVisible",(0,l.createStudyInfo)((()=>Promise.all([i.e(32856),i.e(18880),i.e(2353),i.e(24951),i.e(80233),i.e(24913),i.e(25214),i.e(53159),i.e(88741),i.e(32565),i.e(7351),i.e(69955),i.e(7815),i.e(23301),i.e(27860),i.e(5071),i.e(31882),i.e(90390),i.e(59987),i.e(53226),i.e(1346),i.e(28070),i.e(134),i.e(44293),i.e(81183),i.e(66368),i.e(76858),i.e(57539)]).then(i.bind(i,833214)).then((e=>e.VbPVisibleWrapper))),"noRotations")),(0,l.addStudyInfoToMap)("study_VbPFixed",(0,l.createStudyInfo)((()=>Promise.all([i.e(32856),i.e(18880),i.e(2353),i.e(24951),i.e(80233),i.e(24913),i.e(25214),i.e(53159),i.e(88741),i.e(32565),i.e(7351),i.e(69955),i.e(7815),i.e(23301),i.e(27860),i.e(5071),i.e(31882),i.e(90390),i.e(59987),i.e(53226),i.e(1346),i.e(28070),i.e(134),i.e(44293),i.e(81183),i.e(66368),i.e(76858),i.e(57539)]).then(i.bind(i,833214)).then((e=>e.VolumeProfileStudyWithThemedColors))),"noRotations")),(0,l.addStudyInfoToMap)("study_ScriptWithDataOffset",(0,l.createStudyInfo)((()=>Promise.all([i.e(32856),i.e(18880),i.e(2353),i.e(24951),i.e(80233),i.e(24913),i.e(25214),i.e(53159),i.e(88741),i.e(32565),i.e(7351),i.e(69955),i.e(7815),i.e(23301),i.e(27860),i.e(5071),i.e(31882),i.e(90390),i.e(59987),i.e(53226),i.e(1346),i.e(28070),i.e(134),i.e(44293),i.e(81183),i.e(66368),i.e(76858),i.e(57539)]).then(i.bind(i,231406)).then((e=>e.study_ScriptWithDataOffset))))),(0,l.addStudyInfoToMap)("study_Earnings",(0,l.createStudyInfo)((()=>Promise.all([i.e(32856),i.e(18880),i.e(2353),i.e(24951),i.e(80233),i.e(24913),i.e(25214),i.e(53159),i.e(88741),i.e(32565),i.e(7351),i.e(69955),i.e(7815),i.e(23301),i.e(27860),i.e(5071),i.e(31882),i.e(90390),i.e(59987),i.e(53226),i.e(1346),i.e(28070),i.e(134),i.e(44293),i.e(81183),i.e(66368),i.e(76858),i.e(57539)]).then(i.bind(i,859849)).then((e=>e.study_ESD$TV_EARNINGS))))),(0,l.addStudyInfoToMap)("study_Splits",(0,l.createStudyInfo)((()=>Promise.all([i.e(32856),i.e(18880),i.e(2353),i.e(24951),i.e(80233),i.e(24913),i.e(25214),i.e(53159),i.e(88741),i.e(32565),i.e(7351),i.e(69955),i.e(7815),i.e(23301),i.e(27860),i.e(5071),i.e(31882),i.e(90390),i.e(59987),i.e(53226),i.e(1346),i.e(28070),i.e(134),i.e(44293),i.e(81183),i.e(66368),i.e(76858),i.e(57539)]).then(i.bind(i,859849)).then((e=>e.study_ESD$TV_SPLITS))))),(0,l.addStudyInfoToMap)("study_Dividends",(0,
l.createStudyInfo)((()=>Promise.all([i.e(32856),i.e(18880),i.e(2353),i.e(24951),i.e(80233),i.e(24913),i.e(25214),i.e(53159),i.e(88741),i.e(32565),i.e(7351),i.e(69955),i.e(7815),i.e(23301),i.e(27860),i.e(5071),i.e(31882),i.e(90390),i.e(59987),i.e(53226),i.e(1346),i.e(28070),i.e(134),i.e(44293),i.e(81183),i.e(66368),i.e(76858),i.e(57539)]).then(i.bind(i,859849)).then((e=>e.study_ESD$TV_DIVIDENDS))))),(0,l.addStudyInfoToMap)("study_BarSetContinuousRollDates",(0,l.createStudyInfo)((()=>Promise.all([i.e(32856),i.e(18880),i.e(2353),i.e(24951),i.e(80233),i.e(24913),i.e(25214),i.e(53159),i.e(88741),i.e(32565),i.e(7351),i.e(69955),i.e(7815),i.e(23301),i.e(27860),i.e(5071),i.e(31882),i.e(90390),i.e(59987),i.e(53226),i.e(1346),i.e(28070),i.e(134),i.e(44293),i.e(81183),i.e(66368),i.e(76858),i.e(57539)]).then(i.bind(i,31857)).then((e=>e.study_ESD$TV_ROLLDATES))))),(0,l.addStudyInfoToMap)(a.fundamentalsPrefix,(0,l.createStudyInfo)((()=>Promise.all([i.e(32856),i.e(18880),i.e(2353),i.e(24951),i.e(80233),i.e(24913),i.e(25214),i.e(53159),i.e(88741),i.e(32565),i.e(7351),i.e(69955),i.e(7815),i.e(23301),i.e(27860),i.e(5071),i.e(31882),i.e(90390),i.e(59987),i.e(53226),i.e(1346),i.e(28070),i.e(134),i.e(44293),i.e(81183),i.e(66368),i.e(76858),i.e(57539)]).then(i.bind(i,190484)).then((e=>e.Fundamental))),(e=>1===e.plots.length?"loop":"noRotations"),((e,t)=>(0,a.isFundamentalStudyMetaInfo)(t)))),(0,l.addStudyInfoToMap)("study_ElliottWave",(0,l.createStudyInfo)((()=>Promise.all([i.e(32856),i.e(10637),i.e(80233),i.e(24913),i.e(63317),i.e(88741),i.e(32565),i.e(7351),i.e(69955),i.e(7815),i.e(23301),i.e(27860),i.e(5071),i.e(31882),i.e(90390),i.e(53226),i.e(6706)]).then(i.bind(i,288489)).then((e=>e.study_ElliottWave))))),(0,l.addStudyInfoToMap)("study_LinearRegression",(0,l.createStudyInfo)((()=>Promise.all([i.e(32856),i.e(18880),i.e(2353),i.e(24951),i.e(80233),i.e(24913),i.e(25214),i.e(53159),i.e(88741),i.e(32565),i.e(7351),i.e(69955),i.e(7815),i.e(23301),i.e(27860),i.e(5071),i.e(31882),i.e(90390),i.e(59987),i.e(53226),i.e(1346),i.e(28070),i.e(134),i.e(44293),i.e(81183),i.e(66368),i.e(76858),i.e(57539)]).then(i.bind(i,780631)).then((e=>e.LinearRegressionStudy))))),(0,l.addStudyInfoToMap)("study_PivotPointsHighLow",(0,l.createStudyInfo)((()=>Promise.all([i.e(32856),i.e(10637),i.e(80233),i.e(24913),i.e(88741),i.e(32565),i.e(7351),i.e(69955),i.e(7815),i.e(23301),i.e(27860),i.e(5071),i.e(31882),i.e(90390),i.e(53226),i.e(36552)]).then(i.bind(i,495353)).then((e=>e.study_PivotPointsHighLow))))),(0,l.addStudyInfoToMap)("study_VbPSessions",(0,l.createStudyInfo)((()=>Promise.all([i.e(32856),i.e(18880),i.e(2353),i.e(24951),i.e(80233),i.e(24913),i.e(25214),i.e(53159),i.e(88741),i.e(32565),i.e(7351),i.e(69955),i.e(7815),i.e(23301),i.e(27860),i.e(5071),i.e(31882),i.e(90390),i.e(59987),i.e(53226),i.e(1346),i.e(28070),i.e(134),i.e(44293),i.e(81183),i.e(66368),i.e(76858),i.e(57539)]).then(i.bind(i,238308)).then((e=>e.SessionVolumeStudy))),"noRotations")),(0,l.addStudyInfoToMap)("study_VbPPeriodic",(0,
l.createStudyInfo)((()=>Promise.all([i.e(32856),i.e(18880),i.e(2353),i.e(24951),i.e(80233),i.e(24913),i.e(25214),i.e(53159),i.e(88741),i.e(32565),i.e(7351),i.e(69955),i.e(7815),i.e(23301),i.e(27860),i.e(5071),i.e(31882),i.e(90390),i.e(59987),i.e(53226),i.e(1346),i.e(28070),i.e(134),i.e(44293),i.e(81183),i.e(66368),i.e(76858),i.e(57539)]).then(i.bind(i,833214)).then((e=>e.VolumeProfileWithPriceRangeStudy))),"noRotations")),(0,l.addStudyInfoToMap)("study_VbPSessionsRoughDetailed",(0,l.createStudyInfo)((()=>Promise.all([i.e(32856),i.e(18880),i.e(2353),i.e(24951),i.e(80233),i.e(24913),i.e(25214),i.e(53159),i.e(88741),i.e(32565),i.e(7351),i.e(69955),i.e(7815),i.e(23301),i.e(27860),i.e(5071),i.e(31882),i.e(90390),i.e(59987),i.e(53226),i.e(1346),i.e(28070),i.e(134),i.e(44293),i.e(81183),i.e(66368),i.e(76858),i.e(57539)]).then(i.bind(i,926801)).then((e=>e.SessionVolume2Study))),"noRotations")),(0,l.addStudyInfoToMap)("study_ZigZag",(0,l.createStudyInfo)((()=>Promise.all([i.e(32856),i.e(10637),i.e(80233),i.e(24913),i.e(88741),i.e(32565),i.e(7351),i.e(69955),i.e(7815),i.e(23301),i.e(27860),i.e(5071),i.e(31882),i.e(90390),i.e(53226),i.e(70593)]).then(i.bind(i,843011)).then((e=>e.study_ZigZag))))),(0,l.addStudyInfoToMap)("study_VbPAutoAnchored",(0,l.createStudyInfo)((()=>Promise.all([i.e(32856),i.e(18880),i.e(2353),i.e(24951),i.e(80233),i.e(24913),i.e(25214),i.e(53159),i.e(88741),i.e(32565),i.e(7351),i.e(69955),i.e(7815),i.e(23301),i.e(27860),i.e(5071),i.e(31882),i.e(90390),i.e(59987),i.e(53226),i.e(1346),i.e(28070),i.e(134),i.e(44293),i.e(81183),i.e(66368),i.e(76858),i.e(57539)]).then(i.bind(i,833214)).then((e=>e.VolumeProfileStudyWithThemedColors))),"noRotations")),(0,l.addStudyInfoToMap)("study_TPOPeriodic",(0,l.createStudyInfo)((()=>Promise.all([i.e(32856),i.e(18880),i.e(2353),i.e(24951),i.e(80233),i.e(24913),i.e(25214),i.e(53159),i.e(88741),i.e(32565),i.e(7351),i.e(69955),i.e(7815),i.e(23301),i.e(27860),i.e(5071),i.e(31882),i.e(90390),i.e(59987),i.e(53226),i.e(1346),i.e(28070),i.e(134),i.e(44293),i.e(81183),i.e(66368),i.e(76858),i.e(57539)]).then(i.bind(i,141653)).then((e=>e.TpoPeriodicStudy))))),(0,l.addStudyInfoToMap)("study_TPOSessions",(0,l.createStudyInfo)((()=>Promise.all([i.e(32856),i.e(18880),i.e(2353),i.e(24951),i.e(80233),i.e(24913),i.e(25214),i.e(53159),i.e(88741),i.e(32565),i.e(7351),i.e(69955),i.e(7815),i.e(23301),i.e(27860),i.e(5071),i.e(31882),i.e(90390),i.e(59987),i.e(53226),i.e(1346),i.e(28070),i.e(134),i.e(44293),i.e(81183),i.e(66368),i.e(76858),i.e(57539)]).then(i.bind(i,861715)).then((e=>e.TpoSessionsStudy))))),(0,l.addStudyInfoToMap)("study_VolumeFootprint",(0,l.createStudyInfo)((()=>Promise.all([i.e(32856),i.e(18880),i.e(2353),i.e(24951),i.e(80233),i.e(24913),i.e(25214),i.e(53159),i.e(88741),i.e(32565),i.e(7351),i.e(69955),i.e(7815),i.e(23301),i.e(27860),i.e(5071),i.e(31882),i.e(90390),i.e(59987),i.e(53226),i.e(1346),i.e(28070),i.e(134),i.e(44293),i.e(81183),i.e(66368),i.e(76858),i.e(57539)]).then(i.bind(i,766368)).then((e=>e.VolumeFootprintStudy))))),(0,l.addStudyInfoToMap)("StudyStrategy",(0,
l.createStudyInfo)((()=>Promise.all([i.e(32856),i.e(18880),i.e(2353),i.e(24951),i.e(80233),i.e(24913),i.e(25214),i.e(53159),i.e(88741),i.e(32565),i.e(7351),i.e(69955),i.e(7815),i.e(23301),i.e(27860),i.e(5071),i.e(31882),i.e(90390),i.e(59987),i.e(53226),i.e(1346),i.e(28070),i.e(134),i.e(44293),i.e(81183),i.e(66368),i.e(76858),i.e(57539)]).then(i.bind(i,252010)).then((e=>e.StudyStrategy))))),(0,l.addStudyInfoToMap)("ReplayStudyStrategy",(0,l.createStudyInfo)((()=>Promise.all([i.e(32856),i.e(18880),i.e(2353),i.e(24951),i.e(80233),i.e(24913),i.e(25214),i.e(53159),i.e(88741),i.e(32565),i.e(7351),i.e(69955),i.e(7815),i.e(23301),i.e(27860),i.e(5071),i.e(31882),i.e(90390),i.e(59987),i.e(53226),i.e(1346),i.e(28070),i.e(134),i.e(44293),i.e(81183),i.e(66368),i.e(76858),i.e(57539)]).then(i.bind(i,445296)).then((e=>e.ReplayStudyStrategy)))));const c=["studyName","guiPlotName","isLinkedToSeries"];function p(e){return c.every((t=>t in e))}const h=["strategyOrdersPaneView","ordersData","reportData"];function f(e){return p(e)&&h.every((t=>t in e))}function y(e){return e instanceof o.StudyStub}function S(e){return p(e)&&(0,a.isFundamentalStudyMetaInfo)(e.metaInfo())}function v(e){return e instanceof u.DataSource&&("ESD$TV_EARNINGS"===e.id()||"ESD$TV_SPLITS"===e.id()||"ESD$TV_DIVIDENDS"===e.id())}function g(e){return e instanceof u.DataSource&&"ESD$TV_ROLLDATES"===e.id()}function _(e){return p(e)&&"Overlay@tv-basicstudies"===e.metaInfo().id}function m(e){return _(e)||p(e)&&"Compare@tv-basicstudies"===e.metaInfo().id}let I=0;async function T(e,t,i,n,o,u,c,p){let h;const f=2===c;if(s.StudyMetaInfo.isReplayStrategy(n)&&(h=(0,l.getStudyInfoByName)("ReplayStudyStrategy")),s.StudyMetaInfo.isScriptStrategy(n)&&(h=(0,l.getStudyInfoByName)("StudyStrategy")),!h){const e=(0,a.studyNameByMetaInfo)(n);h=(0,l.getStudyInfoByName)(e??"Study")??d}h.studyConstructor||(I+=1,h.studyConstructor=await(0,r.ensureDefined)(h.studyConstructorAsyncGetter)(),I-=1);const y=new((0,r.ensureDefined)(h?.studyConstructor))(e,t,i,n,o,f,!!p);return void 0!==u&&y.setId(u),y}function P(e){const t=(0,a.studyNameByMetaInfo)(e),i=(0,l.getStudyInfoByName)(t);return i?(0,n.default)(i.colorRotationMode)?i.colorRotationMode(e):i.colorRotationMode:void 0===e.pine||s.StudyMetaInfo.isStandardPine(e.id)?1!==e.plots.length?"shift":"loop":null}function b(e,t){return e.id===t.id&&(n=t,((i=e).pine?i.pine.version:void 0)===(n.pine?n.pine.version:void 0));var i,n}function L(e){const t=(0,a.studyNameByMetaInfo)(e),i=(0,l.getStudyInfoByName)(t);if(i){const e=i.colorRotationComparator;if(void 0!==e)return e}return b}function w(e){return(e??[]).some((e=>e.confirm))}const M=["Overlay@tv-basicstudies","CorrelationCoefficient@tv-basicstudies","Correlation Coeff@tv-basicstudies","Spread@tv-basicstudies","Ratio@tv-basicstudies"];function C(e){return M.includes(e.id)}},479483:(e,t,i)=>{"use strict";i.d(t,{ChartColorDependentStudyInputNames:()=>s,InputDisplayFlags:()=>n,RangeDependentStudyInputNames:()=>r,areStudyInputsEqual:()=>c,editableStudyInputs:()=>f,getInputValue:()=>u,isExtendedInput:()=>a,
isExtendedInputBool:()=>v,isExtendedInputSource:()=>l,isStudyInputDependsOnChart:()=>S,isStudyInputDependsOnChartColors:()=>y,isStudyInputOptionsInfo:()=>d,isTimeOrPriceNotHiddenInput:()=>h,rangeDependentStudyInputsToTimeRange:()=>p});var n,r,s,o=i(182433);function a(e){return(0,o.default)(e)}function l(e){return"source"===e.t}function u(e){return a(e)?e.v:e}function d(e){return["text","integer","float","price","session","resolution"].includes(e.type)&&e.hasOwnProperty("options")}function c(e,t,i){for(const n of e)if(t[n.id]!==i[n.id])return!1;return!0}function p(e){return{from:Math.round(e.first_visible_bar_time/1e3),to:Math.round(e.last_visible_bar_time/1e3)}}function h(e){return("time"===e.type||"price"===e.type)&&!0!==e.isHidden}function f(e){const t=e.filter(h);if(0===t.length)return[];const i=new Map,n=[];t.forEach((e=>{const{group:t,inline:r}=e;if(void 0===r)return void n.push(e);const s=r+(t||"");if(i.has(s))i.get(s)?.push(e);else{const t=[e];i.set(s,t),n.push(t)}}));const r=[];for(let e=0;e<n.length;e++){const t=n[e];Array.isArray(t)?2===t.length&&t[0].type!==t[1].type?r.push(t):r.push(...t):r.push(t)}return r}function y(e){return Object.values(s).map((e=>e)).includes(e.id)}function S(e){return!!y(e)||Object.values(r).map((e=>e)).includes(e.id)}function v(e){return(0,o.default)(e)&&"t"in e&&"bool"===e.t&&"v"in e&&"boolean"==typeof e.v}!function(e){e[e.None=0]="None",e[e.DataWindow=2]="DataWindow",e[e.StatusLine=8]="StatusLine",e[e.All=15]="All"}(n||(n={})),function(e){e.FirstBar="first_visible_bar_time",e.LastBar="last_visible_bar_time",e.Realtime="subscribeRealtime"}(r||(r={})),function(e){e.FgColor="__chart_fgcolor",e.BgColor="__chart_bgcolor"}(s||(s={}))},87347:(e,t,i)=>{"use strict";i.d(t,{emptyPineId:()=>y,isStudyDescriptor:()=>S,studyMetaInfoRepository:()=>m});var n=i(481251),r=i(444372),s=i(650151),o=i(807958),a=i(301320),l=i(886338),u=i(192809),d=i(520533),c=i(401843),p=i(735566),h=i(925049);const f=(0,p.getLogger)("Chart.Studies.StudyMetaInfoRepository",{color:"#606"}),y="";function S(e){return"object"==typeof e&&null!==e&&"type"in e&&("java"===e.type&&"studyId"in e||"pine"===e.type&&"pineId"in e)}class v{constructor(e){this._isReady=!1,this._studyVersioning=null,this._rawStudiesMetaInfo=[],this._rawStudiesMetaInfoDeferredPromise=null,this._javaStudiesMetaInfo=[],this._pineMetaInfoCache=[],this._compileErrors=new WeakMap,this._studiesMigrations=[],this._chartApi=e}async requestMetaInfo(){if(null===this._rawStudiesMetaInfoDeferredPromise){this._rawStudiesMetaInfoDeferredPromise=(0,h.createDeferredPromise)();const e=await this._chartApi.requestMetadata(),t=e.params[1].metainfo.slice();{const i=e.params[1].migrations.slice();this._processSiteMetaInfo(t,i)}this._studyVersioning=new u.StudyVersioning(this._javaStudiesMetaInfo,this._studiesMigrations),this._requestFinished(),this._rawStudiesMetaInfoDeferredPromise.resolve(this._rawStudiesMetaInfo)}return this._rawStudiesMetaInfoDeferredPromise.promise}async findById(e){this._isReady||await this.requestMetaInfo();const t=this._findStudyMetaInfo(e)
;if(null!==t){const e=this._compileErrors.get(t);return e?Promise.reject(e):Promise.resolve(t)}return"pine"===e.type?this._compilePine(e):Promise.reject(`unexpected study id=${e.studyId} with type=${e.type}`)}findByIdSync(e){return this._findStudyMetaInfo(e)}isReady(){return this._isReady}async findAllJavaStudies(){return this._isReady||await this.requestMetaInfo(),this._javaStudiesMetaInfo}studyVersioning(){return(0,s.ensureNotNull)(this._studyVersioning)}getInternalMetaInfoArray(){return this._javaStudiesMetaInfo}addPineMetaInfo(e,t){const i=_(this._pineMetaInfoCache,e);return t&&(!Array.isArray(t)||t.length>0)&&(t=Array.isArray(t)?new c.PineCompileFailErrorImpl({warnings:[],errors:t},e):t,this._compileErrors.set(i,t)),i}async getLatestMetaInfoForPineStudy(e,t){const i=await(0,d.requestUserScripts)();let n;if(i){const r=i.find((t=>t.scriptIdPart===e));if(r){const e=l.Version.parse(t),i=l.Version.parse(r.version);e.isLess(i)&&(n=r.version)}}if(void 0!==n){const t={type:"pine",pineId:e,pineVersion:n};return this.findById(t)}return null}_processMigrations(e){this._studiesMigrations=[];for(let t=0;e&&t<e.length;t++)this._studiesMigrations.push(e[t])}_processSiteMetaInfo(e,t){for(const t of e)u.StudyVersioning.verifyInputsMaxValue(t),g(t);this._rawStudiesMetaInfo=e,this._processMigrations(t);for(const e of this._rawStudiesMetaInfo)_(this._javaStudiesMetaInfo,e);o.StudyMetaInfo.overrideDefaults(this._javaStudiesMetaInfo)}_processLibraryMetaInfo(e){}_requestFinished(){this._isReady=!0}_findStudyMetaInfo(e){return"java"===e.type?((0,s.assert)(0!==this._javaStudiesMetaInfo.length,"Java studies metainfo should be define here"),this._javaStudiesMetaInfo.find((t=>t.id===e.studyId))||null):this._pineMetaInfoCache.find((t=>t.scriptIdPart===e.pineId&&(void 0===e.pineVersion||(0,s.ensureDefined)(t.pine).version===e.pineVersion)))||null}_compilePine(e){f.logNormal(`Compiling ${e.pineId} script`);const t=(0,d.translateScriptAsync2)(e.pineId,e.pineVersion||"last").then((({metaInfo:t,compileErrors:i})=>(f.logNormal(`Compiling ${e.pineId} is successful`),this.addPineMetaInfo((0,s.ensureDefined)(t),i.errors))));return t.catch((t=>{t instanceof c.PineCompileFailErrorImpl&&this.addPineMetaInfo(t.metaInfo,t),f.logNormal(`Compiling ${e.pineId} is failed`)})),t}}function g(e){e.description_localized=r.t(e.description,{context:"study"},i(783477))}function _(e,t){const i=new o.StudyMetaInfo(t).state();(0,a.migrateMetaInfoAndPropState)(i);const n=new o.StudyMetaInfo(i);let r=!0;const s=e.findIndex((e=>e.id===n.id));if(-1===s)e.push(n);else{const t=e[s],i=void 0!==t.pine?l.Version.parse(t.pine.version):null,o=void 0!==n.pine?l.Version.parse(n.pine.version):null;null===o||null===i||o.isGreaterOrEqual(i)?(t.removeDefaults(),e[s]=n):r=!1}return r&&n.createDefaults(),n}const m=(0,n.default)((()=>new v(window.ChartApiInstance)))},79428:(e,t,i)=>{"use strict";i.d(t,{fundamentalsPrefix:()=>n,isFundamentalStudyMetaInfo:()=>r,studyNameByMetaInfo:()=>s});const n="study_Internal$STD;Fund_";function r(e){return s(e)===n}function s(e){
const t="study_"+(e.classId||e.shortId);return t.startsWith(n)?n:t}},564391:(e,t,i)=>{"use strict";i.d(t,{studySignature:()=>r});const n=new Set(["text","text_area","bar_time","color"]);function r(e,t,i){return`ssv1=${e}(${t.filter((e=>!n.has(e.type))).map((e=>i[e.id])).join("|")})`}},261420:(e,t,i)=>{"use strict";i.d(t,{StudyStatusProviderBase:()=>l});var n=i(232915),r=i(454184),s=i(816433);const o={NONE:"Default"},a=!0;class l extends n.StatusProviderBase{constructor(e){super(),this._source=e}getSplitTitle(){return this._source.titleInParts(s.TitleDisplayTarget.StatusLine,!0,o,void 0,a)}getInputsTitles(){return this._source.inputsInParts(s.TitleDisplayTarget.StatusLine,!0,o,a)}titleTooltip(){const e=this._source.metaInfo();if(null!==e&&e.shortDescription!==e.description)return this._source.titleInParts(s.TitleDisplayTarget.StatusLine,!1,o,!0,a).join(" ")}text(){const e=this._source.title(s.TitleDisplayTarget.StatusLine,!0,o,void 0,a);return this._source.isActualInterval()?this._source.isFailed()?`${e}: ${this.sourceStatusText()}`:`${e} ${this.sourceStatusText()}`:e}sourceStatusText(){return(0,r.convertStudyStatusToString)(this._source.status(),!0)}errorStatus(){if(!this._source.isActualInterval()||this._source.isSymbolInvalid())return null;const e=this._source.status();return e.type===r.StudyStatusType.Error?{showReportItButton:e.errorDescription.showReportItButton,error:this.sourceStatusText(),solutionId:(0,r.studyStatusSolutionId)(e),title:(0,r.studyStatusTitle)(e),studyFeature:(0,r.studyStatusFeature)(e),stackTrace:(0,r.studyErrorStatusStackTrace)(e.errorDescription.stack_trace),editorError:e.errorDescription.editorError}:null}}},197860:(e,t,i)=>{"use strict";i.d(t,{StudyStatusView:()=>r});var n=i(236578);class r extends n.StatusView{constructor(e){super(e.statusProvider())}getSplitTitle(){return this._statusProvider.getSplitTitle()}titleTooltip(){return this._statusProvider.titleTooltip()}getInputsTitles(){return this._statusProvider.getInputsTitles()}update(e){this._text=this._statusProvider.text()}}},454184:(e,t,i)=>{"use strict";i.d(t,{StudyStatusType:()=>p,convertStudyStatusToString:()=>h,createStudyError:()=>g,studyErrorStatusStackTrace:()=>v,studyStatusFeature:()=>S,studyStatusSolutionId:()=>f,studyStatusTitle:()=>y});var n=i(444372),r=i(398851),s=i(214258);const o=n.t(null,void 0,i(150910));function a(e){const t=e.toLowerCase();return t.includes("the data vendor doesn't provide volume data for this symbol.")||t.includes("no volume is provided by the data vendor")}const l=new Map([["This script is invite-only",s.solutionIds.PUBLIC_INVITE_ONLY_SCRIPTS]]),u=new Map([["Volume Profile indicator available only on our upgraded plans","volumeProfile"]]),d="loading...",c=n.t(null,void 0,i(662011));var p;function h(e,t){if(e.type===p.Loading)return t?c:d;if(e.type===p.Error){const i=e.errorDescription,n=t?(0,r.triesTranslateError)(i.error):i.error;if(i.ctx){const e={};return Object.entries(i.ctx).forEach((([t,i])=>{e[t]=i.toString()})),n.format(e)}return n}return""}function f(e){
if(e.type===p.Error)return e.errorDescription.solution_id?e.errorDescription.solution_id:function(e){for(const t of Array.from(l.keys()))if(e.includes(t))return l.get(t)}(e.errorDescription.error)}function y(e){if(e.type===p.Error)return a(e.errorDescription.error)?o:(0,r.triesTranslateError)(e.errorDescription.title??"Runtime error")}function S(e){const{errorDescription:{error:t}}=e;for(const[e,i]of u)if(t.startsWith(e))return i}function v(e){if(void 0===e)return;const t=[];for(const i of e){const e={functionOrScopeName:i.n,lineNumber:i.p};"id"in i&&(e.id=i.id),"v"in i&&(e.versionScript=i.v),t.push(e)}return t}function g(e,t){"BISTMIXED"===t&&a(e.error)&&(e.error="VOLUME_BIST_MIXED",e.solution_id=s.solutionIds.BIST_MIXED_SUBSCRIPTION,e.title=o);const i="check study unexpected error"===e.error;return{type:p.Error,errorDescription:{...e,showReportItButton:i}}}!function(e){e[e.Undefined=0]="Undefined",e[e.Loading=1]="Loading",e[e.Completed=2]="Completed",e[e.Error=3]="Error"}(p||(p={}))},507733:(e,t,i)=>{"use strict";i.d(t,{StudyStub:()=>L,isStudyStubDescriptor:()=>w});var n=i(650279),r=i(130551),s=i(650151),o=i(158942),a=i(44049),l=i(68777),u=i(958443),d=i(564391),c=i(239949),p=i(197860),h=i(470416),f=i(89831),y=i(547465),S=i(905520),v=i(261420),g=i(816433);class _ extends v.StudyStatusProviderBase{text(){return this._source.isActualInterval()?`${this._source.title(g.TitleDisplayTarget.StatusLine)} ${this.sourceStatusText()}`:this._source.title(g.TitleDisplayTarget.StatusLine)}}var m=i(454184),I=i(498075),T=i(87347);class P{getItems(){return[]}getValues(e){return[]}}const b=new y.Delegate;class L extends h.PriceDataSource{constructor(e,t,i,n,r=null){if(super(e),this._priceStep=.01,this._origState=null,this._descriptor=null,this._status={type:m.StudyStatusType.Undefined},this._statusChanged=new y.Delegate,this._descriptorChanged=new y.Delegate,this._formatter=new f.PriceFormatter({priceScale:100}),this._showPineVersionInStatusLine=new o.WatchedValue(!1).spawn(),this._pineSourceCodeModel=null,(0,T.isStudyDescriptor)(t))this._descriptor=t;else if(this._origState=t,t&&(0,I.isStudyState)(t)){const{state:e,metaInfo:i}=t;this._signature.setValue((0,d.studySignature)(i.scriptIdPart,i.inputs,e.inputs))}this._title=i,this._alwaysShowInLegend=void 0!==n,this._isOverlay=n,this._studyMetaInfo=r;this._properties=new S.Property({visible:!0}),this._statusView=new p.StudyStatusView(this),r&&(0,u.isCountedUserScript)(r)&&(this._showPineVersionInStatusLine=(0,l.combine)((e=>(0,u.userScriptVersionsCount)(r.scriptIdPart)>1),(0,u.userScriptsOnLayout)().weakReference()),this._showPineVersionInStatusLine.subscribe((()=>e.updateSource(this))))}destroy(){this._pineSourceCodeModel?.destroy(),this._showPineVersionInStatusLine.destroy(),super.destroy()}barColorer(){return null}properties(){return this._properties}statusView(){return this._statusView}legendView(){return null}state(e){return this._origState}getDescriptor(){return null===this._descriptor?null:{descriptor:this._descriptor,title:this._title,isOverlay:this._isOverlay,id:this.id(),
status:this._status}}updateDescriptor(e){(0,n.default)(this._descriptor,e)||(this._descriptor=e,this._descriptorChanged.fire())}onDescriptorChanged(){return this._descriptorChanged}metaInfo(){return this._studyMetaInfo}setMetaInfo(e){this._studyMetaInfo=e}setStatus(e){const t=this.isDisplayedInLegend();if(this._status=e,this._statusChanged.fire(),this.isDisplayedInLegend()!==t){const e=this._model.paneForSource(this);if(e){const t=this._model.panes().indexOf(e),i=c.InvalidationMask.invalidateLegendWidgetLayout(t);this.model().invalidate(i)}}}formatter(){return this._formatter}name(){return this._title}title(){return this.titleInParts().join(" ")}titleInParts(){const e=[this._title];return this._showPineVersionInStatusLine.value()&&e.push((0,s.ensureDefined)(this._studyMetaInfo?.pine).version),e}inputsInParts(){return null}isFailed(){return this._status.type===m.StudyStatusType.Error}isLoading(){return this._status.type===m.StudyStatusType.Loading}isDisplayedInLegend(){return this._alwaysShowInLegend||this.isFailed()}setFailed(e,t){this.setStatus({type:m.StudyStatusType.Error,errorDescription:{error:e,title:t}}),this._model.updateSource(this)}isSymbolInvalid(){return!1}isActualInterval(){return!0}onIsActualIntervalChange(){return b}start(){}status(){return this._status}onStatusChanged(){return this._statusChanged}firstValue(){return null}currency(){return null}sessionId(){return this._model.mainSeries().sessionId()}sessionIdChanged(){return this._model.mainSeries().sessionIdChanged()}unit(){return null}symbolSource(){return this._model.mainSeries()}symbolSourceWV(){return this._model.mainSeries().symbolSourceWV()}barsProvider(){return this._model.mainSeries()}valuesProvider(){return new P}legendValuesProvider(){return new P}statusProvider(e){return new _(this)}isRemovedByStudyTemplates(){return null!==this._origState&&(0,I.isStudyState)(this._origState)}pineSourceCodeModel(){return null!==this._descriptor&&"pine"===this._descriptor.type?(this._pineSourceCodeModel||(this._pineSourceCodeModel=new a.AsyncResourceWrapper(Promise.all([i.e(73867),i.e(80233),i.e(32751),i.e(53159),i.e(88741),i.e(32565),i.e(7351),i.e(8092),i.e(69955),i.e(26843),i.e(89810),i.e(90390),i.e(89199)]).then(i.bind(i,4621)).then((e=>this._isDestroyed?null:new e.PineStubSourceCodeModel(this))),(e=>{e?.destroy()}))),this._pineSourceCodeModel.promise()):Promise.resolve(null)}contextMenuStatName(){return"StudyStubContextMenu"}}function w(e){return(0,r.isObject)(e)&&"descriptor"in e&&(0,T.isStudyDescriptor)(e.descriptor)}},498889:(e,t,i)=>{"use strict";i.d(t,{applyOverridesToStudyDefaults:()=>c});var n=i(650151),r=i(974145),s=i(735566);const o={line:r.LineStudyPlotStyle.Line,histogram:r.LineStudyPlotStyle.Histogram,cross:r.LineStudyPlotStyle.Cross,area:r.LineStudyPlotStyle.Area,columns:r.LineStudyPlotStyle.Columns,circles:r.LineStudyPlotStyle.Circles,line_with_breaks:r.LineStudyPlotStyle.LineWithBreaks,area_with_breaks:r.LineStudyPlotStyle.AreaWithBreaks,step_line:r.LineStudyPlotStyle.StepLine,step_line_with_breaks:r.LineStudyPlotStyle.StepLineWithBreaks,
step_line_with_diamonds:r.LineStudyPlotStyle.StepLineWithDiamonds},a=(0,s.getLogger)("Chart.Model.StudyPropertiesOverrider");var l,u;function d(e,t,i,n){const r=i.split(".");if(0===r.length||0===r[0].length)return;const s=function(e){const t=e.split(":");return{name:t[0],type:2===t.length?t[1]:null}}(r[0]),o=s.name,d=s.type,c=null!==d,p=!c||"band"===d,h=!c||"area"===d,f=!c||"input"===d,y=!c||"plot"===d?u.getPlotIdByTitle(e,o):null,S=p?u.getBandIndexByName(e,o):null,v=h?u.getFilledAreaIdByTitle(e,o):null,g=f?u.getInputByName(e,o):null,_=t.hasOwnProperty(o);if((null!==y?1:0)+(null!==S?1:0)+(null!==v?1:0)+(null!==g?1:0)+(_?1:0)>1)return void a.logWarn(`Study '${e.description}' has ambiguous identifier '${o}'`);const m=r[1];if(null!==y){if(1===r.length)return void a.logWarn(`Path of sub-property of '${o}' plot for study '${e.description}' must be not empty`);const i=r.slice(1);l.applyPlotProperty(e,t,y,i,n)}else if(null!==g)l.applyInputValue(t,g,n);else if(null!==S){if(void 0===m)return void a.logWarn(`Property name of '${o}' band for study '${e.description}' must be set`);l.applyBandProperty(t,S,m,n)}else if(null!==v){if(void 0===m)return void a.logWarn(`Property name of '${o}' area for study '${e.description}' must be set`);l.applyFilledAreaProperty(t,v,m,n)}else _?l.setRootProperty(t,r,n):a.logWarn(`Study '${e.description}' has no plot or input '${o}'`)}function c(e,t,i){for(const n in e){if(!e.hasOwnProperty(n))continue;const r=n.indexOf(".");if(-1===r)continue;const s=n.substring(0,r),o=u.getMetaInfoByDescription(t,s);if(null===o){a.logWarn(`There is no such study ${s}`);continue}const l=i(o);null!==l?d(o,l,n.substring(r+1),e[n]):a.logWarn(`Cannot apply overrides for study ${s}`)}}!function(e){e.applyPlotProperty=function(e,t,i,s,l){if(void 0===t.styles)return void a.logWarn("Study does not have styles");const u=s[0];if("color"===u){const o=function(e,t,i){if(void 0===e.plots)return null;for(const n of e.plots){if(!(0,r.isPaletteColorerPlot)(n)||void 0===t.palettes)continue;const e=t.palettes[n.palette];if(n.target===i&&void 0!==e)return e}return null}(e,t,i);return void function(e,t,i,r,s){void 0!==e.styles?null===t&&!isNaN(r)&&r>0?a.logWarn(`Study plot does not have color #${r}`):((0===r||isNaN(r))&&((0,n.ensureDefined)(e.styles[i]).color=String(s),r=0),null!==t&&((0,n.ensureDefined)(t.colors?.[r]).color=String(s))):a.logWarn("Study does not have styles")}(t,o,i,s.length>1?parseInt(s[1]):NaN,l)}const d=t.styles[i];if(void 0!==d&&d.hasOwnProperty(u)){if("plottype"===u){const e=o[String(l)];if(void 0===e)return void a.logWarn(`Unsupported plot type for plot: ${l}`);l=e}d[u]=l}else a.logWarn(`Study plot does not have property '${u}'`)},e.applyBandProperty=function(e,t,i,n){if(void 0===e.bands)return void a.logWarn("Study does not have bands");const r=e.bands[t];if(void 0!==r&&r.hasOwnProperty(i)){if("plottype"===i){const e=o[String(n)];if(void 0===e)return void a.logWarn(`Unsupported plot type for band: ${n}`);n=e}r[i]=n}else a.logWarn(`Study band does not have property '${i}'`)},
e.applyFilledAreaProperty=function(e,t,i,n){if(void 0===e.filledAreasStyle)return void a.logWarn("Study does not have areas");const r=e.filledAreasStyle[t];void 0!==r&&r.hasOwnProperty(i)?r[i]=n:a.logWarn(`Study area does not have property '${i}'`)},e.applyInputValue=function(e,t,i){void 0!==e.inputs&&e.inputs.hasOwnProperty(t)?e.inputs[t]=i:a.logWarn(`Study does not have input '${t}'`)},e.setRootProperty=function(e,t,i){if(0===t.length)return;let n=e;for(const e of t.slice(0,-1)){if(null==n||!n.hasOwnProperty(e))break;n=n[e]}const r=t[t.length-1];null!=n&&n.hasOwnProperty(r)?n[r]=i:a.logWarn(`Study does not have property ${t.join(".")}`)}}(l||(l={})),function(e){e.getInputByName=function(e,t){if(void 0===e.inputs)return null;t=t.toLowerCase();for(const i of e.inputs)if(i.name.toLowerCase()===t)return i.id;return null},e.getPlotIdByTitle=function(e,t){if(void 0===e.styles)return null;t=t.toLowerCase();for(const i in e.styles){const n=e.styles[i];if((void 0!==n&&void 0!==n.title?n.title:i).toLowerCase()===t)return i}return null},e.getFilledAreaIdByTitle=function(e,t){if(void 0===e.filledAreas)return null;t=t.toLowerCase();for(const i of e.filledAreas)if(i.title.toLowerCase()===t)return i.id;return null},e.getBandIndexByName=function(e,t){if(void 0===e.bands)return null;t=t.toLowerCase();for(let i=0;i<e.bands.length;++i)if(e.bands[i].name.toLowerCase()===t)return i;return null},e.getMetaInfoByDescription=function(e,t){t=t.toLowerCase();for(const i of e)if(i.description.toLowerCase()===t||i.shortDescription.toLowerCase()===t)return i;return null}}(u||(u={}))},736524:(e,t,i)=>{"use strict";const{clone:n}=i(536794);var r=i(886338).Version,s=i(735566).getLogger("Chart.StudyMigration");function o(e){this._studyId=e,this._maxToVers=r.ZERO,this._maxFromVers=r.ZERO,this._migrs=[]}o.prototype.addMigration=function(e,t,i){var n=r.parse(e),s=r.parse(t);n.isGreater(this._maxFromVers)&&(this._maxFromVers=n),s.isGreater(this._maxToVers)&&(this._maxToVers=s),this._migrs.push({fromVers:n,toVers:s,rules:i})},o.prototype.updateInputs=function(e,t,i){if(!i)return i;for(var r=n(i),o=e;o.isLess(t);){var a=this._findMigration(o);if(null==a)break;if(s.logNormal("Migrating study inputs from "+a.fromVers+" to "+a.toVers+" version, studyId: "+this._studyId+", migration: "+JSON.stringify(a)+", inputs: "+JSON.stringify(i)),r=this._applyMigration(r,a),!o.isLess(a.toVers))throw new Error("Problems in study migration process... Possible infinite cycle has been detected and stopped.");o=a.toVers}return o>e&&s.logNormal("Study inputs migration is done, studyId: "+this._studyId+", inputs: "+JSON.stringify(r)),r},o.prototype._findMigration=function(e){for(var t=-1,i=this._maxFromVers,n=0;n<this._migrs.length;n++){var r=this._migrs[n];r.fromVers.isLess(e)||r.fromVers.isLessOrEqual(i)&&(i=r.fromVers,t=n)}return t<0?null:this._migrs[t]},o.prototype._applyMigration=function(e,t){for(var i=e,n=0;n<t.rules.length;n++){var r=t.rules[n];i=this._getApplyRuleFun(r.type)(i,r)}return i},o.prototype._getApplyRuleFun=function(e){
if("inputRemoved"===e)return o._applyInputRemovedRule;if("inputChangedType"===e)return o._applyInputChangedTypeRule;if("inputChangedMinMax"===e)return o._applyInputChangedMinMaxRule;if("inputChangedOptions"===e)return o._applyInputChangedOptionsRule;throw new Error("Unknown migration rule type: "+e)},o._applyInputRemovedRule=function(e,t){if(!(t.inputId in e))return e;if("removeVal"!==t.action)throw new Error("Unexpected rule.action="+t.action+" in rule.type="+t.type);var i=e[t.inputId];return delete e[t.inputId],s.logNormal("Input "+t.inputId+"="+i+" removed"),e},o._applyInputChangedTypeRule=function(e,t){var i=e[t.inputId];if("resetToDefVal"===t.action)return e[t.inputId]=t.defVal,s.logNormal("Input "+t.inputId+"="+i+" reset to default value "+t.defVal),e;if("convertVal"===t.action){if(null==i)return e;if("float"===t.inputTypeFrom&&"integer"===t.inputType)return e[t.inputId]=Math.round(e[t.inputId]),s.logNormal("Input "+t.inputId+"="+i+" converted to value "+e[t.inputId]),e;if("integer"===t.inputTypeFrom&&"float"===t.inputType)return e;if("text"===t.inputTypeFrom&&"source"===t.inputType)return o._isValidSource(i,t.options)||(e[t.inputId]=t.defVal),e;throw new Error("Cannot convertVal from "+t.inputTypeFrom+" to "+t.inputType)}throw new Error("Unknown action "+t.action+" for rule with type "+t.type)},o._isValidSource=function(e,t){return e.indexOf("$")>=0||t.indexOf(e)>=0},o._applyInputChangedMinMaxRule=function(e,t){if("adjustValIfNeeded"!==t.action)throw new Error("Unknown action "+t.action+" for rule with type "+t.type);var i=e[t.inputId];return i<t.minVal?e[t.inputId]=t.minVal:i>t.maxVal&&(e[t.inputId]=t.maxVal),s.logNormal("Input "+t.inputId+"="+i+" adjusted to value "+e[t.inputId]),e},o._applyInputChangedOptionsRule=function(e,t){if(!(["text"].indexOf(t.inputType)>=0&&"resetToDefValIfNeeded"===t.action))throw new Error("Unexpected rule.inputType="+t.inputType+" in rule.action="+t.action);var i=e[t.inputId];return t.options.indexOf(i)<0&&(e[t.inputId]=t.defVal,s.logNormal("Input "+t.inputId+"="+i+" reset to default value "+t.defVal)),e},e.exports=o},192809:(e,t,i)=>{"use strict";i.d(t,{StudyVersioning:()=>_});var n=i(998034),r=i(650151),s=i(807958),o=i(736524),a=i.n(o),l=i(735566),u=i(886338),d=i(301320),c=i(520533),p=i(444372);var h=i(730936),f=i(971417),y=i(66974),S=i(536794);const v=(0,l.getLogger)("Chart.Study.Versioning"),g=1e12;class _{constructor(e,t){if(this._migrations={},!e)throw new Error("No studies metainfo");if(this._studiesMetainfo=e,!t)throw new Error("No studies migrations");this._studiesMigrations=t;for(let e=0;e<this._studiesMigrations.length;e++){const t=this._studiesMigrations[e],i=t.versFrom,n=t.versTo;for(let e=0;e<t.studyMigrations.length;e++){const r=t.studyMigrations[e],s=r.studyId;if(0===r.rules.length){v.logError("Study Migration should have at least one convertion rule");continue}const o=s in this._migrations?this._migrations[s]:new(a())(s);o.addMigration(i,n,r.rules),this._migrations[s]=o}}this._clientMigrations=[(e,t)=>{
if(0===this._studiesMetainfo.length||!e.isTVScript||e.version>=22)return t;const i={};let n=0,r=0,s=t[r];for(;void 0!==s;){const e=t[s.id];s.isFake&&(s.id="in_"+n++),i[r]=s,i[s.id]=e,r++,s=t[r]}return i}]}updateMetaInfoAsync(e,t){const i=s.StudyMetaInfo.versionOf(e);if(e.isTVScript&&!e.pine&&i<43){(0,r.assert)((0,S.isExistent)(e.scriptIdPart),"scriptIdPart is missing, study "+JSON.stringify(e));const i=e.scriptIdPart;return{sync:!1,result:new Promise(((n,r)=>{(0,h.processLegacy)(i,e.TVScriptSourceCode).then((i=>{e.removeDefaults();const r=new s.StudyMetaInfo(i);t&&r.createDefaults();const o=r.state();(0,d.migrateMetaInfoAndPropState)(o),n(new s.StudyMetaInfo(o))})).catch((e=>{r(e)}))}))}}if(e.isTVScript&&e.pine){if((e._serverMetaInfoVersion||i)<54){return{sync:!1,result:(0,c.translateScriptAsync2)(e.scriptIdPart,e.pine.version).then((i=>{e.removeDefaults();const n=new s.StudyMetaInfo(i.metaInfo);t&&n.createDefaults();const r=n.state();return(0,d.migrateMetaInfoAndPropState)(r),new s.StudyMetaInfo(r)}))}}return t&&e.createDefaults(),{sync:!0,result:e}}{let t=null;const i=this._studiesMetainfo;for(let n=0;n<i.length;n++)if(i[n].id===e.id){t=i[n];break}return{sync:!0,result:t?new s.StudyMetaInfo(t.state()):null}}}updateStudyState(e,t,i){if(null==e||null==t||null==i)return e;e=(0,S.clone)(e),this.updateStudyInputsIfNeeded(e,t.version,i);for(const i of this._clientMigrations){const n=i.call(this,t,e.inputs);Object.keys(n).length===Object.keys(e.inputs).length?e.inputs=n:v.logWarn("StudyVersioning._clientMigrations application returned bad result. Skipping it...")}const n=s.StudyMetaInfo.versionOf(t);if(t.isTVScript&&t.TVScriptSourceCode&&n>=12&&n<=26){const n={};for(let e=0;e<t.plots.length;++e){const r=t.plots[e],s=i.plots[e];n[r.id]=s.id}const r=Object.keys(e.styles);for(let t=0;t<r.length;++t){const i=r[t],s=e.styles[i];delete e.styles[i];const o=n[i];e.styles[o]=s}const s=Object.keys(e.plots);for(let t=0;t<s.length;++t){const i=s[t],r=e.plots[i].id;e.plots[i].id=n[r]}}return e}updateStudyInputsIfNeeded(e,t,i){if(!(i.isTVScript||!!i.pine)&&t!==i.version){const n=i&&i.defaults.inputs;e.inputs=this.updateStudyInputs(i.id,t,i.version,e.inputs,n)}}updateStudyInputs(e,t,i,n,r){let s=(0,S.clone)(n);if(e in this._migrations){const n=u.Version.parse(t);let r;if("last"===i){const t=this.lastVersionOfStudy(e);r=u.Version.parse(t)}else r=u.Version.parse(i);s=this._migrations[e].updateInputs(n,r,s)}if(null==r)return s;for(const e in r)e in s||(s[e]=r[e]);for(const i in s)if(!(i in r)){const n=s[i];v.logWarn(`Extra input detected, studyId='${e}', versionFrom='${t}', inputId='${i}', inputValue='${n}', removing it and continue...`),delete s[i]}return s}lastVersionOfStudy(e){return(0,r.ensureDefined)(this._studiesMetainfo.find((t=>t.id===e))).version}updateMetaInfo(e){if(!e)return e;(0,r.assert)(e instanceof s.StudyMetaInfo),(0,r.assert)(!e.isTVScript,"This method should update only built-in java indicators metaInfo. For Pine indicators use updateMetaInfoAsync");const t=this._studiesMetainfo.find((t=>e.id===t.id))
;return t?new s.StudyMetaInfo(t.state()):null}static patchPointsBasedStudyState(e){return this._fixInputsMaxValue(e.state,e.metaInfo),"LineToolRegressionTrend"===e.type&&(e=function(e){const t={palettes:{},inputs:[{defval:2,id:"upper diviation",max:500,min:-500,name:p.t(null,void 0,i(591900)),type:"integer"},{defval:-2,id:"lower diviation",max:500,min:-500,name:p.t(null,void 0,i(831736)),type:"integer"},{defval:!0,id:"use upper diviation",name:p.t(null,void 0,i(784451)),type:"bool"},{defval:!0,id:"use lower diviation",name:p.t(null,void 0,i(449299)),type:"bool"},{defval:0,id:"first bar time",max:253370764800,min:0,name:p.t(null,void 0,i(780509)),type:"time"},{defval:0,id:"last bar time",max:253370764800,min:0,name:p.t(null,void 0,i(59933)),type:"time"},{defval:"close",id:"source",name:p.t(null,void 0,i(997751)),options:["open","high","low","close","hl2","hlc3","ohlc4"],type:"text"}],plots:[],graphics:{},defaults:{inputs:{"first bar time":0,"last bar time":0,"lower diviation":-2,source:"close","upper diviation":2,"use lower diviation":!0,"use upper diviation":!0}},_metainfoVersion:6,description:"Regression Trend",id:"RegressionTrend@tv-basicstudies",is_price_study:!0,shortDescription:"Reg Trend",shortId:"RegressionTrend",version:"2",fullId:"RegressionTrend@tv-basicstudies-2",name:"RegressionTrend@tv-basicstudies"};return e.metaInfo||(e.metaInfo=t),e}(e)),e}static patchStudyData(e,t,i,n){if(!(0,y.isProd)())return{data:t,nsData:i,indexes:n??void 0};const r=(0,S.clone)(t),o=(0,S.clone)(i),a=(0,S.clone)(n);"VbPVisible@tv-volumebyprice"===e.id&&e.version&&+e.version<=4&&this._patchOldVolumeProfiles(0,r?.graphics),"VbPSessions@tv-volumebyprice"===e.id&&e.version&&+e.version<=4&&this._patchOldVolumeProfiles(0,r?.graphics);const l=s.StudyMetaInfo.versionOf(e);if(r&&e.isTVScript&&e.TVScriptSourceCode&&l>=12&&l<=26){const e=r.columns,t=[];r.columns=t;for(let i=0;i<e.length;++i){const e="plot_"+i;t.push(e)}}return{data:r,nsData:o,indexes:a??void 0}}static patchPointsBasedStudyData(e,t){if(!(0,y.isProd)())return t;if(!e||!t)return t;const i=(0,S.clone)(t);return"VbPFixed@tv-volumebyprice"===e.id&&e.version&&+e.version<=4&&this._patchOldVolumeProfiles(0,i),i}static patchPropsStateAndMetaInfo(e,t,i){let r=t.state();"Script$BOOKER"!==t.productId||r.alerts||delete e.alerts,this._fixInputsOrder(e,r),this._fixInputsMaxValue(e,r);const o=this.splitInputs(e.inputs);e.inputs=o.obj;const a=s.StudyMetaInfo.versionOf(t);a<42&&r.isChildStudy&&(e.isChildStudy=r.isChildStudy);if(t.isTVScript&&t.version<60&&("Script$TV_EARNINGS@tv-scripting"!==t.id&&"Script$TV_DIVIDENDS@tv-scripting"!==t.id&&"Script$TV_SPLITS@tv-scripting"!==t.id||delete r.TVScriptSourceCode),"Volume"!==t.id&&"Volume@tv-basicstudies"!==t.id||0!==t.inputs.length||(r.inputs=[{id:"length",type:"integer",defval:20,min:1,max:1e3}],r.plots.push({id:"vol_ma",type:"line"})),"Volume@tv-basicstudies"===t.id&&t.version&&t.version<=46&&void 0===e.styles.vol.transparency&&(e.styles.vol.transparency=e.transparency||87),
"PivotPointsStandard@tv-basicstudies"===t.id&&(0===r.inputs.length?(e.inputs={kind:"Traditional",showHistoricalPivots:!0},r.inputs=[{defval:"Traditional",id:"kind",type:"text",options:["Traditional","Fibonacci","Woodie","Classic","DeMark","Camarilla"]},{id:"showHistoricalPivots",type:"bool",defval:!0}]):1===r.inputs.length&&(e.inputs={kind:"Traditional"},r.inputs=[{defval:"Traditional",id:"kind",type:"text",options:["Traditional","Fibonacci","Woodie","Classic","DeMark","Camarilla"]},{id:"showHistoricalPivots",type:"bool",defval:!0}]),void 0===e._hardCodedDefaultsVersion)){e._hardCodedDefaultsVersion=1;const t=e.color;delete e.color,e.levelsStyle={colors:{P:t,"S1/R1":t,"S2/R2":t,"S3/R3":t,"S4/R4":t,"S5/R5":t}}}"CMF"===t.shortId&&2===r.inputs.length&&(e.inputs={length:e.inputs["length fast"]},r.inputs=r.inputs.splice(0,1),r.inputs[0].id="length"),r.defaults&&void 0===r.defaults.precision&&a<46&&(-1!==["Volume@tv-basicstudies","VbPVisible@tv-volumebyprice","VbPSessions@tv-volumebyprice"].indexOf(t.id)?r.defaults.precision=0:r.defaults.precision=4);let l=t.id;if(t.version<60){const e=["TV_DIVIDENDS","TV_SPLITS","TV_EARNINGS"],i=6;for(let n=0;n<e.length;n++)t.id.startsWith("Script$"+e[n]+"@tv-scripting")&&(r.fullId="ESD"+r.fullId.substring(i),r.id="ESD"+r.id.substring(i),r.name&&(r.name="ESD"+r.name.substring(i)),r.shortId="ESD"+r.shortId.substring(i),r.productId="ESD"+r.productId.substring(i),l="ESD"+t.id.substring(i))}const u={"ESD$TV_EARNINGS@tv-scripting":{fullId:"Earnings@tv-basicstudies-129!",id:"Earnings@tv-basicstudies",name:"Earnings@tv-basicstudies",shortId:"Earnings",productId:"tv-basicstudies"},"ESD$TV_SPLITS@tv-scripting":{fullId:"Splits@tv-basicstudies-129!",id:"Splits@tv-basicstudies",name:"Splits@tv-basicstudies",shortId:"Splits",productId:"tv-basicstudies"},"ESD$TV_DIVIDENDS@tv-scripting":{fullId:"Dividends@tv-basicstudies-129!",id:"Dividends@tv-basicstudies",name:"Dividends@tv-basicstudies",shortId:"Dividends",productId:"tv-basicstudies"}};if(l in u&&Object.assign(r,u[l]),a<43){const i={"StrategyScript$STD;Consecutive%1Ups/Downs%1Strategy":{pineId:"STD;Consecutive%1Ups%1Downs%1Strategy",className:"StrategyScript"},Script$EDGR_NET_INCOME_FROM_CONTINUING_OPERATIONS_APPLICABLE_TO_COMMON_V2:{pineId:"Script$EDGR_NET_INCOME_FROM_CONTINUING_OPS_APPLICABLE_TO_COMMON_V2",className:"Script"}};if(t.shortId in i){const s=i[t.shortId].className+"$"+i[t.shortId].pineId,o={scriptIdPart:i[t.shortId].pineId,fullId:r.fullId.replace(r.shortId,s),id:r.id.replace(r.shortId,s),name:r.name?.replace(r.shortId,s),shortId:s};(0,n.default)(r,o),(0,n.default)(e,o)}const s=(0,f.extractPineId)(t.fullId),o=s&&s.match(/^(USER)(_\d+)(;)(.*)$/);if(o){const t=o[0],i=o[1]+o[3]+o[2]+o[4],s={scriptIdPart:i,fullId:r.fullId.replace(t,i),id:r.id.replace(t,i),name:r.name?.replace(t,i),shortId:r.shortId.replace(t,i)};(0,n.default)(r,s),(0,n.default)(e,s)}}if("MA"===t.id){const t={id:"MAExp",properties:[{id:"is_price_study",type:"bool",value:"true"}],inputs:[{id:"length",type:"integer",defval:20,min:1,max:500},{id:"source",type:"text",
defval:"close",options:["open","high","low","close"]}],plots:[{id:"MovAvgExp",type:"line"}],palettes:{}},i={id:"MASimple",properties:[{id:"is_price_study",type:"bool",value:"true"}],inputs:[{id:"length",type:"integer",defval:20,min:1,max:500},{id:"source",type:"text",defval:"close",options:["open","high","low","close"]}],plots:[{id:"MovAvgSimple",type:"line"}],palettes:{}},n={id:"MAVolumeWeighted",properties:[{id:"is_price_study",type:"bool",value:"true"}],inputs:[{id:"length",type:"integer",defval:20,min:1,max:500},{id:"source",type:"text",defval:"close",options:["open","high","low","close"]}],plots:[{id:"MovAvgVolumeWeighted",type:"line"}],palettes:{}},s={id:"MAWeighted",properties:[{id:"is_price_study",type:"bool",value:"true"}],inputs:[{id:"length",type:"integer",defval:20,min:1,max:500},{id:"source",type:"text",defval:"close",options:["open","high","low","close"]}],plots:[{id:"MovAvgWeighted",type:"line"}],palettes:{}};switch(e.inputs.type){case"exp":r=t;break;case"simple":r=i;break;case"weighted":r=s;break;case"volume weighted":r=n}e.styles[r.plots[0].id]=e.styles.MovAvg,delete e.styles.MovAvg,delete e.inputs.type}return i.oldShowStudyLastValueProperty&&(e.oldShowLastValue=e.showLastValue),delete e.showLastValue,delete e.showStudyArguments,(0,d.migrateMetaInfoAndPropState)(r,e),{propsState:e,metaInfo:r}}static splitInputs(e){const t={},i={};for(const[n,r]of Object.entries(e))(0,S.isNumber)(parseInt(n,10))?t[n]=r:i[n]=r;return{arr:t,obj:i}}static verifyInputsMaxValue(e){if(e.inputs)for(const t of e.inputs)"integer"===t.type&&t.max&&t.max>g&&v.logWarn("Bad integer input max value in metaInfo id="+e.id+" title="+e.description)}static mergeInputsObjPart(e,t){const i=this.splitInputs(t);(0,n.default)(e,i.obj)}static _fixInputsOrder(e,t){const i=this._getOrderedInputIds(t),r=this.splitInputs(e.inputs),s=r.arr,o=r.obj,a=(0,n.default)({},o);for(let e=0;e<i.length;++e){const t=i[e],n=this._findInputKeyById(s,t);null!==n&&(a[e]=s[n])}e.inputs=a}static _fixInputsMaxValue(e,t){if((0,S.isAbsent)(t))return;const i=g;if(t.inputs)for(const e of t.inputs)"integer"===e.type&&e.max&&e.max>i&&(e.max=i);if(!e||!e.inputs)return;const r=this.splitInputs(e.inputs),s=r.arr;for(const[,e]of Object.entries(s))"integer"===e.type&&e.max&&e.max>i&&(e.max=i);e.inputs=(0,n.default)(r.obj,r.arr)}static _findInputKeyById(e,t){let i=null;for(const n in e)if((0,S.isNumber)(parseInt(n,10))&&e[n].id===t){i=n;break}return i}static _getOrderedInputIds(e){const t=[];for(const i of e.inputs)t.push(i.id);return t}static _patchOldVolumeProfiles(e,t){if(!t?.hhists)return;const i=t.hhists[e].data,n=[];for(const[,e]of Object.entries(i))n.push(e);t.hhists[0].data=n}}},958443:(e,t,i)=>{"use strict";i.d(t,{addUserScriptOnLayout:()=>l,isCountedUserScript:()=>c,removeUserScriptFromLayout:()=>u,userScriptVersionsCount:()=>a,userScriptsOnLayout:()=>d});var n=i(971417),r=i(751094),s=i(886338);const o=new r.WatchedObject([]);function a(e){return new Set(o.value().filter((t=>t.id===e)).map((e=>e.version))).size}function l(e,t){o.setValue([...o.value(),{id:e,version:t
}])}function u(e,t){const i=o.value().findIndex((i=>i.id===e&&i.version===t));-1!==i&&o.value().splice(i,1),o.setValue(o.value(),!0)}function d(){return o.readonly()}function c(e){return!!e.pine&&s.Version.parse(e.pine.version).major()>=1&&(0,n.isCustomPineId)(e.scriptIdPart)}},240448:(e,t,i)=>{var n;e=i.nmd(e),"undefined"!=typeof window&&(n=window.TVScript=window.TVScript||{}),(n=n||{}).Access={},n.Access.ACCESS_OPEN_NO_AUTH="open_no_auth",n.Access.ACCESS_CLOSED_NO_AUTH="closed_no_auth",n.Access.ACCESS_CLOSED_NEEDS_AUTH="closed_needs_auth",n.Access.MAP_ID_TO_NAME={1:n.Access.ACCESS_OPEN_NO_AUTH,2:n.Access.ACCESS_CLOSED_NO_AUTH,3:n.Access.ACCESS_CLOSED_NEEDS_AUTH},n.Access.MAP_NAME_TO_ID={},Object.keys(n.Access.MAP_ID_TO_NAME).forEach((function(e){n.Access.MAP_NAME_TO_ID[n.Access.MAP_ID_TO_NAME[e]]=e})),n.PinePrefix={},n.PinePrefix.USER="USER;",n.PinePrefix.PUB="PUB;",n.PinePrefix.STD="STD;",n.PinePrefix.TV="TV_",n.PinePrefix.EDGR="EDGR_",n.PineType={},n.PineType.UserSaved="PineType_UserSaved",n.PineType.UserPublished="PineType_UserPublished",n.PineType.BuiltIn="PineType_BuiltIn",n.PineType.Addon="PineType_Addon",n.Type=n.Type||function(){},n.Type.VOID="void",n.Type.INTEGER="integer",n.Type.FLOAT="float",n.Type.STRING="string",n.Type.BOOL="bool",n.Type.COLOR="color",n.Type.SERIES="series",n.Type.PLOT="plot",n.Type.HLINE="hline",n.Type.BARCOLOR="barcolor",n.Type.BGCOLOR="bgcolor",n.Type.PLOTSHAPES="plotshape",n.Type.PLOTCHARS="plotchar",n.Type.PLOTARROWS="plotarrow",n.Type.NA="na",n.Type.ARRAY="array",n.TranslatorDefaultVersion=1,n.TranslatorReferenceVersioningIntroduced=4,n.TranslatorLastVersion=6,n.pineType=function(e){return e.startsWith(n.PinePrefix.USER)?n.PineType.UserSaved:e.startsWith(n.PinePrefix.PUB)?n.PineType.UserPublished:e.startsWith(n.PinePrefix.STD)||e.startsWith(n.PinePrefix.TV)||e.startsWith(n.PinePrefix.EDGR)?n.PineType.BuiltIn:n.PineType.Addon},n.patchILTemplate=function(e,t,i){var r=i||{};return n._patchTemplate(/<(in_\d+)>/g,e,t,r)},n.decorateQuotes=function(e){if(!e)return e;var t=/([^\\']+?)(')[^']*?/g,i="$1\\$2",n=e;return"'"==n.charAt(0)&&"'"==n.charAt(n.length-1)?"'"+(n=n.substr(1,n.length-2)).replace(t,i)+"'":n.replace(t,i)},n.patchInputs=function(e,t){var i={};for(var n in e)if(e.hasOwnProperty(n)){var r,s=e[n];r=s.isFake?{v:t[s.id],f:!0,t:s.type}:t[s.id],i[s.id]=r}return i},n._patchTemplate=function(e,t,i,r){var s=r||{};return t.replace(e,(function(e,t){for(var r=(t in s?s[t]:i.defaults.inputs[t]),o=0;o<i.inputs.length;++o)if(i.inputs[o].id===t)if("bool"===i.inputs[o].type)r=r?"1.0":"0.0";else if(["text","symbol","resolution","session"].indexOf(i.inputs[o].type)>=0)r="'"+n.decorateQuotes(r)+"'";else if("source"===i.inputs[o].type){var a=r.split("$");a[0]="'"+a[0]+"'",r="source("+a.join(",")+")"}return r}))},n.isStrategy=function(e){return/^\s*strategy\s*\(/m.test(e)};var r=/^\s*\/\/\s*?@version\s*?=\s*?(\S*?)\s*?$/gm,s=/^[0-9]+$/;n.extractVersion=function(e){r.lastIndex=0;var t=r.exec(e);if(null===t)return 1;var i=t[1],o=s.test(i)?Number(i):NaN
;return isNaN(o)?1:Math.max(n.TranslatorDefaultVersion,Math.min(o,n.TranslatorLastVersion))},n.canUpgradeVersion=function(e){return e>=3&&e<n.TranslatorLastVersion},n.canDowngradeVersion=function(e){return e>=4&&e<=n.TranslatorLastVersion},e&&e.exports&&(e.exports=n)},923995:(e,t,i)=>{"use strict";i.d(t,{alertsAvailable:()=>n});const n=i(931924).enabled("alerts")},44049:(e,t,i)=>{"use strict";i.d(t,{AsyncResourceWrapper:()=>n});class n{constructor(e,t){this._destroyed=!1,this._callbacks=[],this._resource={pendingResource:e},this._destroyFn=t,e.then((e=>{if(this._destroyed)this._destroyFn?.(e);else{this._resource.resource=e;for(const t of this._callbacks)t(e)}})).finally((()=>{this._callbacks=[]}))}destroy(){this._resource.resource&&this._destroyFn?.(this._resource.resource),this._resource={pendingResource:Promise.reject("Resource is destroyed").catch((()=>{}))},this._callbacks=[],this._destroyed=!0}callFunction(e){this._destroyed||(this._resource.resource?e(this._resource.resource):this._callbacks.push(e))}get(){return this._destroyed||!this._resource.resource?null:this._resource.resource}promise(){return this._resource.pendingResource}}},534328:(e,t,i)=>{"use strict";i.r(t),i.d(t,{alphaToTransparency:()=>o,applyAlpha:()=>s,applyTransparency:()=>l,colorFromBackground:()=>p,colorToInteger:()=>S,generateColor:()=>r,getLuminance:()=>d,gradientColorAtPercent:()=>h,isHexColor:()=>c,resetTransparency:()=>u,rgbaFromInteger:()=>f,rgbaToInteger:()=>y,transparencyToAlpha:()=>a});var n=i(724377);function r(e,t,i){if(t=t||0,!c(e))return i?(0,n.rgbaToString)((0,n.rgba)((0,n.parseRgb)(e),(0,n.normalizeAlphaComponent)(a(t)))):e;const[r,s,o]=(0,n.parseRgb)(e),l=(0,n.normalizeAlphaComponent)(a(t));return(0,n.rgbaToString)([r,s,o,l])}function s(e,t,i){const r=(0,n.tryParseRgba)(e);if(null===r)throw new Error(`Invalid color: ${e}`);const[s,o,a,l]=r,u=(0,n.normalizeAlphaComponent)(t*(i?l:1));return(0,n.rgbaToString)((0,n.rgba)([s,o,a],u))}function o(e){return 100*(1-e)}function a(e){if(e<0||e>100)throw new Error("invalid transparency");return 1-e/100}function l(e,t){if("transparent"===e)return e;const i=(0,n.parseRgba)(e),r=i[3];return(0,n.rgbaToString)((0,n.rgba)(i[0],i[1],i[2],a(t)*r))}function u(e){return"transparent"===e?e:c(e)?e.slice(0,7):(0,n.rgbaToString)((0,n.rgba)((0,n.parseRgb)(e),(0,n.normalizeAlphaComponent)(1)))}function d(e){const t=(0,n.parseRgb)(e).map((e=>(e/=255)<=.03928?e/12.92:Math.pow((e+.055)/1.055,2.4)));return Number((.2126*t[0]+.7152*t[1]+.0722*t[2]).toFixed(3))}function c(e){return 0===e.indexOf("#")}function p(e){return"black"===(0,n.rgbToBlackWhiteString)((0,n.parseRgb)(e),150)?"#ffffff":"#000000"}function h(e,t,i){const[r,s,o,a]=(0,n.parseRgba)(e),[l,u,d,c]=(0,n.parseRgba)(t),p=(0,n.rgba)(Math.round(r+i*(l-r)),Math.round(s+i*(u-s)),Math.round(o+i*(d-o)),a+i*(c-a));return(0,n.rgbaToString)(p)}function f(e){const t=(e=Math.round(e))%256;e-=t;const i=(e/=256)%256;e-=i;const n=(e/=256)%256;e-=n;return`rgba(${t},${i},${n},${(e/=256)/255})`}function y(e){const t=Math.round(255*e[3])
;return e[0]+256*e[1]+65536*e[2]+16777216*t}function S(e){const t=(0,n.tryParseRgba)(e);return null===t?0:y(t)}},136734:(e,t,i)=>{"use strict";i.d(t,{getPersistentLogger:()=>r,setPersistentLogger:()=>s});let n=null;function r(){return n}function s(e){n=e}}}]);