"use strict";(self.webpackChunktradingview=self.webpackChunktradingview||[]).push([[89810],{150112:(t,e,i)=>{i.d(e,{createDwmAligner:()=>l,createTimeToBarTimeAligner:()=>d});var s=i(276536),n=i(257253),r=i(89523),o=i(313503);const a=new r.SessionInfo("Etc/UTC","0000-0000:1234567");function l(t,e,i){if(!t||!n.Interval.isDWM(e))return null;const l=new r.SessionInfo(i.timezone,i.session,i.session_holidays,i.corrections),d=(0,o.newBarBuilder)(e,l,a);return{timeToSessionStart:t=>d.tradingDayToSessionStart(t),timeToExchangeTradingDay:t=>{const e=(0,s.utc_to_cal)(l.timezone,t),i=l.spec.correctTradingDay(e);return(0,s.set_hms)(i,0,0,0,0,(0,s.get_timezone)("Etc/UTC")),i.getTime()}}}function d(t,e,i){if(!t)return t=>t;const s=new r.SessionInfo(i.timezone,i.session,i.session_holidays,i.corrections),n=(0,o.newBarBuilder)(e,s,s,!1);return t=>n.alignTimeIfPossible(t)}},744380:(t,e,i)=>{i.d(e,{IntervalsVisibilitiesProperty:()=>r});var s=i(905520),n=i(816541);class r extends s.Property{state(t,e){return(0,n.nonDefaultIntervalsVisibilities)(super.state(t,e))??void 0}storeStateIfUndefined(){return!1}}},790394:(t,e,i)=>{i.d(e,{LineDataSourcePointIndexProperty:()=>n});var s=i(905520);class n extends s.Property{constructor(t,e){super(),this._waitingPointsetUpdate=!1,this._lineSource=t,this._pointIndex=e,this._cachedIndex=this.value()}value(){const t=this._lineSource.points();return 0===t.length?this._cachedIndex:t[this._pointIndex].index}setValue(t){this._cachedIndex=t;const e=this._lineSource.points(),i=t=>{const e=this._lineSource.points()[this._pointIndex];if(e.index===t)return;e.index=t,this._lineSource.startChanging(this._pointIndex,e),this._setPointImpl(e),this._lineSource.model().updateSource(this._lineSource),this._listeners.fire(this,"");const i=this._lineSource.endChanging(!0,!1);this._lineSource.syncMultichartState(i)};if(0===e.length){const t=()=>{i(this._cachedIndex),this._waitingPointsetUpdate=!1};if(this._waitingPointsetUpdate)return;this._lineSource.pointsetUpdated().subscribe(this,t,!0),this._waitingPointsetUpdate=!0}else i(t)}_setPointImpl(t){this._lineSource.setPoint(this._pointIndex,t)}}},231842:(t,e,i)=>{i.d(e,{LineToolPriceAxisView:()=>o});var s=i(650151),n=i(597331),r=i(534328);class o extends n.PriceAxisView{constructor(t,e){super(),this._source=t,this._data=e,this._properties=t.model().properties().childs().scalesProperties}_updateRendererData(t,e,i){t.visible=!1;const s=this._source.model();if(!s.timeScale()||s.timeScale().isEmpty())return;const n=this._source.priceScale();if(null===n||n.isEmpty())return;if(!s.selection().isSelected(this._source)&&!this._source.isForcedDrawPriceAxisLabel())return;if(null===s.timeScale().visibleBarsStrictRange())return;const o=this._source.priceAxisPoints(),a=this._data.pointIndex;if(o.length<=a)return;const l=o[a];if(!isFinite(l.price))return;const d=this._source.ownerSource(),u=null!==d?d.firstValue():null;if(null===u)return;let h=this._data.backgroundPropertyGetter?this._data.backgroundPropertyGetter():null;null===h&&(h=this._getBgColor()),i.background=(0,
r.resetTransparency)(h),i.borderColor="#2E84A6",i.textColor=this.generateTextColor(i.background),i.coordinate=n.priceToCoordinate(l.price,u),t.text=this._formatPrice(l.price,u),t.visible=!0}_getBgColor(){return this._active?this._properties.childs().axisLineToolLabelBackgroundColorActive.value():this._properties.childs().axisLineToolLabelBackgroundColorCommon.value()}_formatPrice(t,e){return(0,s.ensureNotNull)(this._source.priceScale()).formatPrice(t,e)}}},515779:(t,e,i)=>{i.d(e,{LineDataSourceTimeAxisView:()=>n});var s=i(87521);class n extends s.TimeAxisView{constructor(t,e){super(t.model()),this._active=!1,this._source=t,this._pointIndex=e,this._properties=t.model().properties().childs().scalesProperties}setActive(t){this._active=t}_getBgColor(){return this._active?this._properties.childs().axisLineToolLabelBackgroundColorActive.value():this._properties.childs().axisLineToolLabelBackgroundColorCommon.value()}_getIndex(){if(!this._model.selection().isSelected(this._source))return null;const t=this._source.timeAxisPoints();return t.length<=this._pointIndex?null:t[this._pointIndex].index}_isVisible(){return!0}}},318945:(t,e,i)=>{i.d(e,{LineDataSource:()=>q,changePointUndoText:()=>$});var s=i(378338),n=i(610555),r=i(650151),o=i(536794),a=i(251954),l=i(735566),d=i(931924),u=i(482707),h=i(196717),c=i(68777),_=i(547465),p=i(586563),y=i(677500),S=i(75060),g=i(234938),m=i(923995),v=i(972806),f=i(820028),P=i(239949),b=i(306543),A=i(816541),C=i(266954),w=i(388741),I=i(616427),T=i(477786),x=i(905520),V=i(87913),D=i(644036),L=i(744380),M=i(437642),E=i(678949),F=i(418450),k=i(790394);class N extends x.Property{constructor(t,e){super(),this._lineSource=t,this._pointIndex=e,t.pointAdded().subscribe(this,(t=>{this._pointIndex===t&&this._listeners.fire(this,`${t}`)})),t.pointChanged().subscribe(this,(t=>{this._pointIndex===t&&this._listeners.fire(this,`${t}`)}))}value(){const t=this._lineSource.points()[this._pointIndex].price,e=(0,r.ensureNotNull)(this._lineSource.ownerSource()).formatter();if(e.parse){const i=e.format(t),s=e.parse(i);return s.res?s.value:t}return t}setValue(t){const e=this._lineSource.points()[this._pointIndex];e.price=parseFloat(""+t),this._lineSource.startChanging(this._pointIndex,e),this._lineSource.setPoint(this._pointIndex,e),this._lineSource.model().updateSource(this._lineSource),this._listeners.fire(this,"");const i=this._lineSource.endChanging(!0,!1);this._lineSource.syncMultichartState(i)}}var U=i(515779),z=i(231842),O=i(702067),R=i(772062),B=i(85858),H=i(881727);const W=(0,l.getLogger)("Chart.LineDataSource"),G=d.enabled("datasource_copypaste");class j{constructor(){this._states=[]}start(t){this._states.push(t)}finish(t){const e=(0,r.ensureDefined)(this._states.pop());return s=e,(i=t).length!==s.length?{indexesChanged:!0,pricesChanged:!0}:i.reduce(((t,e,i)=>{const n=s[i];return t.indexesChanged=t.indexesChanged||e.index!==n.index,t.pricesChanged=t.pricesChanged||e.price!==n.price,t}),{indexesChanged:!1,pricesChanged:!1});var i,s}isEmpty(){return 0===this._states.length}}let K=0
;const $=new F.TranslatedString("change point",s.t(null,void 0,i(776660)));class q extends D.DataSource{constructor(t,e,i,s){if(super(s),this.isLineTool=!0,this.version=1,this.toolname="",this.customization={forcePriceAxisLabel:!1,disableErasing:!1,disableSave:!1,showInObjectsTree:!0},this._currentPointsetAndSymbolId=null,this._pointChanged=new _.Delegate,this._pointAdded=new _.Delegate,this._priceAxisViews=[],this._timeAxisViews=[],this._timePoint=[],this._points=[],this._lastPoint=null,this._paneViews=new Map,this._signaturesPaneViews=new Map,this._normalizedPointsChanged=new _.Delegate,this._fixedPointsChanged=new _.Delegate,this._changeStatesStack=new j,this._startMovingPoint=null,this._currentMovingPoint=null,this._isActualSymbol=!1,this._isActualInterval=!1,this._isActualCurrency=!1,this._isActualUnit=!1,this._symbolSource=null,this._symbolSourceSymbolInfo=null,this._sharingMode=new f.WatchedValue(0),this._onTemplateApplying=new _.Delegate,this._onTemplateApplied=new _.Delegate,this._syncStateExclusions=["interval"],this._definitionsViewModel=null,this._hasEditableCoordinates=new f.WatchedValue(!0),this._syncLineStyleMuted=!1,this._onIsActualIntervalChange=new _.Delegate,this._onIsActualSymbolChange=new _.Delegate,this._onPointsetUpdatedDelegate=new _.Delegate,this._onServerUpdateTime=new _.Delegate,this._linkKey=new f.WatchedValue(null),this._serverUpdateTime=null,this._boundCalcIsActualSymbol=this.calcIsActualSymbol.bind(this),this._alignerCache=null,this._alertUndoMode=!1,this._targetSignature=new f.WatchedValue(null),this._firstSignatureOwnerSource=null,this._sourcesSignatures=null,this._onAlertStatusChanged=()=>{this.updateAllViewsAndRedraw((0,M.sourceChangeEvent)(this.id()))},this._model=t,this._properties=e,this._localAndServerAlertsMismatch=!1,this._properties.hasChild("interval")||this._properties.addChild("interval",new x.Property(t.mainSeries().interval())),this.calcIsActualSymbol(),this._properties.childs().intervalsVisibilities.subscribe(this,this.calcIsActualSymbol),this._properties.subscribe(this,this.propertiesChanged.bind(this,!1,void 0)),this.zOrderChanged().subscribe(this,this.propertiesChanged.bind(this,!0,void 0)),this._createPointsProperties(),this.pointsCount()>0)for(let t=0;t<this.pointsCount();t++)this._priceAxisViews.push(this.createPriceAxisView(t)),this._timeAxisViews.push(new U.LineDataSourceTimeAxisView(this,t));this._properties.childs().visible.subscribe(this,(t=>{const e=!1===(0,V.hideAllDrawings)().value();t.value()?t.value()&&e&&a.emit("drawing_event",this._id.value(),"show"):(this._model.selection().isSelected(this)&&this._model.selectionMacro((t=>{t.removeSourceFromSelection(this)})),e&&a.emit("drawing_event",this._id.value(),"hide")),this._onSourceHiddenMayChange()})),(0,V.hideAllDrawings)().subscribe(this,this._onSourceHiddenMayChange),this._sessionConnected=this._model.chartApi().isConnected().spawn(),this._sessionConnected.subscribe((t=>{t||(this._currentPointsetAndSymbolId=null)})),this._alertStatus.subscribe(this._onAlertStatusChanged),this._definitionsViewModel=null,
this._properties.setNameInOwner((0,H.propertyPathForSource)(this)),i||this._updateAdjustedToSplitTimeValue(!0),this._sourcesSignatures=t.sourcesSignatures().spawn(),this._sourcesSignatures.subscribe(this._updateSignaturesPaneViews.bind(this)),this._targetSignature.subscribe(this._updateSignaturesPaneViews.bind(this)),this.supportsTargetSignature()&&(this._firstSignatureOwnerSource=(0,c.combine)(((t,e)=>e.find((e=>e.signature().value()===t))??null),this._targetSignature.weakReference(),t.signatureSources().weakReference()),this._firstSignatureOwnerSource.subscribe((t=>{this.setOwnerSource(t),t&&this._model.realignLineTools(t.symbolSource())})))}destroy(){this._paneViews.forEach(((t,e)=>this._destroyPanePaneViews(e))),this.stop(),null!==this._definitionsViewModel&&(this._definitionsViewModel.destroy(),this._definitionsViewModel=null),null!==this._ownerSource&&(this._ownerSource.currencyChanged().unsubscribeAll(this),this._ownerSource.unitChanged().unsubscribeAll(this),(0,E.isSymbolSource)(this._ownerSource)&&(this._ownerSource.symbolResolved().unsubscribeAll(this),this._ownerSource.isActingAsSymbolSource().unsubscribe(this._boundCalcIsActualSymbol))),this.ownerSourceChanged().unsubscribeAll(this),this._symbolSource?.destroy(),this._symbolSourceSymbolInfo?.destroy(),(0,V.hideAllDrawings)().unsubscribeAll(this),this.deleteAlert(),this._sessionConnected.destroy(),this._alertStatus.unsubscribe(this._onAlertStatusChanged),this._properties.destroy(),this._sourcesSignatures?.destroy(),this._firstSignatureOwnerSource?.destroy(),super.destroy()}setId(t){super.setId(t),this._properties.setNameInOwner((0,H.propertyPathForSource)(this))}priceScale(){return this._ownerSource?this._ownerSource.priceScale():null}createPriceAxisView(t){return new z.LineToolPriceAxisView(this,{pointIndex:t})}model(){return this._model}symbol(){return this._properties.childs().symbol.value()}linkKey(){return this._linkKey}serverUpdateTime(){return this._serverUpdateTime}setServerUpdateTime(t){this._serverUpdateTime=t,this._onServerUpdateTime.fire()}serverUpdateTimeChanged(){return this._onServerUpdateTime}adjustedToSplitTime(){let t=this._properties.childs().adjustedToSplitTime.value();return null===t&&null!==this._serverUpdateTime&&(t=this._serverUpdateTime/1e3),t}adjustToSplit(t,e){for(const e of this._points)e.price*=t;for(const e of this._timePoint)e.price*=t;this._points.forEach(((t,e)=>{this._pointChanged.fire(e)})),this._properties.childs().adjustedToSplitTime.setValue(e);const i=this.linkKey().value();null!==i&&this.isSynchronizable()&&(0,V.restoreLineToolState)({model:this._model,linkKey:i,state:this.state()})}boundToSymbol(){return!0}isAvailableInFloatingWidget(){return!0}points(){const t=[];for(let e=0;e<this._points.length;e++){const i=this._points[e];t.push({index:i.index,price:i.price,time:i.time})}return this._lastPoint&&t.push(this._correctLastPoint(this._lastPoint)),!this.isFixed()&&this._currentMovingPoint&&this._startMovingPoint&&this._correctPoints(t),t}timeAxisPoints(){return this.points()}priceAxisPoints(){return this.points()}
fixedPoint(t){if(!this.isFixed())return;let e;const i=t?t.priceScale():this.priceScale();if(this._positionPercents&&null!==i&&!i.isEmpty()){const t=this._positionPercents,s=this._model.timeScale().width()*t.x,r=i.height()*t.y;e=new n.Point(s,r)}else void 0!==this._fixedPoint&&(e=this._fixedPoint?.clone());if(this._currentMovingPoint&&this._startMovingPoint&&void 0!==e){const t=this._correctFixedPoint(e);t.didCorrect&&(e=t.point)}return e}positionPercents(){return this.isFixed()?this._positionPercents:void 0}clearFixedPoint(){this._fixedPoint=void 0,this._positionPercents=void 0}normalizedPoints(){return this._timePoint}normalizedPointsForCreating(){return this.normalizedPoints()}normalizedPointsChanged(){return this._normalizedPointsChanged}fixedPointChanged(){return this._fixedPointsChanged}geometry(){const t=(0,r.ensureNotNull)(this.priceScale());return this.points().map((e=>{const i=(0,r.ensureNotNull)(this.pointToScreenPoint(e)),s=i.x/this._model.timeScale().width(),o=i.y/t.height();return new n.Point(s,o)}))}widthsProperty(){return this._properties.childs().linesWidths??null}lineColorsProperty(){return this._properties.childs().linesColors??null}backgroundColorsProperty(){return this._properties.childs().backgroundsColors??null}textColorsProperty(){return this._properties.childs().textsColors??null}pointsProperty(){return this._pointsProperty}hasEditableCoordinates(){return this._hasEditableCoordinates}startMoving(t,e,i,s){this.isFixed()&&this.restoreFixedPoint(),this._startMovingPoint=t}move(t,e,i,s){if(i&&(i.shiftOnly()||i.modShift()))if(this.isFixed()){const e=this._alignScreenPointHorizontallyOrVertically((0,r.ensureDefined)(t.screen));this._currentMovingPoint={screen:e}}else{const e=this._alignPointHorizontallyOrVertically((0,r.ensureDefined)(t.logical)),i=(0,r.ensureNotNull)(this.pointToScreenPoint(e));this._currentMovingPoint={logical:e,screen:i}}else this._currentMovingPoint=t;this.updateAllViews((0,M.sourceChangeEvent)(this.id()))}endMoving(t,e,i){let s=!1,n=!1;if(this._currentMovingPoint&&this._startMovingPoint){if(this.isFixed()){const t=this._correctFixedPoint((0,r.ensureDefined)(this._fixedPoint));t.didCorrect&&(this._fixedPoint=t.point,this._fixedPointsChanged.fire())}else{const t=(0,r.ensureDefined)(this._currentMovingPoint.logical),e=(0,r.ensureDefined)(this._startMovingPoint.logical);s=t.index!==e.index,n=t.price!==e.price;if(this._correctPoints(this._points,i)){const t=this._id.value();a.emit("drawing_event",t,"move"),a.emit("drawing_event",t,"points_changed"),this._updateAdjustedToSplitTimeValue();for(let t=0;t<this._points.length;t++)this._pointChanged.fire(t)}}this._startMovingPoint=null,this._currentMovingPoint=null}const o={indexesChanged:s,pricesChanged:n};return this.isFixed()?(this.calcPositionPercents(),this.updateAllViews((0,M.sourceChangeEvent)(this.id())),o):(s&&this._points.forEach((t=>t.interval=this._model.mainSeries().interval())),this.updateAllViews((0,M.sourceChangeEvent)(this.id())),s&&!t?(this._properties.childs().interval.setValue(this._model.mainSeries().interval()),
this._normalizePoints(),this.createServerPoints()):(this._copyPricesWithoutNormalization(),this._normalizedPointsChanged.fire()),e||!n&&!s||this.synchronizeAlert(!this._alertUndoMode),o)}startMovingPoint(){return this._startMovingPoint?{...this._startMovingPoint}:null}currentMovingPoint(){return this._currentMovingPoint?{...this._currentMovingPoint}:null}changePointUndoText(t){return $}startChanging(t,e){this.isFixed()&&this.restoreFixedPoint(),void 0!==t&&void 0!==e&&(t<this._priceAxisViews.length&&this._priceAxisViews[t].setActive(!0),t<this._timeAxisViews.length&&this._timeAxisViews[t].setActive(!0)),this._changeStatesStack.start(this.points())}endChanging(t,e,i){const s=this._changeStatesStack.finish(this.points());s.indexesChanged&&this._changeStatesStack.isEmpty()?(this._normalizePoints(),e||this.createServerPoints()):(this._copyPricesWithoutNormalization(),this._normalizedPointsChanged.fire()),a.emit("drawing_event",this._id.value(),"points_changed"),this._updateAdjustedToSplitTimeValue();for(let t=0;t<this._priceAxisViews.length;t++)this._priceAxisViews[t].setActive(!1);for(let t=0;t<this._timeAxisViews.length;t++)this._timeAxisViews[t].setActive(!1);return i||this.synchronizeAlert(!t),s}setPoint(t,e,i,s){if(this._snapTo45DegreesApplicable(i)){const i=0===t?1:t-1;this.snapPoint45Degree(e,this.points()[i])}this._setPoint(t,{...e,interval:this._model.mainSeries().interval()})}getPoint(t){return this.points()[t]||null}alignCrossHairToAnchor(t){return!0}alignCrossHairToMovePoint(){return!1}setLastPoint(t,e,i=!0){return this._lastPoint=i?this._preparePoint(t,e):t,this.updateAllViews((0,M.sourceChangeEvent)(this.id())),this._lastPoint}lastPoint(){return this._lastPoint}getChangePointForSync(t){return this.getPoint(t)}setPoints(t){const e=this._model.mainSeries().interval();this._points=t.map((t=>({...t,interval:t.interval??e})))}isForcedDrawPriceAxisLabel(){return this.customization.forcePriceAxisLabel}clearData(){this._points=[]}denormalizeTimePoints(){let t=[];const e=this._model.mainSeries().interval();for(let i=0;i<this._timePoint.length;i++){const s=this._model.timeScale().denormalizeTimePoint(this._timePoint[i]);if(void 0===s){t=[];break}t.push({index:s,price:this._timePoint[i].price,interval:this._timePoint[i].interval??e})}t.length>0&&(this._points=t)}restorePoints(t,e,i){const s=this._timePoint.length>0&&!(0,o.deepEquals)(this._timePoint,t)[0],n=this._properties.childs().interval.value();this._timePoint=t.map((t=>({...t,interval:t.interval??n})));const r=this._model.mainSeries().interval();this._points=e.map((t=>({...t,interval:r}))),i||this.denormalizeTimePoints(),s&&this._normalizedPointsChanged.fire()}restorePositionPercents(t){this._positionPercents=t,this.restoreFixedPoint()}calcIsActualSymbol(){const t=this.ownerSource(),e=this._isActualSymbol;if(null===t)this._isActualSymbol=!1;else{const t=this._symbolSource?.value(),e=this._symbolSourceSymbolInfo?.value();if(e&&t){this._migrateSymbolProperty(e);const i=this._properties.childs().symbol,s=i.value();if(this._isActualSymbol=t.symbolSameAsCurrent(s),
this._isActualSymbol){const n=(0,w.extractLineToolSymbolFromSymbolInfo)(e,t.symbol());(0,I.areEqualSymbols)(s,n)||(W.logWarn('Possible drawing "migrating" detected from "'+s+'" to "'+n+'"'),W.logWarn("Series symbolInfo: "+JSON.stringify(t.symbolInfo())),W.logWarn(`${(new Error).stack}`)),i.setValue(n)}}}this._isActualSymbol!==e&&this._onIsActualSymbolChange.fire(),this.calcIsActualInterval(),this.calcIsActualCurrency(),this.calcIsActualUnit(),this._onSourceHiddenMayChange()}calcIsActualCurrency(){const t=this.ownerSource();if(null===t)return void(this._isActualCurrency=!1);let e=this._properties.childs().currencyId.value();if(null!==e){const i=t.symbolSource();"pct"===e&&(this._properties.childs().currencyId.setValue(null),e=null),this._isActualCurrency=e===(0,w.symbolCurrency)(i.symbolInfo(),void 0,!0)}else{const e=(0,r.ensureNotNull)(t.symbolSource());this._isActualCurrency=null!==e.symbolInfo()&&!e.isConvertedToOtherCurrency()}this._onSourceHiddenMayChange()}calcIsActualUnit(){const t=this.ownerSource();if(null===t)return void(this._isActualUnit=!1);const e=this._properties.childs().unitId.value();if(null!==e)this._isActualUnit=e===(0,r.ensureNotNull)(t.symbolSource()).unit();else{const e=(0,r.ensureNotNull)(t.symbolSource());this._isActualUnit=null!==e.symbolInfo()&&!e.isConvertedToOtherUnit()}this._onSourceHiddenMayChange()}calcIsActualInterval(){const t=this._isActualInterval,e=this._properties,i=this._model.mainSeries();this._isActualInterval=(0,A.isActualInterval)(T.Interval.parse(i.interval()),e.childs().intervalsVisibilities),!this._isActualInterval&&this._model.selection().isSelected(this)&&this._model.selectionMacro((t=>t.removeSourceFromSelection(this))),this._isActualInterval!==t&&this._onIsActualIntervalChange.fire(),this._onSourceHiddenMayChange()}paneViews(t){if(this.isSourceHidden())return null;const e=this._getPaneViews(this.isMultiPaneAvailable()?t:void 0);if(null===e)return null;if(1===e.length)return[e[0]];const i=[];for(let t=e.length-1;t>=0;--t)i.push(e[t]);return i}priceAxisViews(t,e){if(this.isFixed())return null;if(e!==this.priceScale()||this.isSourceHidden())return null;if(this._model.lineBeingEdited()===this){const t=this._model.linePointBeingEdited();if(null!==t&&t<this._priceAxisViews.length){const e=this._priceAxisViews.slice(),i=e[t];return e.splice(t,1),e.push(i),e}return this._priceAxisViews}return this._priceAxisViews}timeAxisViews(){if(this.isSourceHidden()||this.isFixed())return null;if(this._model.lineBeingEdited()===this){const t=this._model.linePointBeingEdited();if(null!==t&&t<this._timeAxisViews.length){const e=this._timeAxisViews.slice(),i=e[t];return e.splice(t,1),e.push(i),e}return this._timeAxisViews}return this._timeAxisViews}isSavedInChart(){return!this.customization.disableSave}isSavedInStudyTemplates(){return!1}setSavingInChartEnabled(t){this.customization.disableSave=!t}shouldBeRemovedOnDeselect(){return!1}getOrderTemplate(){return null}getSourceIcon(){return{type:"loadSvg",svgId:"linetool."+this.toolname}}alertId(){return this._alertId}async waitSettingAlertId(){
this._pendingAlertIdPromise&&(this._alertId=await this._pendingAlertIdPromise)}async setAlert(t,e={}){if(!this.canHasAlert())throw new Error("Line data source can not has alert");if(this._pendingAlertIdPromise)return void W.logWarn("Setting alert of line data source will be ignored because alert is already being set");if((0,o.isPromise)(t)){this._pendingAlertIdPromise=t;try{await this.waitSettingAlertId()}finally{delete this._pendingAlertIdPromise}}else this._alertId=t;const i=(0,r.ensureDefined)(this._alertId);this._hasAlert.setValue(!0),this._alertStatus.setValue(1),this._removeAlertSubscriptions(),await this._syncAlertWithAlertFacade(e);const s=this.linkKey().value();s&&!e.sync&&this._syncLineStyleChanges(s,{},i)}async restoreAlert(t,e){if(!this.canHasAlert())throw new Error("Line data source can not has alert");this._alertId=t,this._hasAlert.setValue(!0);try{const t=await this.getAlert();if(!t)return;this._addAlertSubscriptions(t,e)}catch(t){this._removeAlertSubscriptions()}}editAlert(t){this.hasAlert().value()&&(0,y.getChartAlertsFacade)().then((e=>{e.openEditDialog((0,r.ensureDefined)(this._alertId),{dataSourceHub:this._model,actionSource:t,onAborted:t=>{t===v.AlertEditorAbortReason.AlertIsInvalid&&this.removeAlert()}})}))}async getAlert(){try{const t=await this._getChartAlert();if(!t)throw W.logError("Failed to get alert, alert will not be saved with drawing in chart"),new Error("got_no_alert");return t}catch(t){if(t instanceof Error&&"not implemented"===t.message)throw t;if("not_exists"===t)throw new Error(t);return W.logError(`Getting alert failed: ${t instanceof Error?t.message:t}`),null}}getAlertSync(){if(!this._alertId)return null;const t=(0,y.getChartAlertsFacadeIfCreatedBefore)();return null===t?null:t.getAlertSync(this._alertId)??null}async synchronizeAlert(t=!1){if(this.hasAlert().value()||this._pendingAlertIdPromise)return new Promise(((e,i)=>{setTimeout((async()=>{if(!this._isDestroyed)try{await this.waitSettingAlertId(),0===this._alertStatus.value()&&await this._syncAlertWithAlertFacade(),this.hasAlert().value()&&await this._synchronizeAlert(t),e()}catch(t){i(t)}}),0)}))}syncAlert(t){this.hasAlert().value()||this.setAlert(t,{sync:!0})}stateForAlert(){if(!this.canHasAlert())return null;const t=this.state();let e={points:t.points,state:t.state,type:t.type,id:this.idForAlert(),title:this.translatedType(),interval:this._model.mainSeries().interval(),text:this._properties.childs().text?.value()??this._properties.childs().labelText?.value()};const i=this._getAlertPlots();return i&&i.length>0&&(e={...e,plots:i}),e}async stateForAlertAsync(){return this.canHasAlert()?(this._points.length||(this.isStarted()||this.createServerPoints(),await this._awaitForPointset()),this.stateForAlert()):null}getAlertIsActive(){if(!this._alertId)return!1;const t=this.getAlertSync();return Boolean(t&&t.active().value())}detachAlert(){this._removeAlertSubscriptions(),this._hasAlert.setValue(!1),this._alertId=void 0,this._alertStatus.setValue(0)}removeAlert(){this._alertId=void 0,this._hasAlert.setValue(!1),
this._alertStatus.setValue(0),this._removeAlertSubscriptions()}deleteAlert(){if(!this.hasAlert().value()||void 0===this._alertId)return;const t=(0,y.getChartAlertsFacadeIfCreatedBefore)();t&&t.deleteAlert(this._alertId),this.removeAlert()}areLocalAndServerAlertsMismatch(){return this._localAndServerAlertsMismatch}showInObjectTree(){return this.customization.showInObjectsTree}setShowInObjectsTreeEnabled(t){this.customization.showInObjectsTree=t}start(){this.createServerPoints()}processHibernate(){this.canBeHibernated()?this.isStarted()&&this.stop():this.isStarted()||this.start()}canBeHibernated(){return this.isSourceHidden()}onData(t){"pointset_error"!==t.method?t.params.customId===this._currentPointsetIdWithPrefix()&&this._onPointsetUpdated(t.params.plots):W.logError(`Error getting pointset: ${t.params[0]} ${t.params[1]}`)}isBeingEdited(){return this===this._model.lineBeingEdited()}isActualSymbol(){return this._isActualSymbol}isActualCurrency(){return this._isActualCurrency}isActualInterval(){return this._isActualInterval}isActualUnit(){return this._isActualUnit}onIsActualIntervalChange(){return this._onIsActualIntervalChange}onIsActualSymbolChange(){return this._onIsActualSymbolChange}setOwnerSource(t){if(null!==this._ownerSource&&(this._ownerSource.currencyChanged().unsubscribeAll(this),this._ownerSource.unitChanged().unsubscribeAll(this),this._symbolSource?.destroy(),this._symbolSource=null,this._symbolSourceSymbolInfo?.destroy(),this._symbolSourceSymbolInfo=null),super.setOwnerSource(t),t){this._symbolSource=t.symbolSourceWV().spawn();const e=(0,c.combine)((t=>[t.symbolInfoWV().weakReference()]),this._symbolSource.weakReference());this._symbolSourceSymbolInfo=(0,c.accumulate)((t=>t[0]??null),e.ownership()),this._symbolSourceSymbolInfo.subscribe(this._boundCalcIsActualSymbol),this.setPriceScale(t.priceScale()),t.currencyChanged().subscribe(this,this.calcIsActualCurrency),t.unitChanged().subscribe(this,this.calcIsActualUnit),this.calcIsActualSymbol(),this._migrateZOrder(),this._updateAlertCreationAvailable()}(0,E.isSymbolSource)(t)&&(t.symbolResolved().subscribe(this,this._boundCalcIsActualSymbol),t.isActingAsSymbolSource().subscribe(this._boundCalcIsActualSymbol))}dataAndViewsReady(){return this._paneViews.size>0}pointAdded(){return this._pointAdded}pointChanged(){return this._pointChanged}pointsetUpdated(){return this._onPointsetUpdatedDelegate}pointToScreenPoint(t,e){const i=this._model.timeScale(),s=e?e.priceScale():this.priceScale(),r=(e??this.ownerSource())?.firstValue();if(!s||s.isEmpty()||i.isEmpty()||null==r)return null;const o=i.indexToCoordinate(t.index),a=s.priceToCoordinate(t.price,r);return new n.Point(o,a)}screenPointToPoint(t,e,i){const s=i?i.priceScale():this.priceScale(),n=(i??this.ownerSource())?.firstValue();if(null==n||!isFinite(n)||null===s)return null;const r=this._model.timeScale(),o=e?r.coordinateToFloatIndex(t.x):r.coordinateToIndex(t.x);return{price:s.coordinateToPrice(t.y,n),index:o}}calcMiddlePoint(t,e){return new n.Point((t.x+e.x)/2,(t.y+e.y)/2)}addPoint(t,e,i){
const s=this._preparePoint(t,e);return this._addPointIntenal(s,e,i)}addFixedPoint(t){return this._fixedPoint=t,this.calcPositionPercents(),!0}calcPositionPercents(){const t=this.priceScale();if(!t||t.isEmpty()||void 0===this._fixedPoint)return;const e=this._fixedPoint.x/this._model.timeScale().width(),i=this._fixedPoint.y/t.height();return this._positionPercents={x:e,y:i},this._positionPercents}restoreFixedPoint(){this._fixedPoint=this.fixedPoint()}propertiesChanged(t,e){this.calcIsActualInterval(),this.updateAllViewsAndRedraw((0,M.sourceChangeEvent)(this.id())),e||this._syncLineStyleIfNeeded(t),t||void 0!==this._pendingPropertyChangedEvent||(this._pendingPropertyChangedEvent=setTimeout((()=>{this._pendingPropertyChangedEvent=void 0,a.emit("drawing_event",this._id.value(),"properties_changed")}),0))}state(t){const e=this.toolname,i=this.ownerSource(),s={type:e,id:this.id(),state:this.properties().state(this._propertiesStateExclusions()),points:(0,p.deepCopy)(this._timePoint),zorder:this.zorder(),ownerSource:i?.id()},n=this._targetSignature.value();return this.supportsTargetSignature()&&n&&(s.targetSignature=n),this.linkKey().value()&&(s.linkKey=this.linkKey().value()),0!==this._sharingMode.value()&&(s.sharingMode=this._sharingMode.value()),delete s.state.points,t&&(s.indexes=this._points),this.isFixed()&&(s.positionPercents=this._positionPercents||this.calcPositionPercents()),"version"in this&&1!==this.version&&(s.version=this.version),this._saveAlertIdInState()&&this.hasAlert().value()&&void 0!==this._alertId&&(s.alertId=this._alertId),s}updateAllViews(t){this.isSourceHidden()||"data-source-change"===t.type&&this._ignoreSourceEvent(t)||(this._updateAllPaneViews(t),this._priceAxisViews.forEach((e=>e.update(t))),this._timeAxisViews.forEach((e=>e.update(t))))}updateAllViewsAndRedraw(t){this.updateAllViews(t),this._model.updateSource(this)}tags(){return[this.toolname]}properties(){return this._properties}restoreExternalPoints(t,e){try{if(this._timePoint=(0,p.deepCopy)(t.points),e.indexesChanged){if(this.properties().childs().interval.setValue(t.interval),!this.isActualSymbol())return void this._clearServerPoints();this.createServerPoints()}else{const e=Math.min(this._points.length,t.points.length);for(let i=0;i<e;i++)this._points[i].price=t.points[i].price}this.updateAllViewsAndRedraw((0,M.sourceChangeEvent)(this.id()))}finally{this._normalizedPointsChanged.fire()}}restoreExternalState(t){this.properties().mergeAndFire(t)}applyTemplate(t){this._onTemplateApplying.fire(t),this._applyTemplateImpl(t),this.calcIsActualSymbol(),this.updateAllViews((0,M.sourceChangeEvent)(this.id())),this.model().lightUpdate(),this._onTemplateApplied.fire()}template(){return this.properties().preferences()}isFixed(){return!1}anchorable(){return!1}isLocked(){const t=this.properties().child("frozen");return void 0!==t&&t.value()}isSourceHidden(){return!this._properties.childs().visible.value()||(0,V.hideAllDrawings)().value()&&this.canBeHidden()||!this._isActualInterval||!this._isActualSymbol||!this._isActualCurrency||!this._isActualUnit}
isSynchronizable(){return this.priceScale()===this._model.mainSeries().priceScale()}copiable(){return G}cloneable(){return null!==this._ownerSource&&null!==this._ownerSource.firstValue()}movable(){return!0}allowsMovingBetweenPanes(){return!1}async getPropertyDefinitionsViewModel(){if(null===this._definitionsViewModel){const t=await this._getPropertyDefinitionsViewModelClass();return null===t||this._isDestroyed?null:(this._definitionsViewModel=new t(this._model.undoModel(),this),this._definitionsViewModel)}return this._definitionsViewModel}title(){return this.translatedType()}translatedType(){return R.lineToolsLocalizedNames[this.toolname]??"Line Tool"}name(){return"Line Tool"}createServerPoints(){if(!this._isActualSymbol)return;if(!this._model.chartApi().isConnected().value())return;if(this._clearServerPoints(),this._model.timeScale().isEmpty())return;if(0===this._timePoint.length&&this._points.length>0&&this._normalizePoints(),!this._readyToCreatePointset())return;const t=this._pointsForPointset();if(0===t.length)return;++K,this._currentPointsetAndSymbolId={pointsetId:K,symbolId:(0,r.ensureNotNull)(this._model.mainSeries().seriesSource().symbolInstanceId())};const e=(0,b.getServerInterval)(this.properties().childs().interval.value());this._model.chartApi().createPointset(this._currentPointsetIdWithPrefix(),"turnaround",this._currentPointsetAndSymbolId.symbolId,e,t,this.onData.bind(this))}finish(){}realign(){this.calcIsActualSymbol(),this.isFixed()||this.isSourceHidden()||this._model.lineBeingCreated()===this||this._model.lineBeingEdited()===this||this._currentPointsetAndSymbolId?.symbolId===this._model.mainSeries().seriesSource().symbolInstanceId()||this._clearServerPoints(),null===this._model.mainSeries().symbolInfo()&&(this._alignerCache=null),this.updateAllViews((0,M.sourceChangeEvent)(this.id()))}stop(){this._clearServerPoints()}restart(){this.isFixed()||(this._currentPointsetAndSymbolId=null,this.createServerPoints())}isStarted(){return null!==this._currentPointsetAndSymbolId}convertYCoordinateToPriceForMoving(t,e){const i=(0,r.ensureNotNull)(this.priceScale());if(i.isEmpty())return null;const s=this.ownerSource(),n=(0,r.ensure)((s||e)?.firstValue());return i.coordinateToPrice(t,n)}syncMultichartState(t){const e={points:this._timePoint,pointPositionPercents:this.positionPercents(),interval:this._model.mainSeries().interval()},i=this.linkKey().value();if(null!==i&&this.isSynchronizable()){const s={model:this._model,linkKey:i,symbol:this._model.mainSeries().symbol(),finalState:e,changes:t};(0,V.finishChangingLineTool)(s)}}enableCurrentIntervalVisibility(){let t=this.properties().childs().intervalsVisibilities.state();void 0!==t&&(t=(0,A.mergeIntervalVisibilitiesDefaults)(t),(0,A.makeIntervalsVisibilitiesVisibleAtInterval)(t,this._model.mainSeries().intervalObj().value()),this.properties().childs().intervalsVisibilities.mergeAndFire(t))}clonePositionOffset(){return this.isFixed()?{barOffset:0,xCoordOffset:20,yCoordOffset:20}:{barOffset:0,xCoordOffset:0,yCoordOffset:-40}}sharingMode(){return this._sharingMode}
share(t){this.isSynchronizable()&&this._sharingMode.setValue(t)}syncLineStyleState(t){if(t)return{zOrder:this.zorder()};const{intervalsVisibilities:e,...i}=this.properties().state(this._syncStateExclusions);return{...i,intervalsVisibilities:(0,A.mergeIntervalVisibilitiesDefaults)(e),zOrder:this.zorder()}}moveLineTool(t){const e=this._model.mainSeries().interval();t.forEach(((t,i)=>this._setPoint(i,{...t,interval:e}))),this._normalizePoints()}targetSignature(){return this._targetSignature.readonly()}setTargetSignature(t){(0,r.assert)(this.supportsTargetSignature()),this._targetSignature.setValue(t)}supportsTargetSignature(){return!1}snapTo45DegreesAvailable(){return!1}alignTo45DegreesPoints(){if(this.snapTo45DegreesAvailable()){const[t,e]=this.points();if(t&&e)return[{...t,pointIndex:0},{...e,pointIndex:1}]}return null}snapPoint45Degree(t,e,i){const s=this._model.timeScale(),n=s.indexToCoordinate(e.index),o=s.indexToCoordinate(t.index)-n,a=(0,r.ensureNotNull)(this.priceScale()),l=e.price,d=t.price,u=(0,r.ensureNotNull)((0,r.ensureNotNull)(this.ownerSource()).firstValue()),h=a.priceToCoordinate(l,u),c=a.priceToCoordinate(d,u)-h,_=Math.round(Math.atan2(o,c)/Math.PI*4);if(2===Math.abs(_))i||(t.price=l);else if(0===Math.abs(_)||4===Math.abs(_))i||(t.index=e.index);else{const e=Math.sqrt(o*o+c*c),i=o<0?-1:1,r=c<0?-1:1;let l=Math.max(Math.abs(c),Math.abs(o));l/=l*Math.sqrt(2)/e;const d=Math.round(s.coordinateToIndex(n+l*i)),_=Math.abs(s.indexToCoordinate(d)-n),p=a.coordinateToPrice(h+_*r,u);t.index=d,t.price=p}}contextMenuStatName(){return"LineToolContextMenu"}_ignoreSourceEvent(t){return t.sourceId!==this.id()}_pointsForPointset(){return this._timePoint.map((({interval:t,time_t:e,offset:i})=>t?[e,i,(0,b.getServerInterval)(t)]:[e,i]))}_setPoint(t,e){this._points[t]&&(this._points[t].index===e.index?this._points[t].price=e.price:this._points[t]=e,this._pointChanged.fire(t))}_correctLastPoint(t){return(0,o.clone)(t)}_snapTo45DegreesApplicable(t){return this.snapTo45DegreesAvailable()&&(t?.shift()||(0,V.alignTo45Degrees)().value())}_normalizePoint(t,e){return{...this._model.timeScale().normalizeBarIndex(t.index),price:t.price,interval:t.interval}}_normalizePointWithoutOffset(t){const e=this._model.timeScale().indexToTimePoint(t.index)??this._utcTimeInCurrentResolution(t);return null===e?null:{price:t.price,time_t:e,offset:0,interval:t.interval}}_normalizePoints(){let t=[];const e=this._model.mainSeries().interval();for(let i=0;i<this._points.length;i++)if(T.Interval.isEqual(this._points[i].interval,e)){if(void 0!==this._points[i].index){const e=this._normalizePoint(this._points[i],i);if(!e.time_t){t=[];break}t.push(e)}}else t.push({...this._timePoint[i],price:this._points[i].price});this._timePoint=t,this._normalizedPointsChanged.fire()}_getStartBarAligner(){const t=this._model.mainSeries().interval();if(null===this._alignerCache||this._alignerCache.resolution!==this._model.mainSeries().interval()){const e=this._model.mainSeries().symbolInfo();if(!e)return null;this._alignerCache={resolution:t,aligner:(0,
u.createTimeToBarTimeAligner)(t,e)}}return this._alignerCache.aligner}_utcTimeInCurrentResolution(t){const e=this._model.timeScale().points(),i=e.firstPoint(),s=e.lastPoint(),n=this._model.mainSeries().syncModel();if(null===i||null===s||null===n)return null;const o=(0,r.ensureNotNull)(e.indexOf(i,!1)),a=(0,r.ensureNotNull)(e.indexOf(s,!1));if(t.index>=o&&t.index<=a)return null;const l=t.index<o?o:a,d=(0,r.ensureNotNull)(e.valueAt(l)),u=t.index-l;return(0,h.extrapolateBarsFrontByCount)(n.barBuilder(),1e3*d,u).time/1e3}_setPaneViews(t,e,i){if(this._isDestroyed)for(const e of t)e.destroy&&e.destroy();else this._paneViews.set(e,t),void 0!==e&&i&&e.onDestroyed().subscribe(this,(()=>this._destroyPanePaneViews(e))),this._model.lightUpdate()}_getPaneViews(t){if(!t||!this.supportsTargetSignature()||!this._targetSignature.value())return this._paneViews.get(t)??[];const e=this._targetSignature.value(),i=[];for(const s of t.studySources())s.signature().value()===e&&i.push(...this._signaturesPaneViews.get(s)??[]);return i}_updateAllPaneViews(t){this._paneViews.forEach((e=>{for(const i of e)i.update(t)}));for(const[,e]of this._signaturesPaneViews)for(const i of e)i.update(t)}_alignPointHorizontallyOrVertically(t){const e=(0,r.ensureNotNull)(this.pointToScreenPoint(t)),i=(0,r.ensureDefined)((0,r.ensureNotNull)(this._startMovingPoint).logical),s=(0,r.ensureDefined)((0,r.ensureNotNull)(this._startMovingPoint).screen),n=Math.abs(s.x-e.x),o=Math.abs(s.y-e.y);if(n<10&&o<10)return t;return{index:n<o?i.index:t.index,price:n<o?t.price:i.price}}_alignScreenPointHorizontallyOrVertically(t){const e=(0,r.ensureDefined)((0,r.ensureNotNull)(this._startMovingPoint).screen),i=Math.abs(e.x-t.x),s=Math.abs(e.y-t.y);return i<10&&s<10?t:i<s?new n.Point(e.x,t.y):new n.Point(t.x,e.y)}_correctPoints(t,e){const i=(0,r.ensure)(this._currentMovingPoint?.screen),s=(0,r.ensure)(this._startMovingPoint?.screen),n=i.subtract(s);if(n.length()<1&&!e)return!1;const o=Math.round((0,r.ensure)(this._currentMovingPoint?.logical).index-(0,r.ensure)(this._startMovingPoint?.logical).index);for(const e of t){const t=(0,r.ensureNotNull)(this.pointToScreenPoint(e)).add(n);e.index=e.index+o,e.price=(0,r.ensureNotNull)(this.screenPointToPoint(t)).price}return!0}_correctFixedPoint(t){if(void 0===this._fixedPoint)return{didCorrect:!1,point:t};const e=(0,r.ensureDefined)((0,r.ensureNotNull)(this._currentMovingPoint).screen),i=(0,r.ensureDefined)((0,r.ensureNotNull)(this._startMovingPoint).screen),s=e.subtract(i);return s.length()>=1?{didCorrect:!0,point:t.add(s)}:{didCorrect:!1,point:t}}_currentPointsetIdWithPrefix(){return"pointset_"+(0,r.ensureNotNull)(this._currentPointsetAndSymbolId).pointsetId}_clearServerPoints(){null!==this._currentPointsetAndSymbolId&&this._model.chartApi().isConnected().value()&&this._model.chartApi().removePointset(this._currentPointsetIdWithPrefix()),this._currentPointsetAndSymbolId=null}_createPointProperty(t){const e=this._pointsProperty.childs().points;e.addChild(""+t,new x.Property({}));const i=e[t];i.addChild("price",new N(this,t)),
i.addChild("bar",new k.LineDataSourcePointIndexProperty(this,t))}_createPointsProperties(){this._pointsProperty=new x.Property,this._pointsProperty.addChild("points",new x.Property);for(let t=0;t<this.pointsCount();t++)this._createPointProperty(t)}_alignPointToRangeOfActualData(t){const e=(0,r.ensureNotNull)(this._model.mainSeries().bars().firstIndex()),i=(0,r.ensureNotNull)(this._model.mainSeries().bars().lastIndex());let s=Math.max(t.index,e);return s=Math.min(s,i),{...t,index:s}}_migrateSymbolProperty(t){const e=this._properties.childs();if(e.symbolStateVersion.value()<2){const i=(0,r.ensureNotNull)(this.ownerSource()),s=(0,r.ensureNotNull)(i.symbolSource()),n=this._model.mainSeries();if(s===n)return void e.symbolStateVersion.setValueSilently(2);if(null===n.symbolInfo())return;if(null===s.symbolInfo())return;n.symbolSameAsCurrent(e.symbol.value())&&e.symbol.setValueSilently((0,w.extractLineToolSymbolFromSymbolInfo)(t,s.symbol())),e.symbolStateVersion.setValueSilently(2)}}_migrateZOrder(){const t=this._properties.childs();t.zOrderVersion.value()<2&&(this.ownerSource()===this.model().mainSeries()&&this.setZorder(this.zorder()-this.model().mainSeries().obsoleteZOrder()),t.zOrderVersion.setValueSilently(2))}_preparePoint(t,e){const i=t;return this._snapTo45DegreesApplicable(e)&&this.points().length>=2&&this.snapPoint45Degree(i,this.points()[this.points().length-2]),i}_addPointIntenal(t,e,i){this._points.push({...t,interval:this._model.mainSeries().interval()});const s=this._points.length===this.pointsCount();return s?(this._lastPoint=null,i||(this._normalizePoints(),this.createServerPoints())):this._lastPoint=t,this._pointAdded.fire(this._points.length-1),s}_onSourceHiddenMayChange(){this.isSourceHidden()&&this._model.selectionMacro((t=>{t.removeSourceFromSelection(this)})),this._model.invalidate(P.InvalidationMask.validateAction((()=>{this!==this._model.lineBeingCreated()&&(this._isDestroyed||this.processHibernate())})))}_saveAlertIdInState(){return!0}_onPointsetUpdated(t){if(0===t.length)return;const e=this.properties().childs().interval.value();for(const{index:i,value:s}of t){const{price:t,interval:n=e}=(0,r.ensureDefined)(this._timePoint[i]),[o,a]=s,l={index:o,time:a,price:t,interval:n};if(this._points.length<=i){const t=this._points.push(l);this._pointAdded.fire(t-1)}else this._points[i]=l,this._pointChanged.fire(i)}{const t=this;t.recalculateStateByData&&t.recalculateStateByData()}this._onPointsetUpdatedDelegate.fire(),this.updateAllViewsAndRedraw((0,M.sourceChangeEvent)(this.id()))}_onMainSeriesSymbolResolved(){const t=this.ownerSource();null===t||this._model.mainSeries()===t.symbolSource()||this.isSourceHidden()||this.createServerPoints()}_readyToCreatePointset(){return this._timePoint.length>0}_propertiesStateExclusions(){return[]}_syncLineStyleIfNeeded(t){const e=this.linkKey().value();e&&!this._syncLineStyleMuted&&this._syncLineStyleChanges(e,this.syncLineStyleState(t))}_muteSyncLineStyle(){this._syncLineStyleMuted=!0}_unmuteSyncLineStyleWithoutApplyingChanges(){this.propertiesChanged(),
this._syncLineStyleMuted=!1}_applyTemplateImpl(t){t.intervalsVisibilities=(0,A.mergeIntervalVisibilitiesDefaults)(t.intervalsVisibilities);const e=this.properties();e.applyTemplate(t,(0,B.factoryDefaults)(this.toolname.toLowerCase())),e.saveDefaults(),this.propertiesChanged()}_getPropertyDefinitionsViewModelClass(){return Promise.resolve(null)}_getAlertPlots(){return[]}_getUndoHistory(){return this._model.undoModel().undoHistory()}async _synchronizeAlert(t){const e=this._getUndoHistory();if(!this._undoCheckpointAlert&&!this._alertUndoMode){const t=e.undoStack().pop();this._undoCheckpointAlert=e.createUndoCheckpoint(),t&&e.undoStack().push(t)}const i=async t=>{const e=t.description()!==t.defaultDescription(),i=await this._model.mainSeries().stateForAlertAsync();if(this._isDestroyed)return;const s=(0,r.ensureNotNull)(await this.stateForAlertAsync());this._isDestroyed||(t.startEditing(),t.setSymbol(i.symbolString),t.setResolution(s.interval),t.setLineState(s),e||t.resetToDefaultDescription(),t.finishEditing(),this._localAndServerAlertsMismatch=!0)},s=()=>{this._alertUndoMode=!0,e.undoToCheckpoint((0,r.ensureDefined)(this._undoCheckpointAlert)),setTimeout((()=>{this._alertUndoMode=!1,this._localAndServerAlertsMismatch=!1}),0)},n=t=>{t instanceof Error&&"not_exists"===t.message||(W.logError("Getting alert failed: "+t),s())},o=t=>{void 0!==this._alertRestartDebounceTimeoutId&&clearTimeout(this._alertRestartDebounceTimeoutId),this._alertRestartDebounceTimeoutId=setTimeout((async()=>{const e=await(0,y.getChartAlertsFacade)();this._isDestroyed||(e.restartAlert(t,{success:()=>this._localAndServerAlertsMismatch=!1,error:t=>n(new Error(t)),complete:()=>delete this._undoCheckpointAlert,actionSource:"drawing_sync"}),delete this._alertRestartDebounceTimeoutId)}),500)};if((0,S.canPlaceAlertOnResolution)(this._model.mainSeries().interval()))try{const e=await this.getAlert();if(!e)return void W.logError("Failed to get alert, drawing and alert are not synchronized");if(this._isDestroyed)return;if(await i(e),this._isDestroyed)return;t&&o(e)}catch(t){n(t)}else{if(this._isDestroyed)return;this._alertUndoMode||((0,g.showGoProAlertsOnSecondsDialog)(),s(),delete this._undoCheckpointAlert)}}_linePointsToAlertPlot(t,e,i,s){if(2!==t.length)return W.logError("[Drawing Alert] Wrong points"),null;const n=this._model.timeScale();return!n||n.isEmpty()?null:{type:"LinePlot",title:e||this.translatedType(),timestamp:(0,r.ensureNotNull)(n.indexToTimePoint(0)),offset1:t[0].index,offset2:t[1].index,price1:t[0].price,price2:t[1].price,extendBackward:i||!1,extendForward:s||!1}}_getAlertCreationAvailable(){return m.alertsAvailable&&super._getAlertCreationAvailable()&&!this._areAlertsOnLineToolProhibited()&&!this._hasAlert.value()}_onAnchoredChange(){if(this.isFixed()){const t=(0,r.ensureNotNull)(this.pointToScreenPoint(this.points()[0]));this.addFixedPoint(t)}else{if(!this._fixedPoint)return;const t=(0,r.ensureNotNull)(this.screenPointToPoint(this._fixedPoint));this._points[0]={...t,interval:this._model.mainSeries().interval()},this.startChanging(),
this.setPoint(0,t),this.endChanging(!1,!1),this._timePoint[0]=this._normalizePoint(this._points[0],0),this.clearFixedPoint()}const t=this.linkKey().value();null!==t&&this.isSynchronizable()&&(0,V.restoreLineToolState)({model:this._model,linkKey:t,state:this.state()})}_syncLineStyleChanges(t,e,i){this.anchorable()&&this.isFixed()!==Boolean(this._positionPercents)&&this._onAnchoredChange(),(0,V.changeLineStyle)({linkKey:t,state:e,alertId:i,model:this._model})}_updateAdjustedToSplitTimeValue(t){const e=this._properties.childs().adjustedToSplitTime,i=window.ChartApiInstance.serverTime()/1e3;t?e.setValueSilently(i):e.setValue(i)}_createSignatureSourcePaneViews(t){return[]}_updateSignaturesPaneViews(){const t=this.targetSignature().value();if(null!==t||0!==this._signaturesPaneViews.size){for(const[e,i]of this._signaturesPaneViews)e.signature().value()!==t&&(i.forEach((t=>t.destroy?.())),this._signaturesPaneViews.delete(e));for(const e of this._model.studiesWV(!0).value())e.signature().value()!==t||this._signaturesPaneViews.has(e)||this._signaturesPaneViews.set(e,this._createSignatureSourcePaneViews(e))}}static _configureProperties(t){if(this._addCollectedProperties(t),t.hasChild("symbolStateVersion")||t.addProperty("symbolStateVersion",1),t.hasChild("zOrderVersion")||t.addProperty("zOrderVersion",1),t.hasChild("visible")||t.addProperty("visible",!0),t.hasChild("frozen")||t.addProperty("frozen",!1),t.hasChild("symbol")||t.addProperty("symbol",""),t.hasChild("currencyId")||t.addProperty("currencyId",null),t.hasChild("unitId")||t.addProperty("unitId",null),t.hasChild("adjustedToSplitTime")||t.addProperty("adjustedToSplitTime",null),t.hasChild("intervalsVisibilities")){const e=(0,o.merge)((0,o.clone)(C.intervalsVisibilitiesDefaults),t.childs().intervalsVisibilities.state());t.removeProperty("intervalsVisibilities"),t.addChild("intervalsVisibilities",new L.IntervalsVisibilitiesProperty(e))}else t.addChild("intervalsVisibilities",new L.IntervalsVisibilitiesProperty(C.intervalsVisibilitiesDefaults));t.hasChild("title")||t.addProperty("title",""),["symbolStateVersion","zOrderVersion","visible","frozen","symbol","currencyId","unitId","symbolInfo","points","interval","title"].forEach((e=>t.addExcludedKey(e,5))),t.hasChild("singleChartOnly")&&t.removeProperty("singleChartOnly"),t.hasChild("font")&&t.removeProperty("font")}static _addCollectedProperties(t){t.hasChild("linewidth")&&t.addChild("linesWidths",new O.LineToolWidthsProperty([(0,r.ensureDefined)(t.child("linewidth"))])),t.hasChild("linecolor")&&t.addChild("linesColors",new O.LineToolColorsProperty([(0,r.ensureDefined)(t.child("linecolor"))])),t.hasChild("backgroundColor")&&t.addChild("backgroundsColors",new O.LineToolColorsProperty([(0,r.ensureDefined)(t.child("backgroundColor"))])),t.hasChild("textColor")&&t.addChild("textsColors",new O.LineToolColorsProperty([(0,r.ensureDefined)(t.child("textColor"))])),t.hasChild("linestyle")&&t.addChild("linesStyles",new O.LineToolCollectedProperty([(0,r.ensureDefined)(t.child("linestyle"))])),
["linesWidths","linesColors","backgroundsColors","textsColors","linesStyles"].forEach((e=>{t.addExcludedKey(e,7)}))}_areAlertsOnLineToolProhibited(){return null!==this._ownerSource&&!this._ownerSource.canHasAlertOnLineTools()}_removeAlertSubscriptions(){this._unsubscribeAlertCallbacks?.(),this._unsubscribeAlertCallbacks=void 0}_addAlertSubscriptions(t,e={}){if(void 0!==this._unsubscribeAlertCallbacks)return;const i=this.properties().child("extendLeft"),s=this.properties().child("extendRight"),n=t.destroyed().spawn(),r=t.active().spawn();r.subscribe((t=>this._alertStatus.setValue(t?2:3)),{callWithLast:!0}),n.subscribe(this.removeAlert.bind(this)),void 0!==i&&i.subscribe(this,(()=>this.synchronizeAlert(!1))),void 0!==s&&s.subscribe(this,(()=>this.synchronizeAlert(!1))),this._unsubscribeAlertCallbacks=()=>{n.destroy(),r.destroy(),void 0!==i&&i.unsubscribeAll(this),void 0!==s&&s.unsubscribeAll(this)}}_destroyPanePaneViews(t){const e=this._paneViews.get(t);if(void 0!==e)for(const t of e)t.destroy&&t.destroy();void 0!==t&&t.onDestroyed().unsubscribeAll(this),this._paneViews.delete(t)}_copyPricesWithoutNormalization(){const t=Math.min(this._points.length,this._timePoint.length);for(let e=0;e<t;e++)this._timePoint[e].price=this._points[e].price}async _getChartAlert(){const t=await(0,y.getChartAlertsFacade)();return new Promise(((e,i)=>{t.getAlert((0,r.ensureDefined)(this._alertId),{success:e,error:i})}))}async _syncAlertWithAlertFacade(t={}){try{const e=await this.getAlert();if(!e)return;this._addAlertSubscriptions(e,t)}catch(t){if(t instanceof Error&&"not_exists"===t.message&&this.hasAlert().value()){this._alertStatus.setValue(0);return void(await(0,y.getChartAlertsFacade)()).removeAlertFromAllChartsSilently(this.id(),(0,r.ensureDefined)(this._alertId))}W.logError("Failed to set alert, alert will not be saved with drawing in chart")}}async _awaitForPointset(){const t={};try{await Promise.race([new Promise(((t,e)=>{setTimeout((()=>e(new Error("Timeout"))),3e3)})),new Promise((e=>{this.pointsetUpdated().subscribe(t,(()=>e()))}))])}catch(t){throw t}finally{this.pointsetUpdated().unsubscribeAll(t)}}}},772062:(t,e,i)=>{i.d(e,{lineToolsLocalizedNames:()=>n});var s=i(444372);const n={LineTool5PointsPattern:s.t(null,void 0,i(942231)),LineToolABCD:s.t(null,void 0,i(246712)),LineToolArc:s.t(null,void 0,i(659324)),LineToolArrow:s.t(null,void 0,i(511858)),LineToolArrowMarkDown:s.t(null,void 0,i(673193)),LineToolArrowMarkLeft:s.t(null,void 0,i(401949)),LineToolArrowMarkRight:s.t(null,void 0,i(886275)),LineToolArrowMarkUp:s.t(null,void 0,i(162453)),LineToolBalloon:s.t(null,void 0,i(770540)),LineToolComment:s.t(null,void 0,i(309818)),LineToolBarsPattern:s.t(null,void 0,i(381994)),LineToolBezierCubic:s.t(null,void 0,i(77125)),LineToolBezierQuadro:s.t(null,void 0,i(678609)),LineToolBrush:s.t(null,void 0,i(243539)),LineToolCallout:s.t(null,void 0,i(925381)),LineToolCircleLines:s.t(null,void 0,i(584031)),LineToolCypherPattern:s.t(null,void 0,i(193191)),LineToolDateAndPriceRange:s.t(null,void 0,i(247017)),
LineToolDateRange:s.t(null,void 0,i(485444)),LineToolDisjointAngle:s.t(null,void 0,i(91544)),LineToolElliottCorrection:s.t(null,void 0,i(980943)),LineToolElliottDoubleCombo:s.t(null,void 0,i(75112)),LineToolElliottImpulse:s.t(null,void 0,i(861114)),LineToolElliottTriangle:s.t(null,void 0,i(872359)),LineToolElliottTripleCombo:s.t(null,void 0,i(76129)),LineToolEllipse:s.t(null,void 0,i(978996)),LineToolExtended:s.t(null,void 0,i(452788)),LineToolFibChannel:s.t(null,void 0,i(659005)),LineToolFibCircles:s.t(null,void 0,i(182330)),LineToolFibRetracement:s.t(null,void 0,i(855986)),LineToolFibSpeedResistanceArcs:s.t(null,void 0,i(633880)),LineToolFibSpeedResistanceFan:s.t(null,void 0,i(202395)),LineToolFibSpiral:s.t(null,void 0,i(239014)),LineToolFibTimeZone:s.t(null,void 0,i(930622)),LineToolFibWedge:s.t(null,void 0,i(485042)),LineToolFlagMark:s.t(null,void 0,i(514600)),LineToolImage:s.t(null,void 0,i(868065)),LineToolFlatBottom:s.t(null,void 0,i(745051)),LineToolAnchoredVWAP:s.t(null,void 0,i(584541)),LineToolGannComplex:s.t(null,void 0,i(844763)),LineToolGannFixed:s.t(null,void 0,i(960707)),LineToolGannFan:s.t(null,void 0,i(748683)),LineToolGannSquare:s.t(null,void 0,i(947460)),LineToolHeadAndShoulders:s.t(null,void 0,i(921928)),LineToolHorzLine:s.t(null,void 0,i(121795)),LineToolHorzRay:s.t(null,void 0,i(325487)),LineToolIcon:s.t(null,void 0,i(37913)),LineToolEmoji:s.t(null,void 0,i(273456)),LineToolSticker:s.t(null,void 0,i(443114)),LineToolInsidePitchfork:s.t(null,void 0,i(141686)),LineToolNote:s.t(null,void 0,i(986631)),LineToolTextNote:s.t(null,void 0,i(794389)),LineToolSignpost:s.t(null,void 0,i(467751)),LineToolParallelChannel:s.t(null,void 0,i(559256)),LineToolPitchfan:s.t(null,void 0,i(234156)),LineToolPitchfork:s.t(null,void 0,i(919634)),LineToolPolyline:s.t(null,void 0,i(401185)),LineToolPath:s.t(null,void 0,i(800371)),LineToolPrediction:s.t(null,void 0,i(920138)),LineToolPriceLabel:s.t(null,void 0,i(91282)),LineToolArrowMarker:s.t(null,void 0,i(936352)),LineToolPriceRange:s.t(null,void 0,i(768941)),LineToolProjection:s.t(null,void 0,i(375747)),LineToolRay:s.t(null,void 0,i(550318)),LineToolRectangle:s.t(null,void 0,i(426001)),LineToolCircle:s.t(null,void 0,i(191944)),LineToolRegressionTrend:s.t(null,void 0,i(802460)),LineToolRiskRewardLong:s.t(null,void 0,i(674832)),LineToolRiskRewardShort:s.t(null,void 0,i(508075)),LineToolFixedRangeVolumeProfile:s.t(null,{context:"study"},i(925705)),LineToolAnchoredVolumeProfile:s.t(null,{context:"study"},i(689633)),LineToolRotatedRectangle:s.t(null,void 0,i(56820)),LineToolSchiffPitchfork:s.t(null,void 0,i(657681)),LineToolSchiffPitchfork2:s.t(null,void 0,i(942608)),LineToolSineLine:s.t(null,void 0,i(839090)),LineToolText:s.t(null,{context:"tool"},i(691405)),LineToolTextAbsolute:s.t(null,void 0,i(642669)),LineToolThreeDrivers:s.t(null,void 0,i(46982)),LineToolTimeCycles:s.t(null,void 0,i(746852)),LineToolTrendAngle:s.t(null,void 0,i(35757)),LineToolTrendBasedFibExtension:s.t(null,void 0,i(680583)),LineToolTrendBasedFibTime:s.t(null,void 0,i(272159)),
LineToolTrendLine:s.t(null,void 0,i(197339)),LineToolInfoLine:s.t(null,void 0,i(715992)),LineToolTriangle:s.t(null,void 0,i(901671)),LineToolTrianglePattern:s.t(null,void 0,i(390148)),LineToolVertLine:s.t(null,void 0,i(529535)),LineToolCrossLine:s.t(null,void 0,i(974334)),LineToolHighlighter:s.t(null,void 0,i(969476)),LineToolPriceNote:s.t(null,void 0,i(297512)),LineToolVbPFixed:s.t(null,void 0,i(840693)),LineToolGhostFeed:s.t(null,void 0,i(546808)),LineToolTable:s.t(null,void 0,i(17981))};n.LineToolTweet=s.t(null,void 0,i(636549)),n.LineToolIdea=s.t(null,void 0,i(215982)),n.LineToolNoteAbsolute=s.t(null,void 0,i(363209))},774440:(t,e,i)=>{i.d(e,{StudyLineDataSource:()=>P,isStudyLineTool:()=>f});var s=i(132565),n=i(318945),r=i(890390),o=i(807958),a=i(196302),l=i(479483),d=i(590178),u=i(808825),h=i(587482),c=i(37241),_=i(437642),p=i(454184),y=i(232915);class S extends y.StatusProviderBase{constructor(t){super(),this._source=t}errorStatus(){const t=this._source.status();return t.type===p.StudyStatusType.Error?{error:this.sourceStatusText(),solutionId:(0,p.studyStatusSolutionId)(t),title:(0,p.studyStatusTitle)(t),studyFeature:(0,p.studyStatusFeature)(t)}:null}getSplitTitle(){return this._source.titleInParts()}getInputsTitles(){return null}text(){return this._source.translatedType()}sourceStatusText(){return(0,p.convertStudyStatusToString)(this._source.status(),!0)}}var g=i(239949),m=i(236578);class v extends m.StatusView{constructor(t){super(t.statusProvider({}))}getSplitTitle(){return this._statusProvider.getSplitTitle()}}function f(t){return t instanceof P}class P extends n.LineDataSource{constructor(t,e,s,n,r,o){super(t,n,r,o),this._indexes=null,this._inputs=null,this._definitionsViewModel=null,this._pointsetPoints=null,this._loadedPlots=null,this._loadedGraphics=null,this._beingCreatedPaneView=null,this._anchorsPaneView=null,this._isLegendDisplayed=!1,Promise.all([Promise.all([i.e(20700),i.e(63317),i.e(4171),i.e(26772),i.e(62622),i.e(22762),i.e(5262),i.e(51583)]).then(i.bind(i,473410)),Promise.all([i.e(20700),i.e(63317),i.e(4171),i.e(26772),i.e(62622),i.e(22762),i.e(5262),i.e(51583)]).then(i.bind(i,768260))]).then((e=>{const{LineToolBeingCreatedPaneView:i}=e[0],{StudyLineDataSourceAnchorsPaneView:s}=e[1];this._beingCreatedPaneView=new i(this,t),this._anchorsPaneView=new s(this,this.model()),this._model.lightUpdate()})),this._metaInfo=e,this._dataSource=new d.ExtendedStudyDataSource(t.chartApi(),t.mainSeries(),s,e),this._dataSource.dataCleared().subscribe(this,this._onDataCleared),this._dataSource.dataUpdated().subscribe(this,this._onDataUpdated),this._dataSource.studyStatusChanged().subscribe(this,this._onStudyStatusChanged),this._statusProvider=new S(this),this._statusView=new v(this),this._showStudyArgumentsProperty=t.properties().childs().paneProperties.childs().legendProperties.childs().showStudyArguments}isDisplayedInLegend(){return this._isLegendDisplayed}titleInParts(){const t=[];if(this._showStudyArgumentsProperty.value()&&this._inputs)for(const e of this._metaInfo.inputs){
if(!0===e.isHidden||"bool"===e.type)continue;const i=this._inputs[e.id];t.push(i.toString())}return[this.name(),t]}destroy(){this._dataSource.dataUpdated().unsubscribeAll(this),this._dataSource.dataCleared().unsubscribeAll(this),this._dataSource.studyStatusChanged().unsubscribeAll(this),this._dataSource.destroy(),null!==this._definitionsViewModel&&(this._definitionsViewModel.destroy(),this._definitionsViewModel=null),this._unsubscribeApplyInputsOnSeriesCompleted(),this._isDestroyed=!0,super.destroy()}stop(){super.stop(),this._stopDataSource()}start(){super.start(),this._startDataSource()}metaInfo(){return this._metaInfo}graphicsInfo(){return this._metaInfo.graphics}series(){return this._model.mainSeries()}translatedType(){return this._metaInfo.description}name(){return this._metaInfo.description}studyId(){return this._metaInfo.id}setPoint(t,e,i){super.setPoint(t,this._preparePoint(e,i))}move(t){}clearData(){this._pointsetPoints=null,this._clearAllDataExceptPointsetPoints(),this._onStudyInputsMayChange(),this.updateAllViews((0,_.sourceChangeEvent)({sourceId:this.id(),clearData:!0})),super.clearData()}data(){return this.plots()}plots(){return this._loadedPlots||this._dataSource.plots()}graphics(){return this._loadedGraphics||this._dataSource.graphics()}valueAt(t,e){return this.ownerSource()?.symbolSource().valueAt(t,e)??null}firstValue(){return this._model.mainSeries().firstValue()}state(t){const e={...super.state(t),metaInfo:this.metaInfo().state()};return t&&(e.data=this.plots().state(),e.nonseriesindexes=this._indexes,e.graphics=(0,a.saveStudyGraphics)(this.graphics(),null)),e}restoreData(t){void 0!==t.data&&(this._loadedPlots=new s.PlotList((0,h.studyPlotFunctionMap)(this._metaInfo),h.studyEmptyPlotValuePredicate),this._loadedPlots.restoreState(t.data)),this._indexes=t.nonseriesindexes??this._indexes,this._loadedGraphics=t.graphics?(0,a.loadStudyGraphics)(t.graphics):this._loadedGraphics}getPropertyDefinitionsViewModel(){return null===this._definitionsViewModel?this._getPropertyDefinitionsViewModelClass().then((t=>null===t||this._isDestroyed?null:(null===this._definitionsViewModel&&(this._definitionsViewModel=new t(this._model.undoModel(),this)),this._definitionsViewModel))):Promise.resolve(this._definitionsViewModel)}paneViews(t){let e=[];if(this.isSourceHidden())return e;if(this._isReady()&&this._changeStatesStack.isEmpty()){const i=super.paneViews(t);null!==i&&(e=e.concat(i))}else null!==this._beingCreatedPaneView&&e.push(this._beingCreatedPaneView);return null!==this._anchorsPaneView&&e.push(this._anchorsPaneView),e}propertiesChanged(t){super.propertiesChanged(t),this._onStudyInputsMayChange()}dataAndViewsReady(){return super.dataAndViewsReady()&&this._isReady()}endChanging(t,e){const i=super.endChanging(t,e);return i.indexesChanged?this.clearData():this._updateAnchorsPrice(!0),i}moveData(t){this._dataSource.moveData(t)}restorePoints(t,e,i){super.restorePoints(t,e,i),this._updateAnchorsPrice(!0)}statusProvider(t){return this._statusProvider}alertSourceModel(){return null}statusView(){return this._statusView}
legendView(){return null}dataProblemModel(){return null}dataUpdatedModeModel(){return null}marketStatusModel(){return null}onStatusChanged(){return this._dataSource.studyStatusChanged()}status(){return this._dataSource.studyStatus()}recalcStudyIfNeeded(){}stateForAlert(){return null}static createPropertiesFromStudyMetaInfoAndState(t,e,i,s,n){const r=(0,c.prepareStudyPropertiesForLoadChart)(t,e,i,s,void 0,n);return this._configureProperties(r),r}_getPointsetPoints(){return this._pointsetPoints}_onStudyStatusChanged(t,e){let i;switch(e.type){case u.StudyStatusType.Error:i=!0;break;case u.StudyStatusType.Completed:i=!1;break;default:return}if(i===this._isLegendDisplayed)return;this._isLegendDisplayed=i;const s=this._model.paneForSource(this);if(s){const t=this._model.panes().indexOf(s),e=g.InvalidationMask.invalidateLegendWidgetLayout(t);this.model().invalidate(e)}}_studyId(){return this._dataSource.studyId()}_isReady(){return!0}_updateAllPaneViews(t){super._updateAllPaneViews(t),this._beingCreatedPaneView?.update(),this._anchorsPaneView?.update(t)}_getPointTime(t,e){const i=t.index,s=this._model.timeScale().indexToTimePoint(i);return null!==s?s:e||void 0===t.time?null:this._utcTimeInCurrentResolution(t)}_updateAnchorsPrice(t){}_onPointsetUpdated(t){super._onPointsetUpdated(t),this._pointsetPoints=this._points.map((t=>({price:t.price,index:t.index,time:t.time}))),this._onStudyInputsMayChange()}_onDataCleared(){this.updateAllViews((0,_.sourceChangeEvent)({sourceId:this.id(),clearData:!0})),this._model.updateSource(this)}_onDataUpdated(t,e,i){this._updateAnchorsPrice(),this.updateAllViews((0,_.sourceChangeEvent)({sourceId:this.id(),firstUpdatedTimePointIndex:t[0]?.index})),this._model.updateSource(this)}_onStudyInputsMayChange(){let t=null;const e=this._pointsetPoints;if(e?.length===this.pointsCount()){if(t=this._studyInputs(e),t){const e=this.metaInfo().inputs.map((t=>t.id));for(const i of Object.keys(t))e.includes(i)||delete t[i]}}else this._isDataSourceStarted()&&this._stopDataSource(!1);t?this._unsubscribeApplyInputsOnSeriesCompleted():this._subscribeApplyInputsOnSeriesCompleted(),this._areInputsEqual(this._inputs,t)||(this._applyStudyInputs(t),t?this._isDataSourceStarted()||this._startDataSource():(this._clearAllDataExceptPointsetPoints(),this.updateAllViews((0,_.sourceChangeEvent)(this.id()))))}_preparePoint(t,e){return super._preparePoint(this._alignPointToRangeOfActualData(t),e)}_getPropertyDefinitionsViewModelClass(){return Promise.resolve(null)}_subscribeApplyInputsOnSeriesCompleted(){this._unsubscribeApplyInputsOnSeriesCompleted(),this._model.mainSeries().dataEvents().completed().subscribe(this,(()=>this._onStudyInputsMayChange()),!0)}_unsubscribeApplyInputsOnSeriesCompleted(){this._model.mainSeries().dataEvents().completed().unsubscribeAll(this)}_onInputsChanged(){this.hasAlert().value()&&(this._localAndServerAlertsMismatch=!0)}_clearAllDataExceptPointsetPoints(){this._loadedPlots=null,this._indexes=null,this._loadedGraphics=null,this._dataSource.clearData()}_stopDataSource(t=!0){
this._isDestroyed||(this._dataSource.stop(),t&&this.clearData())}_startDataSource(){this._isDestroyed||null===this._inputs||this._dataSource.start()}_isDataSourceStarted(){return this._dataSource.isStarted()}static _createPropertiesFromStudyIdAndState(t,e){const i=o.StudyMetaInfo.getStudyPropertyRootNameById(t),s=new r.DefaultProperty({defaultName:i,state:e});return this._configureProperties(s),s}static _configureProperties(t){super._configureProperties(t),t.removeExcludedKey("intervalsVisibilities",1),t.removeProperty("showLegendValues"),t.removeProperty("showLegendInputs")}_areInputsEqual(t,e){return null===e?null===t:null!==t&&(0,l.areStudyInputsEqual)(this._metaInfo.inputs,t,e)}_applyStudyInputs(t){this._inputs=t,null!==t&&this._dataSource.setInputs(t),this._onInputsChanged()}}},37241:(t,e,i)=>{i.d(e,{prepareStudyProperties:()=>b,prepareStudyPropertiesForLoadChart:()=>S});var s=i(998034),n=i(130551),r=i(735566),o=i(536794),a=i(807958),l=i(257145),d=i(85858),u=i(192809),h=i(266954),c=i(890390),_=i(744380),p=i(974145);const y=(0,r.getLogger)("Chart.Study");function S(t,e,i,n,r,l){return function(t,e,i,n,r,l,u){const h=function(t,e,i,n,r){t.version&&i.version&&t.version!==i.version&&y.logWarn("Serialized metaInfo version "+t.version+" is not equal to the saved state version "+i.version);const l=e||t,u=(0,o.clone)(l.defaults)??{},h=a.StudyMetaInfo.getStudyPropertyRootName(l),c=a.StudyMetaInfo.getStudyPropertyRootName(t);let _=m();(0,s.default)(_,g(t)),(0,s.default)(_,(0,o.clone)(t.defaults)),(0,s.default)(_,u),(0,s.default)(_,(0,d.factoryDefaults)(h)),(0,s.default)(_,(0,d.factoryDefaults)(c)),(0,s.default)(_,v(l,n,h)),(0,s.default)(_,v(t,n,c)),(0,s.default)(_,i),_=n.updateStudyState(_,t,e),void 0!==r&&e&&(_=r(i,_,t,e));a.StudyMetaInfo.versionOf(l)>=1&&(0,s.default)(_,f(u,_));return _}(t,e,i,n,l);return C(e||t,r,h,u,!0)}(t,e,i,n,a.StudyMetaInfo.getStudyPropertyRootName(t),r,l)}function g(t){const e={};if(t.plots)for(let i=0;i<t.plots.length;i++){const s=t.plots[i],n=s.id;if((0,p.isColorerPlot)(s))continue;const r={display:15,color:"#0496FF",linestyle:l.LINESTYLE_SOLID,linewidth:2,plottype:p.LineStudyPlotStyle.Line,trackPrice:!1};(0,p.isBarColorerPlot)(s)&&(r.transparency=0),r.plottype=s.type,r.title=n,e[n]=r}return{styles:e}}function m(){const t=(0,o.clone)((0,d.defaults)("study"));return t.intervalsVisibilities=(0,o.clone)(h.intervalsVisibilitiesDefaults),t}function v(t,e,i){let s=(0,o.clone)((0,d.defaults)(i,e));return"Overlay"!==t.shortId&&"Compare"!==t.shortId||(s.currencyId=null,s.unitId=null),t.isTVScript&&t.TVScriptSourceCode!==s.TVScriptSourceCode&&(s=(0,o.clone)((0,d.factoryDefaults)(i))),s}function f(t,e){const i={};return u.StudyVersioning.mergeInputsObjPart(i,t.inputs??{}),u.StudyVersioning.mergeInputsObjPart(i,e.inputs),{inputs:i}}function P(t,e,i,r){if(a.StudyMetaInfo.versionOf(t)<1)throw new Error("This function cannot work with metainfo of the old format version. Required format version >= 1");const l=a.StudyMetaInfo.getStudyPropertyRootName(t),u=(0,o.clone)(t.defaults),h=(0,d.factoryDefaults)(l),c=m()
;if((0,s.default)(c,g(t)),(0,s.default)(c,u),(0,s.default)(c,h),(0,s.default)(c,v(t,r,l)),(0,s.default)(c,e),(0,s.default)(c,f(u,c)),null!==i){const e=i.model().studiesColorRotatorFactory().getColorRotator(t);null!==e&&("Overlay@tv-basicstudies"===t.id?c.lineStyle.color=e.getColor(c.lineStyle.color,h.lineStyle.color===c.lineStyle.color):(0,s.default)(c,function(t,e){for(const i of Object.keys(t.styles)){const s=t.styles[i];if((0,n.isObject)(s)&&"color"in s){const t=s.color;s.color=e.getColor(t)}}return t}(c,e)))}return r.updateStudyInputsIfNeeded(c,c.version??t.version,t),c}function b(t,e,i,s,n){return function(t,e,i,s,n,r){const l=P(t,e,i,s),d=a.StudyMetaInfo.getSourceInputIds(t);return d.forEach(((t,e)=>{const i=l.inputs[t];e<r.length?l.inputs[t]=`${r[e].id()}$0`:(0,o.isString)(i)&&i.includes("$")&&(l.inputs[t]="close")})),C(t,n,l)}(t,e,i,s,a.StudyMetaInfo.getStudyPropertyRootName(t),n)}const A=["id","description","description_localized","shortDescription","_metainfoVersion","is_price_study","is_hidden_study","priceScale","fullId","shortId","scriptIdPart","packageId","productId","isTVScriptStub","defaults","symbolSource","historyCalculationMayChange","format","linkedToSeries","isTVLibrary","docs","exports","exportTypes","extra","usesPrivateLib","financialPeriod","groupingKey","pine","isRGB","isTVScript","TVScriptMetaInfoExprs","usePlotsZOrder","isTVScriptStrategy","TVScriptSourceCode","lookaheadFutureData","hasAlertFunction","defaultStrategyAlertMessage","tags","canBeChild","canNotBeChild","_serverMetaInfoVersion","warnings"];function C(t,e,i,s,n){for(const t of A)delete i[t];const r=["visible","precision","minTick","intervalsVisibilities","inputs.first_visible_bar_time","inputs.last_visible_bar_time","inputs.subscribeRealtime","patchMetaInfoDefaults"];for(let e=0;e<t.inputs.length;++e){const i=t.inputs[e];i.isHidden&&(r.push(`inputs.${e}`),r.push(`inputs.${i.id}`))}const o=new c.DefaultProperty({defaultName:e,state:i,excludedDefaultsKeys:r,excludedStateKeys:["version"],theme:s});o.removeProperty("intervalsVisibilities"),o.addChild("intervalsVisibilities",new _.IntervalsVisibilitiesProperty(i&&i.intervalsVisibilities)),"PivotPointsStandard@tv-basicstudies"!==t.id&&"PivotPointsHighLow@tv-basicstudies"!==t.id||!o.hasChild("font")||o.removeProperty("font");const l=a.StudyMetaInfo.versionOf(t);return o.hasChild("version")?o.childs().version?.setValue(l):o.addProperty("version",l),t.TVScriptMetaInfoExprs&&!n&&o.addProperty("patchMetaInfoDefaults",!0),o}},590178:(t,e,i)=>{i.d(e,{ExtendedStudyDataSource:()=>r});var s=i(901466),n=i(454184);class r extends s.StudyDataSource{constructor(t,e,i,s){super(t,e.seriesSource(),i,s),this._series=e}_createStudyError(t){return(0,n.createStudyError)(this._getStudyErrorDescription(t),this._series.symbolInfo()?.exchange)}}},901466:(t,e,i)=>{i.r(e),i.d(e,{StudyDataSource:()=>p});var s=i(650151),n=i(547465),r=i(132565),o=i(359035),a=i(807958),l=i(259710),d=i(587482),u=i(284881),h=i(808825);const c=(0,i(735566).getLogger)("Chart.StudyDataSource");var _;!function(t){t[t.Idle=0]="Idle",
t[t.AwaitingConnection=1]="AwaitingConnection",t[t.AwaitingParent=2]="AwaitingParent",t[t.AwaitingFirstDataUpdate=3]="AwaitingFirstDataUpdate",t[t.Active=4]="Active"}(_||(_={}));class p{constructor(t,e,i,s,o=!1){this._inputs=null,this._status=_.Idle,this._studyId=null,this._turnaroundCounter=1,this._studyStatus={type:h.StudyStatusType.Undefined},this._studyStatusChanged=new n.Delegate,this._dataCleared=new n.Delegate,this._dataUpdated=new n.Delegate,this._boundOnGatewayIsConnectedChanged=this._onGatewayIsConnectedChanged.bind(this),this._ongoingDataUpdate=Promise.resolve(),this._gateway=t,this._metaInfo=s,this._forceUseExclamationMark=o,this._seriesSource=e,this._turnaroundPrefix=i,this._plots=new r.PlotList((0,d.studyPlotFunctionMap)(s),d.studyEmptyPlotValuePredicate),this._gateway.isConnected().subscribe(this._boundOnGatewayIsConnectedChanged),this._graphics=new u.LiveStudyGraphics(s.graphics)}destroy(){this.stop(),this._gateway.isConnected().unsubscribe(this._boundOnGatewayIsConnectedChanged),this._seriesSource.dataEvents().created().unsubscribeAll(this)}metaInfo(){return this._metaInfo}inputs(){return this._inputs}setInputs(t){this._inputs=t,null!==this._studyId&&(this._turnaroundCounter++,this._onStudyStatusChangedTo({type:h.StudyStatusType.Undefined}),this._gateway.modifyStudy(this._studyId,this._turnaround(),t,this._onMessage.bind(this)),this._status===_.Active&&this._changeStatusTo(_.AwaitingFirstDataUpdate))}isStarted(){return this._status!==_.Idle}isActive(){return this._status===_.Active}start(){this.isStarted()?c.logNormal("start: data source is already started, nothing to do"):((0,s.assert)(null!==this._inputs,"Inputs should be defined when starting a study data source"),this._gateway.isConnected().value()?this._createStudy():this._changeStatusTo(_.AwaitingConnection))}stop(){this.isStarted()?(null!==this._studyId&&(this._gateway.isConnected().value()&&this._gateway.removeStudy(this._studyId),this._studyId=null,this._onStudyStatusChangedTo({type:h.StudyStatusType.Undefined})),this._changeStatusTo(_.Idle)):c.logNormal("stop: data source is already stopped, nothing to do")}studyId(){return this._studyId}studyStatus(){return this._studyStatus}studyStatusChanged(){return this._studyStatusChanged}plots(){return this._plots}graphics(){return this._graphics}clearData(){this._plots.clear(),this._graphics.clear(),this._dataCleared.fire()}stopAndStealData(){(0,s.assert)(this._status===_.Active,"Couldn't steal data from non-active data source"),this.stop();const t=this._plots,e=this._graphics.extract();return this._plots=new r.PlotList((0,d.studyPlotFunctionMap)(this._metaInfo),d.studyEmptyPlotValuePredicate),{plots:t,graphics:e}}dataCleared(){return this._dataCleared}dataUpdated(){return this._dataUpdated}moveData(t){this._ongoingDataUpdate=this._ongoingDataUpdate.then((()=>{this._plots.move(t)}))}pendingUpdatesReady(){return this._ongoingDataUpdate}_createStudyError(t){return{type:h.StudyStatusType.Error,errorDescription:this._getStudyErrorDescription(t)}}_getStudyErrorDescription(t){return"string"==typeof t?{
error:t.split(":",2)[0]}:t}_changeStatusTo(t){(0,s.assert)(this._status!==t,"Source and destination status should be distinct"),c.logNormal(`Status changed from ${_[this._status]} to ${_[t]}`),this._status=t}_createStudy(){const t=this._seriesSource.instanceId();null!==t?this._createStudyUsingParentId(t):(this._changeStatusTo(_.AwaitingParent),this._seriesSource.dataEvents().created().subscribe(this,this._onSeriesCreated,!0))}_createStudyUsingParentId(t){(0,s.assert)(this._status!==_.Active,'Status should not be "Active" when creating a study'),(0,s.assert)(this._studyStatus.type===h.StudyStatusType.Undefined,'Study status should be "Undefined" when creating a study'),(0,s.assert)(null===this._studyId,"Study id should be empty when creating a study"),this._studyId=(0,l.makeNextStudyId)(),this._gateway.createStudy(this._studyId,this._turnaround(),t,a.StudyMetaInfo.getStudyIdWithLatestVersion(this.metaInfo(),this._forceUseExclamationMark),(0,s.ensureNotNull)(this._inputs),this._onMessage.bind(this),{id:this._metaInfo.id}),this._changeStatusTo(_.AwaitingFirstDataUpdate)}_onGatewayIsConnectedChanged(t){t?this._onGatewayConnected():this._onGatewayDisconnected()}_onGatewayConnected(){this._status===_.AwaitingConnection&&this._createStudy()}_onGatewayDisconnected(){this._status!==_.Idle&&this._status!==_.AwaitingConnection&&(this._studyId=null,this._changeStatusTo(_.AwaitingConnection),this._studyStatus.type!==h.StudyStatusType.Undefined&&this._onStudyStatusChangedTo({type:h.StudyStatusType.Undefined})),this._turnaroundCounter=1}_onSeriesCreated(){this._status===_.AwaitingParent&&this._createStudyUsingParentId((0,s.ensure)(this._seriesSource.instanceId()))}_onStudyStatusChangedTo(t){const e=this._studyStatus;this._studyStatus=t,c.logNormal(`Study status type changed from ${h.StudyStatusType[e.type]} to ${h.StudyStatusType[t.type]}`),this._studyStatusChanged.fire(e,t)}_onMessage(t){if("data_update"===t.method){const{customId:e,turnaround:i,plots:n,nonseries:r}=t.params;e===this._studyId&&this._checkTurnaround(i)&&this._onDataUpdate(n,(0,s.ensureDefined)(r))}else if("study_loading"===t.method){const[e,i]=t.params;e===this._studyId&&this._checkTurnaround(i)&&this._onStudyLoading(t.time)}else if("study_completed"===t.method){const[e,i]=t.params;e===this._studyId&&this._checkTurnaround(i)&&this._onStudyCompleted(t.time)}else if("study_error"===t.method){const[e,i,s,n]=t.params;e===this._studyId&&this._checkTurnaround(i)&&this._onStudyError(s,n,t.time)}else"clear_data"===t.method&&this._checkTurnaround(t.params.turnaround)&&this.clearData()}_onDataUpdate(t,e){const i=(0,o.unpackNonSeriesData)(e.d);return this._ongoingDataUpdate=this._ongoingDataUpdate.then((()=>i),(()=>i)).then(this._onDataUnpacked.bind(this,t,e.indexes)),this._ongoingDataUpdate}_onDataUnpacked(t,e,i){this._status!==_.Idle&&(this._status===_.AwaitingFirstDataUpdate&&(this._changeStatusTo(_.Active),this.clearData()),this._mergePlots(t),null!==i&&(i.indexes_replace?((0,s.assert)("nochange"!==e),
this._graphics.replaceIndexesTo(e)):("nochange"!==e&&this._graphics.replaceIndexesTo(e),void 0!==i.graphicsCmds&&this._graphics.processCommands(i.graphicsCmds))),this._dataUpdated.fire(t,i,e))}_onStudyLoading(t){this._onStudyStatusChangedTo({type:h.StudyStatusType.Loading,startTime:Date.now()})}_onStudyError(t,e,i){this.clearData(),this._onStudyStatusChangedTo(this._createStudyError(t))}_onStudyCompleted(t){this._onStudyStatusChangedTo({type:h.StudyStatusType.Completed})}_mergePlots(t){this._plots.merge(t)}_turnaround(){return`${this._turnaroundPrefix}${this._turnaroundCounter}`}_checkTurnaround(t){const e=this._turnaround();return t===e||t===this._seriesSource.turnaround()||t===`${this._seriesSource.turnaround()}_${e}`}}},616427:(t,e,i)=>{i.d(e,{areEqualSymbols:()=>o,compareSymbolParams:()=>u,symbolParams:()=>d,symbolSameAsCurrent:()=>l});i(931924);var s=i(388741),n=i(477786);const r=!0;function o(t,e){return void 0===t?void 0===e:void 0!==e&&(r?t.toUpperCase()===e.toUpperCase():t===e)}function a(t,e){return t.some((t=>o(e,t)))}function l(t,e){if(null===e)return!1;if(e){if(o(e.full_name,t)||o(e.pro_name,t))return!0;if(o(e.ticker,t))return!0;if(e.aliases&&a(e.aliases,t))return!0;if(e.alternatives&&a(e.alternatives,t))return!0;if(0===t.indexOf("FRA:")&&o(e.pro_name,t.replace("FRA:","FWB:")))return!0}return!1}function d(t){return{symbol:t.symbol(),currency:t.currency(),unit:t.unit(),interval:t.interval(),style:t.style()}}function u(t,e,i){const{symbol:r,currency:o,unit:a,style:l,interval:d}=e,u=void 0!==r&&!t.symbolSameAsResolved(r);let h,c;const _=t.symbolInfo();null!==_?(h=void 0!==o&&!function(t,e){return null===t&&!(0,s.isConvertedToOtherCurrency)(e)||t===(0,s.symbolCurrency)(e)}(o,_),c=void 0!==a&&!function(t,e,i){return null===t&&!(0,s.isConvertedToOtherUnit)(e,i)||t===(0,s.symbolUnit)(e,i)}(a,_,i)):(h=void 0!==o&&o!==t.currency(),c=void 0!==a&&a!==t.unit());return{symbolChanged:u,intervalChanged:void 0!==d&&!n.Interval.isEqual(t.interval(),d),currencyChanged:h,unitChanged:c,styleChanged:void 0!==l&&l!==t.style(),styleChangeRequiresRestart:void 0!==l&&(0,s.styleChangeRequiresRestart)(l,t.style())}}},87521:(t,e,i)=>{i.d(e,{TimeAxisView:()=>o});var s=i(534328),n=i(688857);class r{constructor(){this._data=null}setData(t){this._data=t}draw(t,e,i){if(null===this._data||!this._data.visible||0===this._data.text.length)return;const s=this._data;t.font=i.font;const r=Math.round(i.widthCache.measureText(t,s.text));if(r<=0)return;t.save();const o=i.paddingHorizontal,a=r+2*o,l=a/2;let d=s.coordinate,u=Math.floor(d-l)+.5;if(s.alwaysInViewPort){const t=s.width;u<0?(d+=Math.abs(0-u),u=Math.floor(d-l)+.5):u+a>t&&(d-=Math.abs(t-(u+a)),u=Math.floor(d-l)+.5)}const h=u+a,c=Math.ceil(0+i.borderSize+i.offsetSize+i.paddingTop+i.fontSize+i.paddingBottom),{horizontalPixelRatio:_,verticalPixelRatio:p}=e;t.fillStyle=s.background;const y=Math.round(u*_),S=Math.round(0*p),g=Math.round(h*_),m=Math.round(c*p),v=Math.round(2*_);t.beginPath(),t.moveTo(y,S),t.lineTo(y,m-v),t.arcTo(y,m,y+v,m,v),t.lineTo(g-v,m),t.arcTo(g,m,g,m-v,v),t.lineTo(g,S),
t.fill();const f=0+i.borderSize+i.offsetSize+i.paddingTop+i.fontSize/2;t.textAlign="left",t.textBaseline="middle",t.fillStyle=s.color;const P=i.widthCache.yMidCorrection(t,"Apr0");t.translate((u+o)*_,(f+P)*p),(0,n.drawScaled)(t,_,p,(()=>t.fillText(s.text,0,0))),t.restore()}}class o{constructor(t){this._renderer=new r,this._rendererData={background:"",color:"",coordinate:0,text:"",visible:!1,width:0,alwaysInViewPort:!0},this._invalidated=!0,this._model=t,this._renderer.setData(this._rendererData)}update(){this._invalidated=!0}renderer(){return this._invalidated&&(this._updateImpl(),this._invalidated=!1),this._renderer}coordinate(){return this._rendererData.coordinate}_getAlwaysInViewPort(){return!0}_getText(t){const e=this._model.timeScale().indexToUserTime(t);return null!==e?this._model.dateTimeFormatter().format(e):""}_updateImpl(){const t=this._rendererData;if(t.visible=!1,this._model.timeScale().isEmpty()||!this._isVisible())return;const e=this._getIndex();null!==e&&Number.isFinite(e)&&(t.visible=!0,t.width=this._model.timeScale().width(),t.background=this._getBgColor(),t.color=(0,s.colorFromBackground)(t.background),t.coordinate=this._model.timeScale().indexToCoordinate(e),t.alwaysInViewPort=this._getAlwaysInViewPort(),t.text=this._getText(e),this._invalidated=!1)}}},422063:(t,e,i)=>{i.d(e,{UndoCommand:()=>n});var s=i(418450);class n{constructor(t,e=!0,i=!0){this._text=t||new s.TranslatedString("",""),this._executeOnPush=e,this._affectsState=i}text(){return this._text}executeOnPush(){return this._executeOnPush}affectsState(){return this._affectsState}canMerge(t){return!1}merge(t){throw new Error("Should be re-implemented in child classes")}}},75060:(t,e,i)=>{i.d(e,{canPlaceAlertOnResolution:()=>r});var s=i(477786),n=i(778016);function r(t,e){const i=s.Interval.isSeconds(t),r=e?e?.alertsOnSeconds:(0,n.enabled)("ALERTS_ON_SECONDS");return!i||r}},677500:(t,e,i)=>{i.d(e,{getChartAlertsFacade:()=>o,getChartAlertsFacadeIfCreatedBefore:()=>a});var s=i(154890);let n,r;async function o(){return n||(n=async function(){const[t,{getAlertsCollection:e},n]=await Promise.all([Promise.all([i.e(32856),i.e(78819),i.e(90345),i.e(74293),i.e(25214),i.e(80349),i.e(16565),i.e(27568),i.e(1399),i.e(36679)]).then(i.bind(i,241340)),Promise.all([i.e(83477),i.e(62885),i.e(90345),i.e(74293),i.e(80349),i.e(16565),i.e(27568),i.e(14141)]).then(i.bind(i,827568)),(0,s.getChartSourceIdsGetter)()]);return new t.ChartAlertsFacade(e(),n)}()),r||(r=await n),r}function a(){return r??null}},154890:(t,e,i)=>{i.d(e,{getChartSourceIdsGetter:()=>s});const s=(0,i(481251).default)((async()=>{const{ChartSourceIdsGetter:t}=await Promise.all([i.e(76941),i.e(90345),i.e(74293),i.e(80349),i.e(16565),i.e(27568),i.e(79979)]).then(i.bind(i,517696));return new t}))},234938:(t,e,i)=>{i.d(e,{showGoProAlertsOnSecondsDialog:()=>n});var s=i(707934);i(659863);function n(){(0,s.createGoProDialog)({feature:"alertsOnSeconds"})}}}]);