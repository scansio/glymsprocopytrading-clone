(self.webpackChunktradingview=self.webpackChunktradingview||[]).push([[5093,62526],{259142:function(e,t){var i,s,o;s=[t],i=function(e){"use strict";function t(e){if(Array.isArray(e)){for(var t=0,i=Array(e.length);t<e.length;t++)i[t]=e[t];return i}return Array.from(e)}Object.defineProperty(e,"__esModule",{value:!0});var i=!1;if("undefined"!=typeof window){var s={get passive(){i=!0}};window.addEventListener("testPassive",null,s),window.removeEventListener("testPassive",null,s)}var o="undefined"!=typeof window&&window.navigator&&window.navigator.platform&&/iP(ad|hone|od)/.test(window.navigator.platform),n=[],l=!1,a=-1,r=void 0,d=void 0,u=function(e){return n.some((function(t){return!(!t.options.allowTouchMove||!t.options.allowTouchMove(e))}))},c=function(e){var t=e||window.event;return!!u(t.target)||1<t.touches.length||(t.preventDefault&&t.preventDefault(),!1)},h=function(){setTimeout((function(){void 0!==d&&(document.body.style.paddingRight=d,d=void 0),void 0!==r&&(document.body.style.overflow=r,r=void 0)}))};e.disableBodyScroll=function(e,s){if(o){if(!e)return void console.error("disableBodyScroll unsuccessful - targetElement must be provided when calling disableBodyScroll on IOS devices.");if(e&&!n.some((function(t){return t.targetElement===e}))){var h={targetElement:e,options:s||{}};n=[].concat(t(n),[h]),e.ontouchstart=function(e){1===e.targetTouches.length&&(a=e.targetTouches[0].clientY)},e.ontouchmove=function(t){var i,s,o,n;1===t.targetTouches.length&&(s=e,n=(i=t).targetTouches[0].clientY-a,!u(i.target)&&(s&&0===s.scrollTop&&0<n||(o=s)&&o.scrollHeight-o.scrollTop<=o.clientHeight&&n<0?c(i):i.stopPropagation()))},l||(document.addEventListener("touchmove",c,i?{passive:!1}:void 0),l=!0)}}else{_=s,setTimeout((function(){if(void 0===d){var e=!!_&&!0===_.reserveScrollBarGap,t=window.innerWidth-document.documentElement.clientWidth;e&&0<t&&(d=document.body.style.paddingRight,document.body.style.paddingRight=t+"px")}void 0===r&&(r=document.body.style.overflow,document.body.style.overflow="hidden")}));var p={targetElement:e,options:s||{}};n=[].concat(t(n),[p])}var _},e.clearAllBodyScrollLocks=function(){o?(n.forEach((function(e){e.targetElement.ontouchstart=null,e.targetElement.ontouchmove=null})),l&&(document.removeEventListener("touchmove",c,i?{passive:!1}:void 0),l=!1),n=[],a=-1):(h(),n=[])},e.enableBodyScroll=function(e){if(o){if(!e)return void console.error("enableBodyScroll unsuccessful - targetElement must be provided when calling enableBodyScroll on IOS devices.");e.ontouchstart=null,e.ontouchmove=null,n=n.filter((function(t){return t.targetElement!==e})),l&&0===n.length&&(document.removeEventListener("touchmove",c,i?{passive:!1}:void 0),l=!1)}else 1===n.length&&n[0].targetElement===e?(h(),n=[]):n=n.filter((function(t){return t.targetElement!==e}))}},void 0===(o="function"==typeof i?i.apply(t,s):i)||(e.exports=o)},138672:e=>{e.exports={"nav-button":"nav-button-znwuaSC1",link:"link-znwuaSC1",background:"background-znwuaSC1",icon:"icon-znwuaSC1","flip-icon":"flip-icon-znwuaSC1","size-large":"size-large-znwuaSC1",
"preserve-paddings":"preserve-paddings-znwuaSC1","size-medium":"size-medium-znwuaSC1","size-small":"size-small-znwuaSC1","size-xsmall":"size-xsmall-znwuaSC1","size-xxsmall":"size-xxsmall-znwuaSC1","visually-hidden":"visually-hidden-znwuaSC1"}},737643:e=>{e.exports={pair:"pair-ocURKVwI",xxceptionallysmalldonotusebrv1023:"xxceptionallysmalldonotusebrv1023-ocURKVwI",xxxxsmall:"xxxxsmall-ocURKVwI",xxxsmall:"xxxsmall-ocURKVwI",xxsmall:"xxsmall-ocURKVwI",xsmall:"xsmall-ocURKVwI",small:"small-ocURKVwI",medium:"medium-ocURKVwI",large:"large-ocURKVwI",xlarge:"xlarge-ocURKVwI",xxlarge:"xxlarge-ocURKVwI",xxxlarge:"xxxlarge-ocURKVwI",logo:"logo-ocURKVwI",skeleton:"skeleton-ocURKVwI",empty:"empty-ocURKVwI"}},757554:e=>{e.exports={logo:"logo-PsAlMQQF",hidden:"hidden-PsAlMQQF",xxceptionallysmalldonotusebrv1023:"xxceptionallysmalldonotusebrv1023-PsAlMQQF",xxxsmall:"xxxsmall-PsAlMQQF",xxsmall:"xxsmall-PsAlMQQF",xsmall:"xsmall-PsAlMQQF",small:"small-PsAlMQQF",medium:"medium-PsAlMQQF",large:"large-PsAlMQQF",xlarge:"xlarge-PsAlMQQF",xxlarge:"xxlarge-PsAlMQQF",xxxlarge:"xxxlarge-PsAlMQQF",skeleton:"skeleton-PsAlMQQF",letter:"letter-PsAlMQQF"}},241427:e=>{e.exports={dialog:"dialog-aRAWUDhF",rounded:"rounded-aRAWUDhF",shadowed:"shadowed-aRAWUDhF",fullscreen:"fullscreen-aRAWUDhF",darker:"darker-aRAWUDhF",backdrop:"backdrop-aRAWUDhF"}},649107:e=>{e.exports={loader:"loader-UL6iwcBa",static:"static-UL6iwcBa",item:"item-UL6iwcBa","tv-button-loader":"tv-button-loader-UL6iwcBa",medium:"medium-UL6iwcBa",small:"small-UL6iwcBa",black:"black-UL6iwcBa",white:"white-UL6iwcBa",gray:"gray-UL6iwcBa",primary:"primary-UL6iwcBa"}},116313:e=>{e.exports={wrapper:"wrapper-TJ9ObuLF",animated:"animated-TJ9ObuLF",pulsation:"pulsation-TJ9ObuLF"}},648692:e=>{e.exports={wrap:"wrap-HXzRntFl",input:"input-HXzRntFl",box:"box-HXzRntFl",hoverDot:"hoverDot-HXzRntFl",red:"red-HXzRntFl",blue:"blue-HXzRntFl",green:"green-HXzRntFl",orange:"orange-HXzRntFl",purple:"purple-HXzRntFl",cyan:"cyan-HXzRntFl",pink:"pink-HXzRntFl",large:"large-HXzRntFl",pickerDot:"pickerDot-HXzRntFl"}},916067:e=>{e.exports={wrapper:"wrapper-BZLCGWlx",buttons:"buttons-BZLCGWlx",colorSelectButton:"colorSelectButton-BZLCGWlx"}},534426:e=>{e.exports={wrapper:"wrapper-xPNB6vOB",selector:"selector-xPNB6vOB",arrowLeft:"arrowLeft-xPNB6vOB",colorSelectButton:"colorSelectButton-xPNB6vOB",popup:"popup-xPNB6vOB"}},986:e=>{e.exports={wrap:"wrap-erqqoDve",uiMarker:"uiMarker-erqqoDve",red:"red-erqqoDve",blue:"blue-erqqoDve",green:"green-erqqoDve",orange:"orange-erqqoDve",purple:"purple-erqqoDve",cyan:"cyan-erqqoDve",pink:"pink-erqqoDve",uiMarker__small:"uiMarker__small-erqqoDve"}},447429:e=>{e.exports={item:"item-GJX1EXhk",interactive:"interactive-GJX1EXhk",hovered:"hovered-GJX1EXhk",disabled:"disabled-GJX1EXhk",active:"active-GJX1EXhk",shortcut:"shortcut-GJX1EXhk",normal:"normal-GJX1EXhk",big:"big-GJX1EXhk",iconCell:"iconCell-GJX1EXhk",icon:"icon-GJX1EXhk",content:"content-GJX1EXhk",label:"label-GJX1EXhk",checked:"checked-GJX1EXhk",toolbox:"toolbox-GJX1EXhk",showToolboxOnHover:"showToolboxOnHover-GJX1EXhk",
arrowIcon:"arrowIcon-GJX1EXhk",subMenu:"subMenu-GJX1EXhk",invisibleHotkey:"invisibleHotkey-GJX1EXhk"}},947156:e=>{e.exports={"tablet-normal-breakpoint":"(max-width: 768px)","tooltip-offset":"20px",dialog:"dialog-qyCw0PaN",dragging:"dragging-qyCw0PaN",mobile:"mobile-qyCw0PaN",fullscreen:"fullscreen-qyCw0PaN",dialogAnimatedAppearance:"dialogAnimatedAppearance-qyCw0PaN",dialogAnimation:"dialogAnimation-qyCw0PaN",dialogTooltip:"dialogTooltip-qyCw0PaN"}},405264:e=>{e.exports={item:"item-WJDah4zD",emptyIcons:"emptyIcons-WJDah4zD",loading:"loading-WJDah4zD",disabled:"disabled-WJDah4zD",interactive:"interactive-WJDah4zD",hovered:"hovered-WJDah4zD",normal:"normal-WJDah4zD",big:"big-WJDah4zD",icon:"icon-WJDah4zD",label:"label-WJDah4zD",title:"title-WJDah4zD",nested:"nested-WJDah4zD",shortcut:"shortcut-WJDah4zD",remove:"remove-WJDah4zD"}},868745:e=>{e.exports={separator:"separator-Ymxd0dt_"}},276773:e=>{e.exports={"default-drawer-min-top-distance":"100px",wrap:"wrap-_HnK0UIN",positionBottom:"positionBottom-_HnK0UIN",backdrop:"backdrop-_HnK0UIN",drawer:"drawer-_HnK0UIN",positionLeft:"positionLeft-_HnK0UIN"}},743970:e=>{e.exports={container:"container-zLVm6B4t",content:"content-zLVm6B4t",arrowHolder:"arrowHolder-zLVm6B4t","arrowHolder--below":"arrowHolder--below-zLVm6B4t","arrowHolder--above":"arrowHolder--above-zLVm6B4t","arrowHolder--before":"arrowHolder--before-zLVm6B4t","arrowHolder--after":"arrowHolder--after-zLVm6B4t","arrowHolder--above-fix":"arrowHolder--above-fix-zLVm6B4t","arrowHolder--before-rtl-fix":"arrowHolder--before-rtl-fix-zLVm6B4t","arrowHolder--after-ltr-fix":"arrowHolder--after-ltr-fix-zLVm6B4t",label:"label-zLVm6B4t",closeButton:"closeButton-zLVm6B4t"}},230725:(e,t,i)=>{"use strict";i.d(t,{ColorSelector:()=>w});var s=i(50959),o=i(604e3),n=i(591800),l=i(451608),a=i(887208),r=i(432438),d=i(497754),u=i.n(d),c=i(79205),h=i(444372),p=i(948019),_=i(263361),g=i(676809),m=i(24122),b=i(648692);const v=(0,l.makeSwitchGroupItem)((function(e){const{className:t,value:n=o.ListColor.Red,name:l,checked:a}=e,[r,d]=(0,_.useRovingTabindexElement)(null),v=(0,s.useContext)(p.ContextMenuContext),f=v?.type??"menu",w=n;return s.createElement("label",{ref:r,tabIndex:d,className:u()(t,b.wrap,"drawer"===f&&b.large),"data-color":w,role:"menuitem","aria-label":h.t(null,{replace:{color:w}},i(958673)),"aria-checked":a},s.createElement("input",{className:b.input,type:"radio",name:l,value:n,checked:a,onChange:function(){e.onChange&&e.onChange(n)},onClick:a?function(){e.onClickIfChecked&&e.onClickIfChecked(n)}:void 0}),s.createElement("div",{className:u()(b.box,b[w],"drawer"===f&&b.large)},a?s.createElement(c.Icon,{icon:g}):s.createElement("div",{className:b.pickerDot},s.createElement(c.Icon,{className:b.hoverDot,icon:m}))))})),f=[39,37,13,32,27];function w(e){const{buttonClassName:t,value:i,onSelectedClick:d,fromKeyboard:u}=e,c=(0,s.useRef)(null),h=(0,s.useCallback)((e=>{if(!c.current||e.defaultPrevented)return;const t=(0,n.hashFromEvent)(e);if(!f.includes(t))return;e.preventDefault();const s=(0,
a.queryFocusableElements)(c.current).sort(a.navigationOrderComparator),l=s.findIndex((e=>e===document.activeElement));if(-1===l)return;const d=s[l];let u;switch(t){case 13:case 32:_(d.dataset.color||o.ListColor.Red);break;case 27:_(i)}switch((0,a.mapKeyCodeToDirection)(t)){case"inlineNext":u=s[l+1]||s[0];break;case"inlinePrev":u=s[l-1]||s[s.length-1]}u instanceof HTMLLabelElement&&((0,r.becomeSecondaryElement)(d),(0,r.becomeMainElement)(u),u.focus())}),[]);(0,s.useLayoutEffect)((()=>{if(!u)return;const e=document.activeElement,t=c.current;if(!t)return;const[i]=(0,a.queryFocusableElements)(t).sort(a.navigationOrderComparator);return i?((0,r.becomeMainElement)(i),i.focus(),()=>{e instanceof HTMLElement&&e.focus()}):void 0}),[]);const p=o.LIST_COLORS.map(((e,i)=>s.createElement(v,{key:i,className:t,onClickIfChecked:d,value:e})));return s.createElement("menu",{ref:c,onKeyDown:h},s.createElement(l.SwitchGroup,{name:"color-selector",onChange:_,values:void 0!==i?[i]:[]},p));function _(t){e.onChange&&void 0!==t&&e.onChange(t)}}},24064:(e,t,i)=>{"use strict";i.d(t,{flaggedSymbolColorName:()=>n});var s=i(604e3),o=i(444372);function n(e){switch(e){case s.ListColor.Red:return o.t(null,void 0,i(653893));case s.ListColor.Green:return o.t(null,void 0,i(831313));case s.ListColor.Blue:return o.t(null,void 0,i(747414));case s.ListColor.Orange:return o.t(null,void 0,i(721149));case s.ListColor.Purple:return o.t(null,void 0,i(321564));case s.ListColor.Cyan:return o.t(null,void 0,i(84535));case s.ListColor.Pink:return o.t(null,void 0,i(996355))}}},547989:(e,t,i)=>{"use strict";i.d(t,{LabelColorSelector:()=>a});var s=i(50959),o=i(230725),n=i(982528),l=i(916067);class a extends s.PureComponent{constructor(){super(...arguments),this._onChange=e=>{this.props.onChange(e)}}render(){const{value:e}=this.props;return s.createElement("span",{className:l.wrapper},s.createElement("span",{className:l.buttons,onClick:n.preventDefault},s.createElement(o.ColorSelector,{buttonClassName:l.colorSelectButton,value:e,onChange:this._onChange,onSelectedClick:this._onChange})))}}},857769:(e,t,i)=>{"use strict";i.d(t,{PopupColorSelector:()=>y});var s=i(50959),o=i(670797),n=i(642709),l=i(18182),a=i(332585),r=i(67812),d=i(762852),u=i(969680),c=i(707533),h=i(230725),p=i(778785),_=i(534426);class g extends s.PureComponent{constructor(){super(...arguments),this._popUpElem=null,this._onChange=e=>{this.props.onSelectColor(e),this.props.hide()},this._onTargetMouseLeave=e=>{const t=!!e.relatedTarget.nodeName,i=e.relatedTarget===this._popUpElem,s=this._popUpElem&&t&&this._popUpElem.contains(e.relatedTarget);i||s||this.props.hide()},this._onPopUpMouseLeave=e=>{const t=!!e.nativeEvent.relatedTarget.nodeName,i=e.nativeEvent.relatedTarget===this.props.elem,s=t&&this.props.elem.contains(e.nativeEvent.relatedTarget);i||s||this.props.hide()},this._onTouchStart=e=>{const t=!!e.target.nodeName,i=e.target===this.props.elem,s=e.target===this._popUpElem,o=t&&this.props.elem.contains(e.target),n=this._popUpElem&&t&&this._popUpElem.contains(e.target);i||o||s||n||this.props.hide()},
this._setPopUpElem=e=>{this._popUpElem=e}}componentDidMount(){document.documentElement&&(p.mobiletouch?document.documentElement.addEventListener("touchstart",this._onTouchStart):(this.props.elem.addEventListener("mouseleave",this._onTargetMouseLeave),document.body.addEventListener("scroll",this.props.hide)))}componentWillUnmount(){document.documentElement&&(p.mobiletouch?document.documentElement.removeEventListener("touchstart",this._onTouchStart):this.props.elem&&(this.props.elem.removeEventListener("mouseleave",this._onTargetMouseLeave),document.documentElement.removeEventListener("scroll",this.props.hide)))}render(){const e={top:0,left:0};if(this.props.elem){const t=this.props.elem.getBoundingClientRect();e.top=t.top+t.height/2,e.left=t.left+((0,u.isRtl)()?0:t.width)}return s.createElement(c.Portal,null,s.createElement("div",{style:e,className:_.popup,ref:this._setPopUpElem,onMouseLeave:p.mobiletouch?void 0:this._onPopUpMouseLeave},s.createElement("div",{className:_.wrapper},s.createElement("div",{className:_.selector},s.createElement("div",{className:_.arrowLeft}),s.createElement(h.ColorSelector,{buttonClassName:_.colorSelectButton,value:this.props.currentColor,fromKeyboard:this.props.fromKeyboard,onChange:this._onChange})))))}}var m=i(948019);function b(e){const{actions:t,...i}=e;return s.createElement(l.MatchMedia,{rule:n.DialogBreakpoints.TabletSmall},(e=>e&&t?s.createElement(a.DrawerManager,null,s.createElement(m.ContextMenuContext.Provider,{value:{type:"drawer"}},s.createElement(d.Drawer,{onClose:i.hide,position:"Bottom"},s.createElement(r.ContextMenuList,{items:t})))):s.createElement(g,{...i})))}var v=i(631456);let f=null,w=null;var y;!function(e){function t(){f&&w?.unmount()}e.show=function(e){f||(f=document.createElement("div")),t(),w=(0,v.createReactRoot)(s.createElement(o.SlotContext.Provider,{value:e.manager||null},s.createElement(b,{...e,hide:t})),f)},e.hide=t}(y||(y={}))},959015:(e,t,i)=>{"use strict";i.d(t,{SymbolMarker:()=>f,createSymbolMarkerStandalone:()=>y});i(142492);var s=i(833367),o=i(330074),n=i(857769),l=i(60454),a=i(642709),r=i(50959),d=i(444372),u=i(604e3),c=i(547989),h=i(172073),p=i(779923),_=i(494966),g=i(345848),m=i(810978),b=i(24064);function v(e,t,s,o){const n=function(e,t,s,o){const n=d.t(null,void 0,i(160589)).format({symbol:(0,_.safeShortName)(t)}),l=e.getSymbolColor(t)||void 0,a={},p=u.LIST_COLORS.map((e=>{const t=new h.Action({actionId:"Watchlist.ChangeFlaggedGroupColor",options:{label:(0,b.flaggedSymbolColorName)(e),onExecute:()=>v(e),checkable:!0,checked:e===l}});return a[e]=t,t})),v=i=>{o(),(0,m.runOrSigninWithFeature)((()=>{s.setColor(i),e.setSymbolsColor([t],s.getColor()),(0,g.trackEvent)("Watchlist","Context menu","Flag"),u.LIST_COLORS.forEach((e=>{a[e].update({checked:e===s.getColor()})}))}),{feature:"flaggedSymbolsColors",source:"Set symbol color"})},f={doNotCloseOnClick:!0};return[new h.Action({actionId:"Watchlist.FlagSymbol",options:{label:n,onExecute:()=>v(s.getColor())}}),new h.Action({actionId:"Watchlist.ChangeFlaggedGroupColor",options:{...f,
label:d.t(null,void 0,i(84151)),subItems:p},customActionOptions:{...f,jsxLabel:r.createElement(c.LabelColorSelector,{value:l,onChange:v})}})]}(e,t,s,o);return null!==e.getSymbolColor(t)&&n.push(function(e,t){return new h.Action({actionId:"Watchlist.UnflagSymbol",options:{label:d.t(null,void 0,i(967047)).format({symbol:(0,_.safeShortName)(t)}),onExecute:()=>{e.setSymbolsColor([t],null),(0,g.trackEvent)("Watchlist","Context menu","Unflag")}}})}(e,t)),n.push(function(e){return new h.Action({actionId:"Watchlist.UnflagAllSymbols",options:{label:d.t(null,void 0,i(429678)),onExecute:()=>{var t;t=()=>{e.clearAllSymbolsColor()},(0,p.showConfirm)({text:d.t(null,void 0,i(173837)),onConfirm:({dialogClose:e})=>{t(),e()}}),(0,g.trackEvent)("Watchlist","Context menu","Unflag all")}}})}(e)),n}class f{constructor(e){this._service=(0,o.getMarkedSymbolsListServiceInstance)(),this._colorManager=new l.ColorManager({context:l.ColorContext.SymbolMarker}),this._classes=[],this._onClick=e=>{e.preventDefault();const t=()=>{const t=v(this._service,this._symbol,this._colorManager,n.PopupColorSelector.hide),i=this._colorManager.getColor(),s={elem:this._uimarker.getElem(),currentColor:i,onSelectColor:this._onSelectColor,actions:t,manager:this._opts.manager,fromKeyboard:e instanceof KeyboardEvent};window.matchMedia(a.DialogBreakpoints.TabletSmall).matches?n.PopupColorSelector.show(s):null===this._color?(n.PopupColorSelector.show(s),this._service.setSymbolsColor([this._symbol],i)):(n.PopupColorSelector.hide(),this._service.setSymbolsColor([this._symbol],null))},i=window.is_authenticated;(0,m.runOrSigninWithFeature)((()=>{i&&(this._opts.onClick?this._opts.onClick(this._symbol,t):t())}),{feature:"flaggedSymbolsColors",source:"Set symbol color"})},this._onSelectColor=e=>{this._colorManager.setColor(e),this._service.setSymbolsColor([this._symbol],this._colorManager.getColor())},this._onDblClick=e=>{e.preventDefault()},this._onChange=()=>{this._setState(this._service.getSymbolColor(this._symbol))},this._opts=e,this._symbol=e.symbol,this._color=e.color||this._service.getSymbolColor(this._symbol),this._uimarker=new s.UiMarker({color:this._color,container:e.container,onClick:this._onClick,onDblClick:this._onDblClick,specialImage:e.specialImage}),e.className&&this.setClassName(e.className),null!==this._color&&this._addActiveClassName(),this._service.onSymbolChange(this._symbol,this._onChange)}updateSubscription(){this._setState(this._service.getSymbolColor(this._symbol))}bindTo(e,t){this._service.offSymbolChange(this._symbol,this._onChange),this._symbol=e,this._uimarker.appendTo(t),this._setState(this._service.getSymbolColor(e)),this._service.onSymbolChange(e,this._onChange)}unbind(){this._service.offSymbolChange(this._symbol,this._onChange),this._uimarker.detach()}getElem(){return this._uimarker.getElem()}isMarked(){return null!==this._color}setClassName(e){this._uimarker.getElem().classList.remove(...this._classes),this._classes=e.split(" ").filter(Boolean),this._uimarker.getElem().classList.add(...this._classes)}destroy(){this.unbind(),
delete this._uimarker,delete this._opts}toggle(e){this._onClick(e)}_setState(e){const t=this.isMarked();this._color=e,null!==this._color?(this._uimarker.setColor(this._color),this._addActiveClassName()):(this._uimarker.removeColor(),this._removeActiveClassName()),void 0!==this._opts.onMarkedChanged&&t!==this.isMarked()&&this._opts.onMarkedChanged()}_addActiveClassName(){this._opts.activeClassName&&this._uimarker.addClass(this._opts.activeClassName)}_removeActiveClassName(){this._opts.activeClassName&&this._uimarker.removeClass(this._opts.activeClassName)}}class w extends f{constructor(e){super(e),this._onInit=()=>{this.updateSubscription()},this._service.onInit(this._onInit)}destroy(){this._service.offInit(this._onInit),super.destroy()}}function y(e){return new w(e)}},833367:(e,t,i)=>{"use strict";i.d(t,{UiMarker:()=>r});var s=i(604e3),o=i(778785),n=i(497754),l=i(904799),a=i(986);class r{constructor(e){this._onClick=e=>{this._opts.onClick&&this._opts.onClick(e)},this._onDblClick=e=>{this._opts.onDblClick&&this._opts.onDblClick(e)},this._container=e.container,this._opts=e,this._elem=this._render(e),this._addEventListeners()}setColor(e){this.removeColor(),this.addClass(a[e])}removeColor(){this._elem.classList.remove(a[s.ListColor.Red],a[s.ListColor.Orange],a[s.ListColor.Purple],a[s.ListColor.Green],a[s.ListColor.Blue],a[s.ListColor.Cyan],a[s.ListColor.Pink])}addClass(e){this._elem.classList.add(e)}removeClass(e){this._elem.classList.remove(e)}getElem(){return this._elem}appendTo(e){this.detach(),this._container=e,this._container.appendChild(this._elem),this._addEventListeners()}detach(){this._removeEventListeners(),this._container&&(this._container.removeChild(this._elem),delete this._container)}_render(e){const t=n(a.uiMarker,{[e.className]:Boolean(e.className),[a[e.color]]:Boolean(e.color)}),i=e.specialImage||l,s=document.createElement("div");return s.className=t,s.innerHTML=i,this._container&&this._container.appendChild(s),s}_addEventListeners(){if(this._opts.onClick){const e=o.mobiletouch?"touchstart":"click";this._elem.addEventListener(e,this._onClick)}this._opts.onDblClick&&this._elem.addEventListener("dblclick",this._onDblClick)}_removeEventListeners(){if(this._opts.onClick){const e=o.mobiletouch?"touchstart":"click";this._elem.removeEventListener(e,this._onClick)}this._opts.onDblClick&&this._elem.removeEventListener("dblclick",this._onDblClick)}}},897782:(e,t,i)=>{"use strict";i.d(t,{NavButton:()=>c});var s=i(50959),o=i(497754),n=i.n(o),l=i(79205),a=i(138672),r=i.n(a);function d(e){const{size:t="large",preservePaddings:i,isLink:s,flipIconOnRtl:o,className:l}=e;return n()(r()["nav-button"],r()[`size-${t}`],i&&r()["preserve-paddings"],o&&r()["flip-icon"],s&&r().link,l)}function u(e){const{children:t,icon:i}=e;return s.createElement(s.Fragment,null,s.createElement("span",{className:r().background}),s.createElement(l.Icon,{icon:i,className:r().icon,"aria-hidden":!0}),t&&s.createElement("span",{className:r()["visually-hidden"]},t))}const c=(0,s.forwardRef)(((e,t)=>{
const{icon:i,type:o="button",preservePaddings:n,flipIconOnRtl:l,size:a,"aria-label":r,...c}=e;return s.createElement("button",{...c,className:d({...e,children:r}),ref:t,type:o},s.createElement(u,{icon:i},r))}));c.displayName="NavButton";var h=i(14388),p=i(551080);(0,s.forwardRef)(((e,t)=>{const{icon:i,renderComponent:o,"aria-label":n,...l}=e,a=o??h.CustomComponentDefaultLink;return s.createElement(a,{...l,className:d({...e,children:n,isLink:!0}),reference:(0,p.isomorphicRef)(t)},s.createElement(u,{icon:i},n))})).displayName="NavAnchorButton"},115078:(e,t,i)=>{"use strict";i.d(t,{getBlockStyleClasses:()=>r,getLogoStyleClasses:()=>d});var s=i(497754),o=i.n(s),n=i(548729),l=i(737643),a=i.n(l);function r(e,t){return o()(a().pair,a()[e],t)}function d(e,t=2,i=!0){return o()(a().logo,a()[e],a().skeleton,n.skeletonTheme.wrapper,!i&&a().empty,1===t&&o()(n.skeletonTheme.animated))}},884566:(e,t,i)=>{"use strict";i.d(t,{CircleLogo:()=>a,hiddenCircleLogoClass:()=>l});var s=i(50959),o=i(842060),n=i(757554);const l=i.n(n)().hidden;function a(e){const t=(0,o.isCircleLogoWithUrlProps)(e),[i,n]=(0,s.useState)(0),l=(0,s.useRef)(null),a=(0,o.getStyleClasses)(e.size,i,e.className),r=e.alt??e.title??"",d=t?r[0]:e.placeholderLetter;return(0,s.useEffect)((()=>n(l.current?.complete??!t?2:1)),[t]),t&&3!==i?s.createElement("img",{ref:l,className:a,crossOrigin:"",src:e.logoUrl,alt:r,title:e.title,loading:e.loading,onLoad:()=>n(2),onError:()=>n(3),"aria-label":e["aria-label"],"aria-hidden":e["aria-hidden"]}):s.createElement("span",{className:a,title:e.title,"aria-label":e["aria-label"],"aria-hidden":e["aria-hidden"]},d)}},842060:(e,t,i)=>{"use strict";i.d(t,{getStyleClasses:()=>r,isCircleLogoWithUrlProps:()=>d});var s=i(497754),o=i.n(s),n=i(548729),l=i(757554),a=i.n(l);function r(e,t=2,i){return o()(a().logo,a()[e],i,0===t||1===t?o()(n.skeletonTheme.wrapper,a().skeleton):a().letter,1===t&&n.skeletonTheme.animated)}function d(e){return"logoUrl"in e&&null!==e.logoUrl&&void 0!==e.logoUrl&&0!==e.logoUrl.length}},834995:(e,t,i)=>{"use strict";function s(e){const{reference:t,...i}=e;return{...i,ref:t}}i.d(t,{renameRef:()=>s})},14388:(e,t,i)=>{"use strict";i.d(t,{CustomComponentDefaultLink:()=>n});var s=i(50959),o=i(834995);function n(e){return s.createElement("a",{...(0,o.renameRef)(e)})}s.PureComponent},465201:(e,t,i)=>{"use strict";i.d(t,{CustomBehaviourContext:()=>s});const s=(0,i(50959).createContext)({enableActiveStateStyles:!0});s.displayName="CustomBehaviourContext"},169986:(e,t,i)=>{"use strict";i.d(t,{CustomBehaviourContext:()=>s.CustomBehaviourContext,presetDefault:()=>o.presetDefault,presetPlatform:()=>o.presetPlatform});var s=i(465201),o=i(741083)},741083:(e,t,i)=>{"use strict";i.d(t,{presetDefault:()=>s,presetPlatform:()=>o});const s={enableActiveStateStyles:!0},o={enableActiveStateStyles:!1}},600234:(e,t,i)=>{"use strict";i.d(t,{Dialog:()=>c});var s=i(50959),o=i(497754),n=i.n(o),l=i(692822),a=i(351290),r=i(8626),d=i(241427),u=i.n(d);class c extends s.PureComponent{constructor(){super(...arguments),this._manager=new a.OverlapManager,
this._handleSlot=e=>{this._manager.setContainer(e)}}render(){const{rounded:e=!0,shadowed:t=!0,fullscreen:i=!1,darker:o=!1,className:a,backdrop:d,containerTabIndex:c=-1}=this.props,h=n()(a,u().dialog,e&&u().rounded,t&&u().shadowed,i&&u().fullscreen,o&&u().darker),p=(0,r.filterDataProps)(this.props),_=this.props.style?{...this._createStyles(),...this.props.style}:this._createStyles();return s.createElement(s.Fragment,null,s.createElement(l.SlotContext.Provider,{value:this._manager},d&&s.createElement("div",{onClick:this.props.onClickBackdrop,className:u().backdrop}),s.createElement("div",{...p,className:h,style:_,ref:this.props.reference,onFocus:this.props.onFocus,onMouseDown:this.props.onMouseDown,onMouseUp:this.props.onMouseUp,onClick:this.props.onClick,onKeyDown:this.props.onKeyDown,tabIndex:c,"aria-label":this.props.containerAriaLabel},this.props.children)),s.createElement(l.Slot,{reference:this._handleSlot}))}_createStyles(){const{bottom:e,left:t,width:i,right:s,top:o,zIndex:n,height:l}=this.props;return{bottom:e,left:t,right:s,top:o,zIndex:n,maxWidth:i,height:l}}}},267521:(e,t,i)=>{"use strict";i.d(t,{useFunctionalRefObject:()=>n});var s=i(50959),o=i(774218);function n(e){const t=(0,s.useMemo)((()=>function(e){const t=i=>{e(i),t.current=i};return t.current=null,t}((e=>{a.current(e)}))),[]),i=(0,s.useRef)(null),n=t=>{if(null===t)return l(i.current,t),void(i.current=null);i.current!==e&&(i.current=e,l(i.current,t))},a=(0,s.useRef)(n);return a.current=n,(0,o.useIsomorphicLayoutEffect)((()=>{if(null!==t.current)return a.current(t.current),()=>a.current(null)}),[e]),t}function l(e,t){null!==e&&("function"==typeof e?e(t):e.current=t)}},640027:(e,t,i)=>{"use strict";i.d(t,{useIsMounted:()=>o});var s=i(50959);const o=()=>{const e=(0,s.useRef)(!1);return(0,s.useEffect)((()=>(e.current=!0,()=>{e.current=!1})),[]),e}},774218:(e,t,i)=>{"use strict";i.d(t,{useIsomorphicLayoutEffect:()=>o});var s=i(50959);function o(e,t){("undefined"==typeof window?s.useEffect:s.useLayoutEffect)(e,t)}},853970:(e,t,i)=>{"use strict";i.d(t,{useOutsideEvent:()=>s.useOutsideEvent});var s=i(31241)},444530:(e,t,i)=>{"use strict";i.d(t,{useResizeObserver:()=>l});var s=i(50959),o=i(774218),n=i(267521);function l(e,t=[]){const{callback:i,ref:l=null}=function(e){return"function"==typeof e?{callback:e}:e}(e),a=(0,s.useRef)(null),r=(0,s.useRef)(i);r.current=i;const d=(0,n.useFunctionalRefObject)(l),u=(0,s.useCallback)((e=>{d(e),null!==a.current&&(a.current.disconnect(),null!==e&&a.current.observe(e))}),[d,a]);return(0,o.useIsomorphicLayoutEffect)((()=>(a.current=new ResizeObserver(((e,t)=>{r.current(e,t)})),d.current&&u(d.current),()=>{a.current?.disconnect()})),[d,...t]),u}},132734:(e,t,i)=>{"use strict";i.d(t,{Icon:()=>o});var s=i(50959);const o=s.forwardRef(((e,t)=>{const{icon:i="",title:o,ariaLabel:n,ariaLabelledby:l,ariaHidden:a,...r}=e,d=!!(o||n||l);return s.createElement("span",{role:"img",...r,ref:t,"aria-label":n,"aria-labelledby":l,"aria-hidden":a||!d,title:o,dangerouslySetInnerHTML:{__html:i}})}))},79205:(e,t,i)=>{"use strict";i.d(t,{
Icon:()=>s.Icon});var s=i(132734)},265005:(e,t,i)=>{"use strict";i.d(t,{Loader:()=>s.Loader});var s=i(386290)},386290:(e,t,i)=>{"use strict";i.d(t,{Loader:()=>r});var s=i(50959),o=i(497754),n=i.n(o),l=i(649107),a=i.n(l);function r(e){const{className:t,size:i="medium",staticPosition:o,color:l="black"}=e,r=n()(a().item,a()[l],a()[i]);return s.createElement("span",{className:n()(a().loader,o&&a().static,t)},s.createElement("span",{className:r}),s.createElement("span",{className:r}),s.createElement("span",{className:r}))}},430495:(e,t,i)=>{"use strict";i.d(t,{Portal:()=>d,PortalContext:()=>u});var s=i(50959),o=i(632227),n=i(925931),l=i(351290),a=i(593110),r=i(692822);class d extends s.PureComponent{constructor(){super(...arguments),this._uuid=(0,n.nanoid)()}componentWillUnmount(){this._manager().removeWindow(this._uuid)}render(){const e=this._manager().ensureWindow(this._uuid,this.props.layerOptions);e.style.top=this.props.top||"",e.style.bottom=this.props.bottom||"",e.style.left=this.props.left||"",e.style.right=this.props.right||"",e.style.pointerEvents=this.props.pointerEvents||"";const t=this.props.className;return t&&("string"==typeof t?e.classList.add(t):e.classList.add(...t)),this.props.shouldTrapFocus&&!e.hasAttribute(a.FOCUS_TRAP_DATA_ATTRIBUTE)&&e.setAttribute(a.FOCUS_TRAP_DATA_ATTRIBUTE,"true"),this.props["aria-hidden"]&&e.setAttribute("aria-hidden","true"),o.createPortal(s.createElement(u.Provider,{value:this},this.props.children),e)}moveToTop(){this._manager().moveToTop(this._uuid)}_manager(){return null===this.context?(0,l.getRootOverlapManager)():this.context}}d.contextType=r.SlotContext;const u=s.createContext(null)},548729:(e,t,i)=>{"use strict";i.d(t,{skeletonTheme:()=>o});var s=i(116313);const o=i.n(s)()},692822:(e,t,i)=>{"use strict";i.d(t,{Slot:()=>o,SlotContext:()=>n});var s=i(50959);class o extends s.Component{shouldComponentUpdate(){return!1}render(){return s.createElement("div",{style:{position:"fixed",zIndex:150,left:0,top:0},ref:this.props.reference})}}const n=s.createContext(null)},843085:(e,t,i)=>{"use strict";i.d(t,{getTextForTooltip:()=>l});var s=i(50959);const o=e=>(0,s.isValidElement)(e)&&Boolean(e.props.children),n=(e,t=!0)=>null==e||"boolean"==typeof e||"{}"===JSON.stringify(e)?"":e.toString()+(t?" ":""),l=e=>Array.isArray(e)||(0,s.isValidElement)(e)?s.Children.toArray(e).reduce(((e,t)=>{let i="";return i=(0,s.isValidElement)(t)&&o(t)?l(t.props.children):(0,s.isValidElement)(t)&&!o(t)?"":n(t),e.concat(i)}),"").trim():n(e,!1)},551080:(e,t,i)=>{"use strict";function s(e){return t=>{e.forEach((e=>{"function"==typeof e?e(t):null!=e&&(e.current=t)}))}}function o(e){return s([e])}i.d(t,{isomorphicRef:()=>o,mergeRefs:()=>s})},351290:(e,t,i)=>{"use strict";i.d(t,{OverlapManager:()=>l,getRootOverlapManager:()=>r});var s=i(650151),o=i(593110);class n{constructor(){this._storage=[]}add(e){this._storage.push(e)}remove(e){this._storage=this._storage.filter((t=>e!==t))}has(e){return this._storage.includes(e)}getItems(){return this._storage}}class l{constructor(e=document){this._storage=new n,
this._windows=new Map,this._index=0,this._document=e,this._container=e.createDocumentFragment()}setContainer(e){const t=this._container,i=null===e?this._document.createDocumentFragment():e;!function(e,t){Array.from(e.childNodes).forEach((e=>{e.nodeType===Node.ELEMENT_NODE&&t.appendChild(e)}))}(t,i),this._container=i}registerWindow(e){this._storage.has(e)||this._storage.add(e)}ensureWindow(e,t={position:"fixed",direction:"normal"}){const i=this._windows.get(e);if(void 0!==i)return i;this.registerWindow(e);const s=this._document.createElement("div");if(s.style.position=t.position,s.style.zIndex=this._index.toString(),s.dataset.id=e,void 0!==t.index){const e=this._container.childNodes.length;if(t.index>=e)this._container.appendChild(s);else if(t.index<=0)this._container.insertBefore(s,this._container.firstChild);else{const e=this._container.childNodes[t.index];this._container.insertBefore(s,e)}}else"reverse"===t.direction?this._container.insertBefore(s,this._container.firstChild):this._container.appendChild(s);return this._windows.set(e,s),++this._index,s}unregisterWindow(e){this._storage.remove(e);const t=this._windows.get(e);void 0!==t&&(null!==t.parentElement&&t.parentElement.removeChild(t),this._windows.delete(e))}getZindex(e){const t=this.ensureWindow(e);return parseInt(t.style.zIndex||"0")}moveLastWindowToTop(){const e=this._storage.getItems(),t=e[e.length-1];t&&this.moveToTop(t)}moveToTop(e){if(this.getZindex(e)!==this._index){const t=this.ensureWindow(e);this._windows.forEach(((e,i)=>{e.hasAttribute(o.FOCUS_TRAP_DATA_ATTRIBUTE)&&e.setAttribute(o.FOCUS_TRAP_DATA_ATTRIBUTE,e===t?"true":"false")})),t.style.zIndex=(++this._index).toString()}}removeWindow(e){this.unregisterWindow(e)}}const a=new WeakMap;function r(e=document){const t=e.getElementById("overlap-manager-root");if(null!==t)return(0,s.ensureDefined)(a.get(t));{const t=new l(e),i=function(e){const t=e.createElement("div");return t.style.position="absolute",t.style.zIndex=150..toString(),t.style.top="0px",t.style.left="0px",t.id="overlap-manager-root",t.dataset.qaId="overlap-manager-root",t}(e);return a.set(i,t),t.setContainer(i),e.body.appendChild(i),t}}},631456:(e,t,i)=>{"use strict";i.r(t),i.d(t,{createReactRoot:()=>a});var s=i(50959),o=i(632227),n=i(904237),l=i(957114);function a(e,t,i="legacy"){const a=s.createElement(l.TVAppContextProvider,{renderMode:i},e);if("modern"===i){const e=(0,n.createRoot)(t);return e.render(a),{render(t){e.render(s.createElement(l.TVAppContextProvider,{renderMode:i},t))},unmount(){e.unmount()}}}return o.render(a,t),{render(e){o.render(s.createElement(l.TVAppContextProvider,{renderMode:i},e),t)},unmount(){o.unmountComponentAtNode(t)}}}},176006:(e,t,i)=>{"use strict";function s(e,t){null===e.firstChild?e.textContent=t:e.firstChild.nodeValue=t}i.d(t,{updateTextNode:()=>s})},822714:(e,t,i)=>{"use strict";i.d(t,{changeDescription:()=>h,convertToCustomSymbolList:()=>r,convertToMarkedSymbolList:()=>d,convertToSymbolList:()=>u,getAllWatchLists:()=>c});var s=i(650151),o=i(803912),n=i(77117),l=(i(341286),i(421907),i(658583));i(435712)
;if(25242==i.j)var a=i(543469);i(62802),i(125226);function r(e){const t=e.id,i=e.name,{symbols:s,collapsedSeparators:o}=(0,n.localCollapseStateFromRemoteSymbols)(e.symbols??[]);return{type:"custom",id:t,name:i,description:e.description,active:e.active,symbols:s,shared:e.shared,collapsedSeparators:o,persistedState:e,meta:{server_id:+t}}}function d(e){const t=(0,s.ensureNotNull)(e.color),{symbols:i,collapsedSeparators:o}=(0,n.localCollapseStateFromRemoteSymbols)(e.symbols??[]);return{type:"colored",id:t,color:t,name:e.name??null,description:e.description,active:e.active,symbols:i,shared:e.shared,collapsedSeparators:o,persistedState:e,meta:{server_id:+e.id}}}function u(e){return(0,a.isCustomListResponse)(e)?r(e):d(e)}function c(e){return(0,o.fetch)("/api/v1/symbols_list/all/",{signal:e}).then(l.handleJSON).then((e=>e.map(u)))}function h(e,t){return(0,o.fetch)(`/api/v1/symbols_list/custom/${e}/update_meta/`,{method:"POST",body:JSON.stringify({description:t}),headers:{"Content-Type":"application/json"}}).then(l.handleJSON).then(r)}},263361:(e,t,i)=>{"use strict";i.d(t,{useRovingTabindexElement:()=>l});var s=i(50959),o=i(267521),n=i(774218);function l(e,t=[]){const[i,l]=(0,s.useState)(!1),a=(0,o.useFunctionalRefObject)(e);return(0,n.useIsomorphicLayoutEffect)((()=>{const e=a.current;if(null===e)return;const t=e=>{switch(e.type){case"roving-tabindex:main-element":l(!0);break;case"roving-tabindex:secondary-element":l(!1)}};return e.addEventListener("roving-tabindex:main-element",t),e.addEventListener("roving-tabindex:secondary-element",t),()=>{e.removeEventListener("roving-tabindex:main-element",t),e.removeEventListener("roving-tabindex:secondary-element",t)}}),t),[a,i?0:-1]}},957114:(e,t,i)=>{"use strict";i.d(t,{TVAppContext:()=>d,TVAppContextProvider:()=>r});var s=i(50959),o=i(883522),n=i(314802),l=i(969680);const a={iOs:"old",android:"new",old:"old",new:"new",any:"any"};function r(e){const[t]=(0,s.useState)({isOnMobileAppPage:e=>(0,n.isOnMobileAppPage)(a[e]),isRtl:(0,l.isRtl)(),locale:window.locale,renderMode:e.renderMode??"legacy"});return s.createElement(o.AppContext.Provider,{value:t},e.children)}const d=o.AppContext},607546:(e,t,i)=>{"use strict";i.d(t,{getLogoUrlsHook:()=>s.getLogoUrlsHook,removeUsdFromCryptoPairLogos:()=>s.removeUsdFromCryptoPairLogos,resolveLogoUrls:()=>s.resolveLogoUrls});var s=i(526639)},439378:(e,t,i)=>{"use strict";i.d(t,{getBlockStyleClasses:()=>s.getBlockStyleClasses,getLogoStyleClasses:()=>s.getLogoStyleClasses});var s=i(115078)},526639:(e,t,i)=>{"use strict";i.d(t,{getLogoUrlsHook:()=>l,removeUsdFromCryptoPairLogos:()=>a,resolveLogoUrls:()=>n});var s=i(849204);const o=(0,s.getLogoUrlResolver)();function n(e,t=s.LogoSize.Medium){const i=e.logoid,n=e["base-currency-logoid"],l=e["currency-logoid"],a=i&&o.getSymbolLogoUrl(i,t);if(a)return[a];const r=n&&o.getSymbolLogoUrl(n,t),d=l&&o.getSymbolLogoUrl(l,t);return r&&d?[r,d]:r?[r]:d?[d]:[]}function l(e,t){let i=!1;return(s,o,l)=>{const r=s["currency-logoid"]&&s["base-currency-logoid"];if(!i&&(s.logoid||r||l)){i=!0;const o=a(n({logoid:s.logoid,
"base-currency-logoid":s["base-currency-logoid"],"currency-logoid":s["currency-logoid"]},t));e(o)}}}function a(e){return 2!==e.length?e:function(e){return e.some((e=>r(e)))}(e)&&!function(e){return e.some((e=>e.includes("country")&&!r(e)))}(e)?e.filter((e=>!r(e))):e}function r(e){return e.includes("country/US")}},783036:(e,t,i)=>{"use strict";i.d(t,{getStyleClasses:()=>s.getStyleClasses});var s=i(842060)},948019:(e,t,i)=>{"use strict";i.d(t,{ContextMenuContext:()=>s});const s=i(50959).createContext(null)},488653:(e,t,i)=>{"use strict";i.d(t,{DragHandler:()=>o});var s=i(686668);class o{constructor(e,t,i={boundByScreen:!0}){this._drag=null,this._canBeTouchClick=!1,this._frame=null,this._onMouseDragStart=e=>{if(0!==e.button||this._isTargetNoDraggable(e))return;e.preventDefault(),document.addEventListener("mousemove",this._onMouseDragMove),document.addEventListener("mouseup",this._onMouseDragEnd);const t=(0,s.clampPosition)((0,s.positionFromMouseEvent)(e));this._dragStart(t)},this._onTouchDragStart=e=>{if(this._isTargetNoDraggable(e))return;this._canBeTouchClick=!0,e.preventDefault(),this._header.addEventListener("touchmove",this._onTouchDragMove,{passive:!1});const t=(0,s.clampPosition)((0,s.positionFromTouchEvent)(e));this._dragStart(t)},this._onMouseDragEnd=e=>{e.target instanceof Node&&this._header.contains(e.target)&&e.preventDefault(),document.removeEventListener("mousemove",this._onMouseDragMove),document.removeEventListener("mouseup",this._onMouseDragEnd),this._onDragStop()},this._onTouchDragEnd=e=>{this._header.removeEventListener("touchmove",this._onTouchDragMove),this._onDragStop(),this._canBeTouchClick&&(this._canBeTouchClick=!1,(0,s.simulateClick)(e.target))},this._onMouseDragMove=e=>{const t=(0,s.clampPosition)((0,s.positionFromMouseEvent)(e));this._dragMove(t)},this._onTouchDragMove=e=>{this._canBeTouchClick=!1,e.preventDefault();const t=(0,s.clampPosition)((0,s.positionFromTouchEvent)(e));this._dragMove(t)},this._onDragStop=()=>{this._drag=null,this._header.classList.remove("dragging"),this._options.onDragEnd&&this._options.onDragEnd()},this._dialog=e,this._header=t,this._options=i,this._header.addEventListener("mousedown",this._onMouseDragStart),this._header.addEventListener("touchstart",this._onTouchDragStart),this._header.addEventListener("touchend",this._onTouchDragEnd)}destroy(){null!==this._frame&&cancelAnimationFrame(this._frame),this._header.removeEventListener("mousedown",this._onMouseDragStart),document.removeEventListener("mouseup",this._onMouseDragEnd),this._header.removeEventListener("touchstart",this._onTouchDragStart),this._header.removeEventListener("touchend",this._onTouchDragEnd),document.removeEventListener("mouseleave",this._onMouseDragEnd)}updateOptions(e){this._options=e}_dragStart(e){const t=this._dialog.getBoundingClientRect();this._drag={startX:e.x,startY:e.y,finishX:e.x,finishY:e.y,dialogX:t.left,dialogY:t.top};const i=Math.round(t.left),s=Math.round(t.top);this._dialog.style.transform=`translate(${i}px, ${s}px)`,this._header.classList.add("dragging"),
this._options.onDragStart&&this._options.onDragStart()}_dragMove(e){if(this._drag){if(this._drag.finishX=e.x,this._drag.finishY=e.y,null!==this._frame)return;this._frame=requestAnimationFrame((()=>{if(this._drag){const t=e.x-this._drag.startX,i=e.y-this._drag.startY;this._moveDialog(this._drag.dialogX+t,this._drag.dialogY+i)}this._frame=null}))}}_moveDialog(e,t){const i=this._dialog.getBoundingClientRect(),{boundByScreen:o}=this._options,n=(0,s.clampSegment)(e,i.width,o?0:-1/0,o?window.innerWidth:1/0),l=(0,s.clampSegment)(t,i.height,o?0:-1/0,o?window.innerHeight:1/0);this._dialog.style.transform=`translate(${Math.round(n)}px, ${Math.round(l)}px)`}_isTargetNoDraggable(e){return e.target instanceof Element&&null!==e.target.closest("[data-disable-drag]")}}},8629:(e,t,i)=>{"use strict";i.d(t,{PopupContext:()=>s});const s=i(50959).createContext(null)},62526:(e,t,i)=>{"use strict";i.d(t,{PopupDialog:()=>x});var s=i(50959),o=i(497754),n=i(650151),l=i(600234),a=i(368337),r=i(58407),d=i(488653),u=i(686668);const c={vertical:0};class h{constructor(e,t){this._frame=null,this._isFullscreen=!1,this._handleResize=()=>{null===this._frame&&(this._frame=requestAnimationFrame((()=>{this.recalculateBounds(),this._frame=null})))},this._dialog=e,this._guard=t.guard||c,this._calculateDialogPosition=t.calculateDialogPosition,this._initialHeight=e.style.height,window.addEventListener("resize",this._handleResize)}updateOptions(e){this._guard=e.guard||c,this._calculateDialogPosition=e.calculateDialogPosition}setFullscreen(e){this._isFullscreen!==e&&(this._isFullscreen=e,this.recalculateBounds())}centerAndFit(){const{x:e,y:t}=this.getDialogsTopLeftCoordinates(),i=this._calcAvailableHeight(),s=this._calcDialogHeight();if(i===s)if(this._calculateDialogPosition){const{left:e,top:t}=this._calculateDialogPosition(this._dialog,document.documentElement,this._guard);this._dialog.style.transform=`translate(${Math.round(e)}px, ${Math.round(t)}px)`}else this._dialog.style.height=s+"px";this._dialog.style.top="0px",this._dialog.style.left="0px",this._dialog.style.transform=`translate(${e}px, ${t}px)`}getDialogsTopLeftCoordinates(){const{clientWidth:e,clientHeight:t}=this._getClientDimensions(),i=this._calcDialogHeight(),s=e/2-this._dialog.clientWidth/2,o=t/2-i/2+this._getTopOffset();return{x:Math.round(s),y:Math.round(o)}}recalculateBounds(){const{clientWidth:e,clientHeight:t}=this._getClientDimensions(),{vertical:i}=this._guard,s=this._calculateDialogPosition?.(this._dialog,{clientWidth:e,clientHeight:t},{vertical:i});if(this._isFullscreen){if(this._dialog.style.top="0px",this._dialog.style.left="0px",this._dialog.style.width="100%",this._dialog.style.height="100%",this._dialog.style.transform="none",s){const{left:e,top:t,width:i,height:o}=s;this._dialog.style.transform=`translate(${Math.round(e)}px, ${Math.round(t)}px)`,i&&(this._dialog.style.width=`${i}px`,this._dialog.style.minWidth="unset"),o&&(this._dialog.style.height=`${o}px`,this._dialog.style.minHeight="unset")}}else if(s){const{left:e,top:t}=s
;this._dialog.style.transform=`translate(${Math.round(e)}px, ${Math.round(t)}px)`}else{this._dialog.style.width="",this._dialog.style.height="";const s=this._dialog.getBoundingClientRect(),o=t-2*i,n=(0,u.clampSegment)(s.left,s.width,0,e),l=(0,u.clampSegment)(s.top,s.height,i,t);this._dialog.style.top="0px",this._dialog.style.left="0px",this._dialog.style.transform=`translate(${Math.round(n)}px, ${Math.round(l)}px)`,this._dialog.style.height=o<s.height?o+"px":this._initialHeight}}destroy(){window.removeEventListener("resize",this._handleResize),null!==this._frame&&(cancelAnimationFrame(this._frame),this._frame=null)}_getClientDimensions(){return{clientHeight:document.documentElement.clientHeight,clientWidth:document.documentElement.clientWidth}}_getTopOffset(){return 0}_calcDialogHeight(){const e=this._calcAvailableHeight();return e<this._dialog.clientHeight?e:this._dialog.clientHeight}_calcAvailableHeight(){return this._getClientDimensions().clientHeight-2*this._guard.vertical}}var p=i(707533),_=i(8629),g=i(575658),m=i(113658),b=i(314802),v=i(991336),f=i(931924);var w=i(12173),y=i(89317),S=i(947156);const C=S["tooltip-offset"],E=f.enabled("embed_resizer_overrides")?class extends h{constructor(e,t){super(e,t),this._enabled=f.enabled("embed_resizer_overrides")}_getClientDimensions(){const e=super._getClientDimensions();if(this._enabled){const t=v.EmbedViewportDimensionsProvider.getInstance().data();t&&(e.clientHeight=t.height)}return e}_getTopOffset(){if(this._enabled){const e=v.EmbedViewportDimensionsProvider.getInstance().data();if(e)return e.top}return super._getTopOffset()}}:h;class L extends s.PureComponent{constructor(e){super(e),this._dialog=null,this._cleanUpFunctions=[],this._prevActiveElement=null,this._eventDispatcher=new m.DialogEventDispatcher,this._handleDialogRef=e=>{const{reference:t}=this.props;this._dialog=e,"function"==typeof t?t(e):null!=t&&(t.current=e)},this._handleFocus=()=>{this._moveToTop()},this._handleMouseDown=e=>{this._moveToTop()},this._handleTouchStart=e=>{this._moveToTop()},this.state={canFitTooltip:!1},this._prevActiveElement=document.activeElement}render(){return s.createElement(_.PopupContext.Provider,{value:this},s.createElement(r.OutsideEvent,{mouseDown:!0,touchStart:!0,handler:this.props.onClickOutside},(e=>s.createElement("div",{ref:e,"data-outside-boundary-for":this.props.name,onFocus:this._handleFocus,onMouseDown:this._handleMouseDown,onTouchStart:this._handleTouchStart,"data-dialog-name":this.props["data-dialog-name"],"data-tooltip-show-on-focus":"true","data-qa-id":(0,y.dataQaIds)("ui-lib-PopupDialog",this.props.dataQaId)},s.createElement(l.Dialog,{style:this._applyAnimationCSSVariables(),...this.props,reference:this._handleDialogRef,className:o(S.dialog,(0,b.isOnMobileAppPage)("any")&&!this.props.noMobileAppShadows&&S.mobile,this.props.fullscreen&&S.fullscreen,this.props.className)},this.props.dialogTooltip&&this.state.canFitTooltip&&s.createElement(w.TooltipWidget,{className:S.dialogTooltip},this.props.dialogTooltip),this.props.children)))))}componentDidMount(){
const{draggable:e,boundByScreen:t,onDragStart:i}=this.props,s=(0,n.ensureNotNull)(this._dialog);if(this._eventDispatcher.dispatch("dialog-open"),e){const e=s.querySelector("[data-dragg-area]");if(e&&e instanceof HTMLElement){const o=new d.DragHandler(s,e,{boundByScreen:Boolean(t),onDragStart:i});this._cleanUpFunctions.push((()=>o.destroy())),this._drag=o}}this.props.autofocus&&!s.contains(document.activeElement)&&s.focus(),(this._isFullScreen()||this.props.fixedBody)&&(0,g.setFixedBodyState)(!0);const{guard:o,calculateDialogPosition:l}=this.props;if(this.props.resizeHandler)this._resize=this.props.resizeHandler;else{const e=new E(s,{guard:o,calculateDialogPosition:l});this._cleanUpFunctions.push((()=>e.destroy())),this._resize=e}if(this._isFullScreen()&&this._eventDispatcher.dispatch("dialog-fullscreen-on"),this.props.isAnimationEnabled&&this.props.growPoint&&this._applyAppearanceAnimation(this.props.growPoint),this.props.centeredOnMount&&this._resize.centerAndFit(),this._resize.setFullscreen(this._isFullScreen()),this.props.dialogTooltip&&this._handleTooltipFit(),this.props.shouldForceFocus){if(this.props.onForceFocus)return void this.props.onForceFocus(s);s.focus()}if(!s.contains(document.activeElement)){const e=(0,u.findDefaultFocusableElement)(s);e instanceof HTMLElement&&e.focus()}}componentDidUpdate(e){const t=e.fullscreen;if(this._resize){const{guard:e,calculateDialogPosition:t}=this.props;this._resize.updateOptions({guard:e,calculateDialogPosition:t}),this._resize.setFullscreen(this._isFullScreen())}if(this._drag&&this._drag.updateOptions({boundByScreen:Boolean(this.props.boundByScreen),onDragStart:this.props.onDragStart}),e.fullscreen!==this.props.fullscreen){const e=this.props.fullscreen;e&&!t?this._eventDispatcher.dispatch("dialog-fullscreen-on"):!e&&t&&this._eventDispatcher.dispatch("dialog-fullscreen-off")}}componentWillUnmount(){if(this.props.shouldReturnFocus&&this._prevActiveElement&&document.body.contains(this._prevActiveElement)&&(null===document.activeElement||document.activeElement===document.body||this._dialog?.contains(document.activeElement)))try{setTimeout((()=>{this._prevActiveElement.focus({preventScroll:!0})}))}catch{}for(const e of this._cleanUpFunctions)e();(this._isFullScreen()||this.props.fixedBody)&&(0,g.setFixedBodyState)(!1),this._isFullScreen()&&this._eventDispatcher.dispatch("dialog-fullscreen-off"),this._eventDispatcher.dispatch("dialog-close")}focus(){this._dialog&&this._dialog.focus()}centerAndFit(){this._resize&&this._resize.centerAndFit()}recalculateBounds(){this._resize&&this._resize.recalculateBounds()}_moveToTop(){this.props.isZIndexFixed||null!==this.context&&this.context.moveToTop()}_applyAnimationCSSVariables(){return{"--animationTranslateStartX":null,"--animationTranslateStartY":null,"--animationTranslateEndX":null,"--animationTranslateEndY":null}}_applyAppearanceAnimation(e){if(this._resize&&this._dialog){const{x:t,y:i}=e,{x:s,y:o}=this._resize.getDialogsTopLeftCoordinates();this._dialog.style.setProperty("--animationTranslateStartX",`${t}px`),
this._dialog.style.setProperty("--animationTranslateStartY",`${i}px`),this._dialog.style.setProperty("--animationTranslateEndX",`${s}px`),this._dialog.style.setProperty("--animationTranslateEndY",`${o}px`),this._dialog.classList.add(S.dialogAnimatedAppearance)}}_handleTooltipFit(){if(this._resize){const e=this._resize.getDialogsTopLeftCoordinates().y-parseInt(C)>=0;this.setState({canFitTooltip:e})}}_isFullScreen(){return Boolean(this.props.fullscreen)}}L.contextType=p.PortalContext,L.defaultProps={boundByScreen:!0,draggable:!0,centeredOnMount:!0,shouldReturnFocus:!0};const x=(0,a.makeOverlapable)(L,!0)},686668:(e,t,i)=>{"use strict";i.d(t,{clampPosition:()=>l,clampSegment:()=>n,findDefaultFocusableElement:()=>u,positionFromMouseEvent:()=>r,positionFromTouchEvent:()=>d,simulateClick:()=>a});var s=i(462140),o=i(355734);function n(e,t,i,s){return e+t>s&&(e=s-t),e<i&&(e=i),e}function l(e){return{x:(0,s.clamp)(e.x,20,document.documentElement.clientWidth-20),y:(0,s.clamp)(e.y,20,window.innerHeight-20)}}function a(e){if(e instanceof SVGElement){const t=document.createEvent("SVGEvents");t.initEvent("click",!0,!0),e.dispatchEvent(t)}e instanceof HTMLElement&&e.click()}function r(e){return{x:e.clientX,y:e.clientY}}function d(e){return{x:e.touches[0].clientX,y:e.touches[0].clientY}}function u(e){const t=e.querySelector("[autofocus]:not([disabled])");if(t)return t;if(e.tabIndex>=0)return e;const i=(0,o.getActiveElementSelectors)(),s=Array.from(e.querySelectorAll(i)).filter((0,o.createScopedVisibleElementFilter)(e));let n=Number.NEGATIVE_INFINITY,l=null;for(let e=0;e<s.length;e++){const t=s[e],i=t.getAttribute("tabindex");if(null!==i){const e=parseInt(i,10);!isNaN(e)&&e>n&&(n=e,l=t)}}return l}},582997:(e,t,i)=>{"use strict";i.d(t,{Hint:()=>a});var s=i(50959),o=i(497754),n=i.n(o),l=i(447429);function a(e){const{text:t="",className:i}=e;return s.createElement("span",{className:n()(l.shortcut,i)},t)}},886004:(e,t,i)=>{"use strict";i.d(t,{ContextMenuItem:()=>_});var s=i(50959),o=i(497754),n=i.n(o),l=i(79205),a=i(265005),r=i(302478),d=i(582997),u=i(339750),c=i(379978),h=i(460925),p=i(405264);function _(e){const{className:t,isTitle:i,isLoading:o,isHovered:_,active:g,checkable:m,disabled:b,checked:v,icon:f,iconChecked:w,hint:y,subItems:S,label:C,styledLabel:E,onClick:L,children:x,toolbox:M,jsxLabel:A,size:k="normal"}=e,V=(0,s.useContext)(r.EmptyIconsContext),W=!!S.length;return o?s.createElement("li",{className:n()(t,p.item,p.loading,p[k])},s.createElement(a.Loader,null)):s.createElement("li",{className:n()(t,p.item,p.interactive,i&&p.title,b&&p.disabled,_&&p.hovered,g&&p.active,V&&p.emptyIcons,p[k]),onClick:L},s.createElement(l.Icon,{className:n()(p.icon),icon:function(){if(m&&v)return w||f||u;return f}()}),s.createElement("span",{className:n()(p.label)},!A&&E?E.map((({text:e,...t},i)=>s.createElement("span",{key:i,style:t},e))):A??C),!!M&&s.createElement(l.Icon,{onClick:function(){M&&M.action()},className:p.remove,icon:h}),!W&&y&&s.createElement(d.Hint,{className:p.shortcut,text:y}),W&&s.createElement(l.Icon,{className:p.nested,icon:c
}),x)}},67812:(e,t,i)=>{"use strict";i.d(t,{ContextMenuList:()=>_});var s=i(50959),o=i(868745);function n(e){return s.createElement("li",{className:o.separator})}var l=i(886004),a=i(125226),r=i(762852),d=i(224743);const u=(0,a.isFeatureEnabled)("force_disable_jsx_menu_items_rendering");function c(e){const t=u?e.action:e.action.custom()??e.action,[i,o]=(0,s.useState)((()=>t.getState())),[n,a]=(0,s.useState)(!1),c=!!i.subItems.length,h=c&&n;return(0,s.useEffect)((()=>{const e=()=>o(t.getState());return t.onUpdate().subscribe(null,e),()=>{t.onUpdate().unsubscribe(null,e)}}),[]),s.createElement(l.ContextMenuItem,{...i,onClick:function(e){if(i.disabled||e.defaultPrevented)return;if(c)return void a(!0);i.doNotCloseOnClick||(0,d.globalCloseMenu)();t.execute()},isLoading:i.loading,isHovered:h},h&&s.createElement(r.Drawer,{onClose:p},s.createElement(_,{items:i.subItems,parentAction:t,closeNested:p})));function p(e){e&&e.preventDefault(),a(!1)}}var h=i(302478),p=i(366493);function _(e){const{items:t,parentAction:i,closeNested:o}=e,a=!Boolean(i)&&t.every((e=>!Boolean("separator"!==e.type&&(e.getState().icon||e.getState().checkable))));return s.createElement(h.EmptyIconsContext.Provider,{value:a},s.createElement("ul",null,i&&s.createElement(s.Fragment,null,s.createElement(l.ContextMenuItem,{label:i.getState().label,isTitle:!0,active:!1,disabled:!1,subItems:[],checkable:!1,checked:!1,doNotCloseOnClick:!1,icon:p,onClick:o}),s.createElement(n,null)),t.map((e=>{switch(e.type){case"action":return s.createElement(c,{key:e.id,action:e});case"separator":return s.createElement(n,{key:e.id})}}))))}},302478:(e,t,i)=>{"use strict";i.d(t,{EmptyIconsContext:()=>s});const s=i(50959).createContext(!1)},332585:(e,t,i)=>{"use strict";i.d(t,{DrawerContext:()=>l,DrawerManager:()=>n});var s=i(50959),o=i(575658);class n extends s.PureComponent{constructor(e){super(e),this._isBodyFixed=!1,this._addDrawer=e=>{this.setState((t=>({stack:[...t.stack,e]})))},this._removeDrawer=e=>{this.setState((t=>({stack:t.stack.filter((t=>t!==e))})))},this.state={stack:[]}}componentDidUpdate(e,t){!t.stack.length&&this.state.stack.length&&((0,o.setFixedBodyState)(!0),this._isBodyFixed=!0),t.stack.length&&!this.state.stack.length&&this._isBodyFixed&&((0,o.setFixedBodyState)(!1),this._isBodyFixed=!1)}componentWillUnmount(){this.state.stack.length&&this._isBodyFixed&&(0,o.setFixedBodyState)(!1)}render(){return s.createElement(l.Provider,{value:{addDrawer:this._addDrawer,removeDrawer:this._removeDrawer,currentDrawer:this.state.stack.length?this.state.stack[this.state.stack.length-1]:null}},this.props.children)}}const l=s.createContext(null)},762852:(e,t,i)=>{"use strict";i.d(t,{Drawer:()=>h});var s=i(50959),o=i(650151),n=i(497754),l=i(900608),a=i(707533),r=i(332585),d=i(320116),u=i(150881),c=i(276773);function h(e){const{position:t="Bottom",onClose:i,children:u,reference:h,className:_,theme:g=c}=e,m=(0,o.ensureNotNull)((0,s.useContext)(r.DrawerContext)),[b]=(0,s.useState)((()=>(0,l.randomHash)())),v=(0,s.useRef)(null),f=(0,s.useContext)(d.CloseDelegateContext);return(0,
s.useLayoutEffect)((()=>((0,o.ensureNotNull)(v.current).focus({preventScroll:!0}),f.subscribe(m,i),m.addDrawer(b),()=>{m.removeDrawer(b),f.unsubscribe(m,i)})),[]),s.createElement(a.Portal,null,s.createElement("div",{ref:h,className:n(c.wrap,c[`position${t}`])},b===m.currentDrawer&&s.createElement("div",{className:c.backdrop,onClick:i}),s.createElement(p,{className:n(g.drawer,c[`position${t}`],_),ref:v,"data-name":e["data-name"],"data-qa-id":e["data-qa-id"]},u)))}const p=(0,s.forwardRef)(((e,t)=>{const{className:i,...o}=e;return s.createElement(u.TouchScrollContainer,{className:n(c.drawer,i),tabIndex:-1,ref:t,...o})}))},368337:(e,t,i)=>{"use strict";i.d(t,{makeOverlapable:()=>n});var s=i(50959),o=i(707533);function n(e,t){return class extends s.PureComponent{render(){const{isOpened:i,root:n}=this.props;if(!i)return null;const l=s.createElement(e,{...this.props,ref:this.props.componentRef,zIndex:150});return"parent"===n?l:s.createElement(o.Portal,{shouldTrapFocus:t},l)}}}},320116:(e,t,i)=>{"use strict";i.d(t,{CloseDelegateContext:()=>n});var s=i(50959),o=i(224743);const n=s.createContext(o.globalCloseDelegate)},707533:(e,t,i)=>{"use strict";i.d(t,{Portal:()=>s.Portal,PortalContext:()=>s.PortalContext});var s=i(430495)},670797:(e,t,i)=>{"use strict";i.d(t,{Slot:()=>s.Slot,SlotContext:()=>s.SlotContext});var s=i(692822)},12173:(e,t,i)=>{"use strict";i.d(t,{TooltipWidget:()=>u,TooltipWizard:()=>d});var s=i(50959),o=i(497754),n=i(79205),l=i(707533),a=i(333765),r=i(743970);class d extends s.PureComponent{render(){const{children:e,popperChildrenProps:t,onClose:i,reference:n,containerClassName:a,arrowClassName:d,role:c}=this.props;return s.createElement(l.Portal,null,s.createElement("div",{ref:n},s.createElement(u,{reference:t.ref,style:t.style,arrowClassName:o(r.arrowHolder,this._getArrowDirectionClass(),d),arrowReference:t.arrowProps.ref,arrowStyle:t.arrowProps.style,"data-placement":t.placement,onClose:i,containerClassName:a,role:c},e)))}_getArrowDirectionClass(){const{popperChildrenProps:e}=this.props;switch(e.placement){case"left":case"left-start":return o(r["arrowHolder--after"],r["arrowHolder--after-ltr-fix"]);case"top":return o(r["arrowHolder--above"],r["arrowHolder--above-fix"]);case"bottom":case"bottom-start":case"bottom-end":return r["arrowHolder--below"];default:return o(r["arrowHolder--before"],r["arrowHolder--before-rtl-fix"])}}}function u(e){const{className:t,containerClassName:i,contentClassName:l,reference:d,style:u,arrow:c=!0,arrowClassName:h,arrowReference:p,onClose:_,arrowStyle:g,children:m,role:b,...v}=e;return s.createElement("div",{...v,className:t,ref:d,style:u,"data-role":b},c&&s.createElement("div",{className:h,ref:p,style:g}),s.createElement("div",{className:o(r.container,i)},s.createElement("div",{className:o(r.content,l)},m),_&&s.createElement(n.Icon,{className:r.closeButton,icon:a,onClick:_})))}},934359:e=>{e.exports={}},333898:e=>{e.exports={legendActionButton:"legendActionButton-ZR5j_8g1"}},872206:e=>{e.exports={marginlegendhoriz:"4px",legend:"legend-l31H9iuA",
legend_withHiddenActions:"legend_withHiddenActions-l31H9iuA",item:"item-l31H9iuA",hideInvisibleHover:"hideInvisibleHover-l31H9iuA",button:"button-l31H9iuA",buttons:"buttons-l31H9iuA",withAction:"withAction-l31H9iuA",selected:"selected-l31H9iuA",last:"last-l31H9iuA",statusesWrapper:"statusesWrapper-l31H9iuA",statusesWrapper__statuses:"statusesWrapper__statuses-l31H9iuA",text:"text-l31H9iuA",noWrapWrapper:"noWrapWrapper-l31H9iuA",noWrap:"noWrap-l31H9iuA",series:"series-l31H9iuA",valuesAdditionalWrapper:"valuesAdditionalWrapper-l31H9iuA",valueItem:"valueItem-l31H9iuA",valueTitle:"valueTitle-l31H9iuA",valueValue:"valueValue-l31H9iuA",hideUniportantValueItems:"hideUniportantValueItems-l31H9iuA",unimportant:"unimportant-l31H9iuA",valuesWrapper:"valuesWrapper-l31H9iuA",wrappable:"wrappable-l31H9iuA",directionColumn:"directionColumn-l31H9iuA",titlesWrapper:"titlesWrapper-l31H9iuA",logoWrapper:"logoWrapper-l31H9iuA",buttonsWrapper:"buttonsWrapper-l31H9iuA",pairContainer:"pairContainer-l31H9iuA",logo:"logo-l31H9iuA",hidden:"hidden-l31H9iuA",noActions:"noActions-l31H9iuA",titlesGroupWrapper:"titlesGroupWrapper-l31H9iuA",titleWrapper:"titleWrapper-l31H9iuA",title:"title-l31H9iuA",withDot:"withDot-l31H9iuA",accessible:"accessible-l31H9iuA",disabled:"disabled-l31H9iuA",disabledOnInterval:"disabledOnInterval-l31H9iuA",withCustomTextColor:"withCustomTextColor-l31H9iuA",study:"study-l31H9iuA",mainTitle:"mainTitle-l31H9iuA",inputTitle:"inputTitle-l31H9iuA",hideValues:"hideValues-l31H9iuA",has5Buttons:"has5Buttons-l31H9iuA",stayInHoveredMode:"stayInHoveredMode-l31H9iuA",withTail:"withTail-l31H9iuA",loader:"loader-l31H9iuA",descTitle:"descTitle-l31H9iuA",intervalTitle:"intervalTitle-l31H9iuA",providerTitle:"providerTitle-l31H9iuA",exchangeTitle:"exchangeTitle-l31H9iuA",styleTitle:"styleTitle-l31H9iuA",priceSourceTitle:"priceSourceTitle-l31H9iuA",flagged:"flagged-l31H9iuA",medium:"medium-l31H9iuA",minimized:"minimized-l31H9iuA",micro:"micro-l31H9iuA",linked:"linked-l31H9iuA",onlyOneButtonCanBeStick:"onlyOneButtonCanBeStick-l31H9iuA",touchMode:"touchMode-l31H9iuA",buttonIcon:"buttonIcon-l31H9iuA",flag:"flag-l31H9iuA",eye:"eye-l31H9iuA",eyeLoading:"eyeLoading-l31H9iuA","eye-animation":"eye-animation-l31H9iuA",linking:"linking-l31H9iuA",intervalEye:"intervalEye-l31H9iuA",markerContainer:"markerContainer-l31H9iuA",flagWrapper:"flagWrapper-l31H9iuA",sourcesWrapper:"sourcesWrapper-l31H9iuA",legendMainSourceWrapper:"legendMainSourceWrapper-l31H9iuA",sources:"sources-l31H9iuA",togglerWrapper:"togglerWrapper-l31H9iuA",toggler:"toggler-l31H9iuA pane-button-e6PF69Df",onlyOneSourceShown:"onlyOneSourceShown-l31H9iuA",counter:"counter-l31H9iuA",iconArrow:"iconArrow-l31H9iuA",objectTree:"objectTree-l31H9iuA",closed:"closed-l31H9iuA",saveArrowWidth:"saveArrowWidth-l31H9iuA",objectsTreeCanBeShown:"objectsTreeCanBeShown-l31H9iuA"}},244784:e=>{e.exports={"css-value-pane-controls-padding":"4px",css_value_pane_controls_margin_top:"4",css_value_pane_controls_button_size:"22",css_value_pane_controls_button_touch_size:"22",paneControls:"paneControls-JQv8nO8e",
paneControls_hidden:"paneControls_hidden-JQv8nO8e",paneControls_forceHidden:"paneControls_forceHidden-JQv8nO8e",buttons:"buttons-JQv8nO8e",button:"button-JQv8nO8e",button_activated:"button_activated-JQv8nO8e",touchMode:"touchMode-JQv8nO8e",maximize:"maximize-JQv8nO8e",collapse:"collapse-JQv8nO8e","maximize-animation-up-bracket":"maximize-animation-up-bracket-JQv8nO8e","maximize-animation-down-bracket":"maximize-animation-down-bracket-JQv8nO8e",minimize:"minimize-JQv8nO8e",restore:"restore-JQv8nO8e","minimize-animation-up-bracket":"minimize-animation-up-bracket-JQv8nO8e","minimize-animation-down-bracket":"minimize-animation-down-bracket-JQv8nO8e",up:"up-JQv8nO8e",buttonIcon:"buttonIcon-JQv8nO8e","up-animation":"up-animation-JQv8nO8e",down:"down-JQv8nO8e","down-animation":"down-animation-JQv8nO8e"}},233465:e=>{e.exports={blockHidden:"blockHidden-e6PF69Df","pane-button":"pane-button-e6PF69Df"}},438768:(e,t,i)=>{"use strict";i.d(t,{getImage:()=>n});const s=new Map;function o(e){e.crossOrigin="anonymous"}function n(e,t,i=o){let n=s.get(e);return void 0===n&&(n=new Promise(((e,s)=>{const o=new Image;o.onload=()=>{e(o),o.onload=null,o.onerror=null},o.onerror=()=>{s(),o.onload=null,o.onerror=null},i(o),o.src=t})),s.set(e,n)),n}},432438:(e,t,i)=>{"use strict";function s(e){e.dispatchEvent(new CustomEvent("roving-tabindex:main-element"))}function o(e){e.dispatchEvent(new CustomEvent("roving-tabindex:secondary-element"))}i.d(t,{becomeMainElement:()=>s,becomeSecondaryElement:()=>o})},887208:(e,t,i)=>{"use strict";i.d(t,{mapKeyCodeToDirection:()=>d,navigationOrderComparator:()=>n,queryFocusableElements:()=>a,queryTabbableElements:()=>l,updateTabIndexes:()=>r});var s=i(969680),o=i(355734);function n(e,t){return e===t?0:e.compareDocumentPosition(t)&Node.DOCUMENT_POSITION_FOLLOWING?-1:1}function l(e){return Array.from(e.querySelectorAll('button:not([disabled]):not([aria-disabled]):not([tabindex="-1"]), [tabindex]:not([disabled]):not([aria-disabled]):not([tabindex="-1"])')).filter((0,o.createScopedVisibleElementFilter)(e))}function a(e){return Array.from(e.querySelectorAll('button:not([disabled]):not([aria-disabled="true"]):not([aria-disabled=""]), [tabindex]:not([disabled]):not([aria-disabled="true"]):not([aria-disabled=""])')).filter((0,o.createScopedVisibleElementFilter)(e))}function r(){window.dispatchEvent(new CustomEvent("keyboard-navigation-activation",{bubbles:!0}))}function d(e){const t=(0,s.isRtl)();switch(e){case 38:return"blockPrev";case 40:return"blockNext";case 37:return t?"inlineNext":"inlinePrev";case 39:return t?"inlinePrev":"inlineNext";default:return null}}},800587:(e,t,i)=>{"use strict";i.r(t),i.d(t,{ControlBarNavigation:()=>Q});var s=i(650151),o=i(444372),n=i(778785),l=i(931924),a=i(68777),r=i(941376),d=i(969680),u=i(760863),c=i(626185),h=i(604286),p=i(638456),_=i(470316),g=i(388741),m=i(345848),b=i(850775),v=i(23317),f=i(689612),w=i(577576),y=i(593724),S=i(964146),C=i(776996),E=i(678529),L=i(50119),x=i(362884),M=i(250662),A=i(542205);i(934359);const k=(0,_.humanReadableModifiers)(_.Modifiers.Alt,!1),V=(0,
_.humanReadableModifiers)(_.Modifiers.Shift,!1),W=(0,_.humanReadableModifiers)(_.Modifiers.Mod,!1),T=(0,h.hotKeySerialize)({keys:[k,"R"],text:"{0} + {1}"}),H=(0,h.hotKeySerialize)({keys:[k,"Click",k,"Enter"],text:"{0} + {1}, {2} + {3}"}),B=(0,h.hotKeySerialize)({keys:[L],text:"{0}"}),D=(0,h.hotKeySerialize)({keys:[x],text:"{0}"}),P=(0,h.hotKeySerialize)({keys:[W,M],text:"{0} + {1}"}),I=(0,h.hotKeySerialize)({keys:[W,A],text:"{0} + {1}"}),N=(0,h.hotKeySerialize)({keys:[k,V,x],text:"{0} + {1} + {2}"}),R=o.t(null,void 0,i(188710)),z=o.t(null,void 0,i(297038)),O=o.t(null,void 0,i(461206)),F=o.t(null,void 0,i(631142)),U=o.t(null,void 0,i(590761)),G=o.t(null,void 0,i(825131)),Z=o.t(null,void 0,i(575246)),q=o.t(null,void 0,i(983040)),$=`<div class="control-bar-wrapper">\n\t<div class="control-bar control-bar--hidden">\n\t\t<div class="control-bar__group js-btn-group js-btn-group-zoom">\n\t\t\t<div class="control-bar__btn control-bar__btn--zoom-out apply-common-tooltip" title="${R}" data-tooltip-hotkey="${I}">\n\t\t\t\t${v}\n\t\t\t</div>\n\t\t\t<div class="control-bar__btn control-bar__btn--zoom-in apply-common-tooltip" title="${z}" data-tooltip-hotkey="${P}">\n\t\t\t\t${w}\n\t\t\t</div>\n\t\t</div>\n\t\t<div class="control-bar__group js-btn-group js-btn-group-maximize">\n\t\t\t<div class="control-bar__btn control-bar__btn--maximize apply-common-tooltip" title="${O}" data-tooltip-hotkey="${H}">\n\t\t\t\t${S}\n\t\t\t</div>\n\t\t\t<div class="control-bar__btn control-bar__btn--minimize js-hidden apply-common-tooltip" title="${F}" data-tooltip-hotkey="${H}">\n\t\t\t\t${C}\n\t\t\t</div>\n\t\t</div>\n\t\t<div class="control-bar__group js-btn-group js-btn-group-scroll">\n\t\t\t<div class="control-bar__btn control-bar__btn--move-left apply-common-tooltip" title="${U}" data-tooltip-hotkey="${B}">\n\t\t\t\t${f}\n\t\t\t</div>\n\t\t\t<div class="control-bar__btn control-bar__btn--move-right apply-common-tooltip" title="${G}" data-tooltip-hotkey="${D}">\n\t\t\t\t${f}\n\t\t\t</div>\n\t\t</div>\n\t\t<div class="control-bar__group js-btn-group js-btn-group-reset-scale">\n\t\t\t<div class="control-bar__btn control-bar__btn--turn-button control-bar__btn--btn-hidden apply-common-tooltip js-btn-reset" title="${Z}" data-tooltip-hotkey="${T}">\n\t\t\t\t${y}\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</div>`,j=`<div class="control-bar-wrapper control-bar-wrapper--back-present">\n\t<div class="control-bar control-bar__btn control-bar__btn--btn-hidden apply-common-tooltip" title="${q}" data-tooltip-hotkey="${N}">\n\t\t${E}\n\t</div>\n</div>`,X=p.CheckMobile.any(),K="control-bar__btn--btn-hidden",J={zoomInOut:!0,maximize:!0,scrollLeftRight:!0,resetScale:!0,goToRealtime:!0};class Q{constructor(e,t,i){this._widget=(0,s.ensureNotNull)((0,u.parseHtml)($).querySelector(".control-bar-wrapper")),this._controlBar=(0,s.ensureNotNull)(this._widget.querySelector(".control-bar")),this._back=(0,s.ensureNotNull)((0,u.parseHtml)(j).querySelector(".control-bar-wrapper")),this._btnGroups=Array.from(this._controlBar.querySelectorAll(".js-btn-group")),
this._targetPaneWidget=null,this._backButtonVisible=!1,this._backButtonCanBeVisible=!1,this._boundMouseHandler=null,this._chartModel=null,this._controlBarVisible=!1,this._priceAxisChanged=null,this._resetScalesAvailable=null,this._priceAxisName="right",this._rafId=null,this._visibilityTypeProperty=null,this._boundUpdateMaximizeButtonsVisibility=this._updateMaximizeButtonsVisibility.bind(this),this._boundToggleFullscreenButtons=this._toggleFullscreenButtons.bind(this),this._paneWidth=0,this._leftPriceScaleWidth=0,this._rightPriceScaleWidth=0,this._onVisibilityTypeChange=e=>{"alwaysOn"===e||"alwaysOff"===e?(this._controlBarVisible="alwaysOn"===e,this._parent.removeEventListener("mousemove",this._controlsBarVisibilityHandler,!1),this._parent.removeEventListener("mouseleave",this._controlsBarVisibilityHandler,!1)):(this._controlBarVisible=!1,this._parent.addEventListener("mousemove",this._controlsBarVisibilityHandler),this._parent.addEventListener("mouseleave",this._controlsBarVisibilityHandler)),this._configureBackButtonVisibility(e),this._updateControlBarVisibility()},this._visibilityBackButtonHandler=e=>{const t=this._checkIsPointerNearBox(e,this._back.getBoundingClientRect());void 0!==t&&this._backButtonCanBeVisible!==t&&(this._backButtonCanBeVisible=t,this._setRAF())},this._controlsBarVisibilityHandler=e=>{const t=this._checkIsPointerNearBox(e,this._controlBar.getBoundingClientRect());void 0!==t&&this._controlBarVisible!==t&&(this._controlBarVisible=t,this._setRAF())},this._updateControlBarVisibility=()=>{this._controlBar.classList.toggle("control-bar--hidden",!this._controlBarVisible)},this._chart=e,this._parent=t,this._options=Object.assign({},J,i),this._visibilityPrioritizedGroups=this._initGroupDescriptions(),this._init(),this._initHandlers(),this.updatePosition()}destroy(){null!==this._visibilityTypeProperty&&(this._visibilityTypeProperty.destroy(),this._visibilityTypeProperty=null),null!==this._boundMouseHandler&&(this._parent.removeEventListener("mousemove",this._boundMouseHandler,!1),this._parent.removeEventListener("mouseleave",this._boundMouseHandler,!1),this._boundMouseHandler=null),null!==this._priceAxisChanged&&(this._priceAxisChanged.unsubscribe(this,this._updateBackBtnPosition),this._priceAxisChanged=null),clearInterval(this._checkIntervalId),this._resetScalesAvailable?.destroy();const e=this._chart.getResizerDetacher();e.fullscreenable.unsubscribe(this._boundUpdateMaximizeButtonsVisibility),e.fullscreen.unsubscribe(this._boundToggleFullscreenButtons),this._chart=null}updatePosition(){const e=this._targetPaneWidget=this._getTargetPaneWidget();if(null===e)return;const t=e.getElement().querySelector(".chart-markup-table .pane");if(null===t)return;this._paneWidth=e.width(),this._leftPriceScaleWidth=this._chart.getPriceAxisMaxWidthByName("left"),this._rightPriceScaleWidth=this._chart.getPriceAxisMaxWidthByName("right");const i=this._parent.getBoundingClientRect().bottom-t.getBoundingClientRect().bottom+this._bottomMargin(e);this._widget.style.bottom=`${i}px`,this._back.style.bottom=`${i}px`,
this._updateBtnGroupVisibility()}_getTargetPaneWidget(){const e=this._chart.maximizedPaneWidget();if(e)return e;const t=[...this._chart.paneWidgets()].reverse();for(const e of t)if(e.height()>=this._widget.clientHeight+28+this._bottomMargin(e))return e;return null}_bottomMargin(e){return e.containsMainSeries()?27:0}_init(){if(p.CheckMobile.any())for(const e of this._btnGroups)e.classList.add("js-hidden");this._buttons={zoomIn:this._widget.querySelector(".control-bar__btn--zoom-in"),zoomOut:this._widget.querySelector(".control-bar__btn--zoom-out"),moveLeft:this._widget.querySelector(".control-bar__btn--move-left"),moveRight:this._widget.querySelector(".control-bar__btn--move-right"),turn:this._widget.querySelector(".control-bar__btn--turn-button"),maximize:this._widget.querySelector(".control-bar__btn--maximize"),minimize:this._widget.querySelector(".control-bar__btn--minimize")},this._parent.appendChild(this._widget),this._parent.appendChild(this._back),this._priceAxisName=(0,d.isRtl)()?"left":"right",this._chart.withModel(this,(()=>{this._chartModel=this._chart.model(),this._initVisibility(),this._priceAxisChanged=this._chart.getPriceAxisWidthChangedByName(this._priceAxisName),this._priceAxisChanged.subscribe(this,this._updateBackBtnPosition),this._resetScalesAvailable=this._chartModel.model().resetScalesAvailable().spawn(),this._resetScalesAvailable.subscribe(this._updateResetScalesButtonVisibility.bind(this),{callWithLast:!0});const e=this._chart.getResizerDetacher();e.fullscreenable.subscribe(this._boundUpdateMaximizeButtonsVisibility),e.fullscreen.subscribe(this._boundToggleFullscreenButtons),this._updateMaximizeButtonsVisibility(),this._updateBackBtnPosition(),this._back.querySelector(".control-bar__btn")?.addEventListener("click",(()=>{this._chart.scrollHelper().scrollToRealtime(!0,(()=>this._checkBackButtonVisibility()))}))}))}_initHandlers(){const e=n.mobiletouch?"touchstart":"mousedown",t=n.mobiletouch?["touchend"]:["mouseup","mouseout"];this._buttons.moveLeft.addEventListener(e,(e=>{e.preventDefault(),this._chart.scrollHelper().moveByBar(1),this._trackEvent("Move Left")})),this._buttons.moveRight.addEventListener(e,(e=>{e.preventDefault(),this._chart.scrollHelper().moveByBar(-1),this._trackEvent("Move Right")}));for(const e of t)this._buttons.moveLeft.addEventListener(e,(()=>this._chart.scrollHelper().stopMove())),this._buttons.moveRight.addEventListener(e,(()=>this._chart.scrollHelper().stopMove()));this._buttons.turn.addEventListener("click",(e=>{e.preventDefault(),this._chart.GUIResetScales(),this._trackEvent("Reset to Default Settings")})),this._buttons.zoomOut.addEventListener("click",(e=>{e.preventDefault(),null!==this._chartModel&&this._chartModel.zoomOut(),this._trackEvent("Zoom Out")})),this._buttons.zoomIn.addEventListener("click",(e=>{e.preventDefault(),null!==this._chartModel&&this._chartModel.zoomIn(),this._trackEvent("Zoom In")})),this._buttons.maximize.addEventListener("click",(e=>{e.preventDefault(),this._chart.setActive(!0),this._chart.getResizerDetacher().requestFullscreen(),
this._trackEvent(" Maximize Chart")})),this._buttons.minimize.addEventListener("click",(e=>{e.preventDefault(),this._chart.getResizerDetacher().exitFullscreen(),this._trackEvent(" Restore Chart")}));const i=e=>e.addEventListener("contextmenu",(e=>e.preventDefault()));i(this._buttons.moveLeft),i(this._buttons.moveRight),i(this._buttons.turn),i(this._buttons.zoomOut),i(this._buttons.zoomIn),i(this._buttons.minimize),i(this._buttons.maximize)}_initGroupDescriptions(){return[{shouldBeHiddenOnMobile:!1,available:this._isMaximizeButtonAvailable.bind(this),className:"js-btn-group-maximize",element:this._getBtnGroup("js-btn-group-maximize"),totalWidth:50},{shouldBeHiddenOnMobile:!1,available:()=>this._options.resetScale,className:"js-btn-group-reset-scale",element:this._getBtnGroup("js-btn-group-reset-scale"),totalWidth:50},{shouldBeHiddenOnMobile:!l.enabled("show_zoom_and_move_buttons_on_touch"),available:()=>this._options.zoomInOut,className:"js-btn-group-zoom",element:this._getBtnGroup("js-btn-group-zoom"),totalWidth:86},{shouldBeHiddenOnMobile:!l.enabled("show_zoom_and_move_buttons_on_touch"),available:()=>this._options.scrollLeftRight,className:"js-btn-group-scroll",element:this._getBtnGroup("js-btn-group-scroll"),totalWidth:86}]}_checkBackButtonVisibility(){if(null===this._chartModel||!this._options.goToRealtime)return;const e=this._backButtonCanBeVisible&&this._chartModel.timeScale().rightOffset()<0;e!==this._backButtonVisible&&(this._backButtonVisible=e,this._back.querySelector(".control-bar__btn")?.classList.toggle(K,!this._backButtonVisible))}_initVisibility(){this._visibilityTypeProperty=(0,a.combine)(((e,t)=>null!==t?"alwaysOff":e),(0,c.convertPropertyToWatchedValue)((0,r.actualBehavior)()).ownership(),(0,g.getSeriesDisplayErrorWV)((0,s.ensureNotNull)(this._chartModel).mainSeries()).ownership()),this._visibilityTypeProperty.subscribe(this._onVisibilityTypeChange,{callWithLast:!0})}_configureBackButtonVisibility(e){"alwaysOff"===e?(clearInterval(this._checkIntervalId),this._checkIntervalId=void 0):this._checkIntervalId=this._checkIntervalId??setInterval((()=>this._checkBackButtonVisibility()),1e3),p.CheckMobile.any()?this._backButtonCanBeVisible="alwaysOff"!==e:"alwaysOn"===e||"alwaysOff"===e?(this._backButtonCanBeVisible="alwaysOn"===e,this._parent.removeEventListener("mousemove",this._visibilityBackButtonHandler,!1),this._parent.removeEventListener("mouseleave",this._visibilityBackButtonHandler,!1)):(this._backButtonCanBeVisible=!1,this._parent.addEventListener("mousemove",this._visibilityBackButtonHandler),this._parent.addEventListener("mouseleave",this._visibilityBackButtonHandler)),this._checkBackButtonVisibility()}_checkIsPointerNearBox(e,t){if(!(e.buttons||null!==this._chartModel&&this._chartModel.lineBeingCreated())){if("mousemove"===e.type){const i=100-(this._targetPaneWidget?this._bottomMargin(this._targetPaneWidget):0);return e.clientX>=t.left-100&&e.clientX<=t.right+100&&e.clientY>=t.top-i&&e.clientY<=t.bottom+100}return!1}}_setRAF(){
null===this._rafId&&(this._rafId=this._widget.ownerDocument.defaultView.requestAnimationFrame((()=>{this._checkBackButtonVisibility(),this._updateControlBarVisibility(),this._rafId=null})))}_updateBackBtnPosition(){if("left"===this._priceAxisName||"right"===this._priceAxisName){const e=this._chart.getPriceAxisMaxWidthByName(this._priceAxisName)+14;e&&(this._back.style.marginRight=`${e}px`)}}_updateBtnGroupVisibility(){const e=this._leftPriceScaleWidth+this._paneWidth,t=(e+this._rightPriceScaleWidth)/2;let i=2*Math.min(e-t,t-this._leftPriceScaleWidth)-50-50,s=!1;for(const e of this._visibilityPrioritizedGroups){e.enoughSpaceForGroup=!1;e.available()&&(!X||!e.shouldBeHiddenOnMobile)&&(i-=e.totalWidth,e.enoughSpaceForGroup=i>=0&&!s,s=s||!e.enoughSpaceForGroup),!e.enoughSpaceForGroup!==e.element.classList.contains("js-hidden")&&e.element.classList.toggle("js-hidden",!e.enoughSpaceForGroup)}this._updateControlBarPosition()}_getBtnGroup(e){return(0,s.ensureDefined)(this._btnGroups.find((t=>t.classList.contains(e))))}_updateControlBarPosition(){const e=this._visibilityPrioritizedGroups.reduce(((e,t)=>e+(t.enoughSpaceForGroup?t.totalWidth:0)),0),t=(this._paneWidth+this._leftPriceScaleWidth+this._rightPriceScaleWidth)/2-Math.ceil(e/2);this._widget.style.left=`${t}px`}_updateResetScalesButtonVisibility(){if(null===this._chartModel)return;const e=this._chartModel.model().resetScalesAvailable().value();this._buttons.turn.classList.toggle(K,!e)}_updateMaximizeButtonsVisibility(){this._updateBtnGroupVisibility()}_toggleFullscreenButtons(){const e=this._chart.inFullscreen();this._buttons.maximize.classList.toggle("js-hidden",e),this._buttons.minimize.classList.toggle("js-hidden",!e)}_isMaximizeButtonAvailable(){return!!this._options.maximize&&(!!this._chart.getResizerDetacher().fullscreenable.value()&&!b.mediaState.isPhoneSizeDevice())}_trackEvent(e){this._chart.onWidget()||(0,m.trackEvent)("Navigation button",e)}}},145889:(e,t,i)=>{"use strict";i.d(t,{icons:()=>o});var s=i(378338);const o=[{icon:"",label:s.t(null,void 0,i(132407))},{icon:"",label:s.t(null,void 0,i(820079))},{icon:"",label:s.t(null,void 0,i(69608))},{icon:"",label:s.t(null,void 0,i(857618))},{icon:"",label:s.t(null,void 0,i(842344))}]},981915:(e,t,i)=>{"use strict";i.r(t),i.d(t,{LegendWidget:()=>ns});var s=i(743068),o=i(920057),n=i(650151),l=i(68777),a=i(547465),r=i(820028),d=i(536794),u=i(724377),c=i(591800),h=i(940194),p=i(931924),_=i(638456),g=i(176006),m=i(432438),b=i(887208),v=i(479443),f=i(673747),w=i(206402),y=i(995683),S=i(696107),C=i(312520);const E=v.trackingModeIsAvailable?44:28;var L=i(158942),x=i(127785),M=i(196726),A=i(390251),k=i(184277),V=i(130551),W=i(534328),T=i(444372),H=i(418450),B=i(345848);function D(e){(0,B.trackEvent)("GUI","Legend action",e)}var P=i(969680),I=i(816433);function N(e){return(0,V.isObject)(e)&&"items"in e}function R(e){return void 0!==e?W.resetTransparency(e):e}function z(e){return e.hasOwnProperty("touches")}
const O=new H.TranslatedString("show {title}",T.t(null,void 0,i(351382))),F=new H.TranslatedString("hide {title}",T.t(null,void 0,i(713017))),U=T.t(null,void 0,i(698334)),G=T.t(null,void 0,i(327298));class Z{constructor(e,t,i,s,o){this._titles=new A.WatchedObject([]),this._values=new r.WatchedValue([]),this._actions=[],this._loading=new r.WatchedValue(!1),this._symbolLogoViewModel=new r.WatchedValue(null),this._destroyed=!1,this._moreActionCM=null,this._updateLoadingStatus=()=>{this._loading.setValue(this._source.isLoading())},this._model=e,this._source=t,this._options=i,this._callbacks=s,this._contextMenuOptions=o,this._disabled=new r.WatchedValue(this._getDisabledState()),this._disabledOnInterval=new r.WatchedValue(this._getDisabledOnIntervalState()),this._selected=new r.WatchedValue(!1),this._isTitleHidden=new r.WatchedValue(this._getTitleHiddenValue()),this._isValuesHidden=new r.WatchedValue(this._getValuesHiddenValue()),this._isRowHidden=new r.WatchedValue(this._getRowHiddenValue()),this._isEditable=new r.WatchedValue(this._getIsEditable()),(0,l.combine)(((e,t,i)=>({})),this._isTitleHidden.weakReference(),this._isValuesHidden.weakReference(),this._disabled.weakReference()).subscribe(this._updateRowVisibilities.bind(this)),this._values.subscribe((()=>{this._isValuesHidden.setValue(this._getValuesHiddenValue())}))}destroy(){this._symbolLogoViewModel.value()?.destroy(),this._destroyed=!0}titles(){return this._titles.readonly()}values(){return this._values.readonly()}actions(){return this._actions}disabled(){return this._disabled.readonly()}disabledOnInterval(){return this._disabledOnInterval.readonly()}selected(){return this._selected.readonly()}loading(){return this._loading.readonly()}isTitleHidden(){return this._isTitleHidden.readonly()}isRowHidden(){return this._isRowHidden.readonly()}isEditable(){return this._isEditable.readonly()}symbolLogoViewModel(){return this._symbolLogoViewModel}update(){this._updateTitles(),this._updateValues(),this._updateStates(),this.symbolLogoViewModel()?.value()?.update()}onToggleDisabled(){const e=this._source.properties().childs().visible,t=!e.value();this._model.setProperty(e,t,(t?O:F).format({title:new H.TranslatedString(this._source.name(),this._source.title(I.TitleDisplayTarget.StatusLine))})),D((t?"Show":"Hide")+" source")}onShowSettings(e){this._source.userEditEnabled()&&(this.setSourceSelected(),this._callbacks.showChartPropertiesForSource(this._source,e),D("Settings for source"))}onShowMoreActions(e){return this._options.readOnlyMode?Promise.resolve(null):(D("Show source context menu"),this._callbacks.showContextMenuForSources([this._source],this._calcNewPosition(e),{...this._contextMenuOptions,isKeyboardEvent:!z(e)&&(0,k.isKeyboardClick)(e)},{origin:"LegendPropertiesContextMenu"}))}setSourceSelected(){this._model.selectionMacro((e=>{e.clearSelection(),e.addSourceToSelection(this._source)}))}_moreActionHandler(e){e.preventDefault(),null!==this._moreActionCM&&this._moreActionCM.isShown()?this._moreActionCM=null:(this.setSourceSelected(),this.onShowMoreActions(e).then((e=>{
this._moreActionCM=e})))}_updateStates(){this._disabled.setValue(this._getDisabledState()),this._disabledOnInterval.setValue(this._getDisabledOnIntervalState()),this._selected.setValue(this._model.selection().isSelected(this._source)),this._isEditable.setValue(this._getIsEditable()),this._updateLoadingStatus()}_hasValues(){return this._values.value().length>0}_getEyeTitle(){return this._disabled.value()?U:G}_getIsEditable(){return this._source.userEditEnabled()}_getDisabledState(){return!this._source.properties().visible.value()}_updateRowVisibilities(){this._isRowHidden.setValue(this._getRowHiddenValue())}_getRowHiddenValue(){return this._options.readOnlyMode&&this._disabled.value()||this._isTitleHidden.value()&&(this._isValuesHidden.value()||this._disabled.value())}_calcNewPosition(e){let t={};if(z(e)&&e.touches.length>0)t={clientX:e.touches[0].clientX,clientY:e.touches[0].clientY};else if(null!==e.target){const i=e.target.getBoundingClientRect();t={clientX:(0,P.isRtl)()?i.right:i.left,clientY:i.top+i.height+3}}else{const i=e;t={clientX:i.clientX,clientY:i.clientY}}return t}}var q=i(265005),$=i(904237),j=i(50959),X=i(233465);const K=(J=q.Loader,Q={staticPosition:!0,size:"small"},(e,t)=>function(e,t,i,s){const o=document.createElement("span"),n=(0,$.createRoot)(o);a(!1);const{className:l}=s??{};return l&&o.classList.add(l),n.render((0,j.createElement)(t,i)),e&&r(e),{toggleVisibility:a,destroy:function(){n.unmount()},mountTo:r};function a(e){o.classList.toggle(X.blockHidden,!e)}function r(e){e.appendChild(o)}}(e,J,Q,t));var J,Q,Y=i(650279),ee=i(497754),te=i.n(ee),ie=i(439378),se=i(783036),oe=i(494966),ne=i(438768),le=i(495217),ae=i(872206);class re{constructor(e){this._lastDrawnLogos=[],this._logoWrapper=null,this._pairContainer=null,this._primaryLogo=null,this._secondaryLogo=null,this._logoContainer=null,this._symbolLetterContainer=null,this._updateLogoVisibility=e=>{this._logoWrapper&&this._logoWrapper.classList.toggle(ae.hidden,!e)},this._updateSymbolLogo=async e=>{if(null===this._logoWrapper&&this._renderSymbolLogo(),0!==this._lastDrawnLogos.length&&0!==e.length&&(0,Y.default)(this._lastDrawnLogos,e))return;const t=await(i=e,Promise.all(i.map((e=>(0,ne.getImage)(`symbol_logo_${e}`,e,ue).then((e=>e.cloneNode())))))).catch((()=>[]));var i;switch(t.length){case 0:this._pairContainer?.classList.add(ae.hidden),this._logoContainer?.classList.add(le.hiddenCircleLogoClass),this._updateSymbolLetter(),this._symbolLetterContainer?.classList.remove(le.hiddenCircleLogoClass),this._lastDrawnLogos=e;break;case 1:de(this._logoContainer,t[0]),this._pairContainer?.classList.add(ae.hidden),this._logoContainer?.classList.remove(le.hiddenCircleLogoClass),this._symbolLetterContainer?.classList.add(le.hiddenCircleLogoClass),this._lastDrawnLogos=e;break;case 2:de(this._primaryLogo,t[0]),de(this._secondaryLogo,t[1]),this._pairContainer?.classList.remove(ae.hidden),this._logoContainer?.classList.add(le.hiddenCircleLogoClass),this._symbolLetterContainer?.classList.add(le.hiddenCircleLogoClass),this._lastDrawnLogos=e}},this._model=e,
this._renderSymbolLogo(),this._logoUrls=e.symbolLogoUrls().spawn(),this._logoUrls.subscribe(this._updateSymbolLogo,{callWithLast:!0}),this._isLogoVisible=e.isSymbolLogoVisible().spawn(),this._isLogoVisible.subscribe(this._updateLogoVisibility,{callWithLast:!0})}destroy(){this._logoWrapper?.remove(),this._logoWrapper=null,this._pairContainer=null,this._primaryLogo=null,this._secondaryLogo=null,this._logoContainer=null,this._symbolLetterContainer=null,this._logoUrls.destroy(),this._isLogoVisible.destroy()}getElement(){return this._logoWrapper}_renderSymbolLogo(){if(!this._logoWrapper){const e=this._logoWrapper=document.createElement("div");e.classList.add(ae.logoWrapper);const t=this._pairContainer=e.appendChild(document.createElement("span"));t.classList.add(ae.pairContainer,ae.hidden);const i=t.appendChild(document.createElement("span"));i.className=(0,ie.getBlockStyleClasses)("xxxsmall");(this._secondaryLogo=i.appendChild(document.createElement("span"))).className=te()((0,ie.getLogoStyleClasses)("xxxsmall"),ae.logo);(this._primaryLogo=i.appendChild(document.createElement("span"))).className=te()((0,ie.getLogoStyleClasses)("xxxsmall"),ae.logo);(this._logoContainer=e.appendChild(document.createElement("span"))).className=te()((0,se.getStyleClasses)("xxxsmall"),ae.logo,le.hiddenCircleLogoClass);(this._symbolLetterContainer=e.appendChild(document.createElement("span"))).className=te()((0,se.getStyleClasses)("xxxsmall"),ae.logo),this._updateSymbolLetter()}}_updateSymbolLetter(){if(this._symbolLetterContainer){const e=(0,oe.safeShortName)(this._model.symbol()??"")[0];(0,g.updateTextNode)(this._symbolLetterContainer,e)}}}function de(e,t){e&&e.replaceChildren(t)}function ue(e){e.crossOrigin="",e.decoding="async"}const ce=_.CheckMobile.any();function he(e,t){e.dataset.status=t?"loading":void 0}const pe=(0,y.mergeThemes)(S.DEFAULT_STATUS_RENDERER_THEME,{statusesWrap:ae.statusesWrapper__statuses});class _e{constructor(e,t,i){this._el=null,this._firstBlockWrapper=null,this._titlesWrapperEl=null,this._titleContainers=[],this._titleElements=[],this._valuesElements=[],this._actionsParentEl=null,this._actionAdditionalWrapperEl=null,this._actionElements=[],this._accessibleTitleButtons=[],this._accessibleActionButtons=[],this._rowMode=4,this._titlesMode=3,this._statusesWrapper=null,this._statusesWidgetState=null,this._loader=null,this._valuesParentEl=null,this._valuesAdditionalWrapperEl=null,this._symbolLogoRenderer=null,this._resizeObserver=null,this._hideInvisibleHover=null,this._hideValues=null,this._allButtonsWidth=null,this._lastStatusesWrapperWidth=null,this._lastActionsWrapperWidth=null,this._showActionsHandler=null,this._hideActionsHandler=null,this._selectedSourceHandler=null,this._mouseEventHandlers=[],this._disableTimeout=null,this._toggleHiddenActions=null,this._updateDisabledState=(e=this._disabled.value())=>{null!==this._el&&(this._el.classList.toggle(ae.disabled,e),this._updateLoadingState(),this._updateStatusWidgetVisibility(e),this._updateTitleMaxWidth())},this._updateLoadingState=(e=this._loading.value())=>{
if(null!==this._el){this._el.classList.toggle(ae.eyeLoading,e&&!this._disabled.value()),he(this._el,e)}null!==this._loader&&this._loader.toggleVisibility(e),this._updateShowValues()},this._updateSymbolLogoRenderer=e=>{if(this._symbolLogoRenderer?.destroy(),e){this._symbolLogoRenderer=new re(e);const t=this._titlesStatesSpawn.value().findIndex((e=>this._isTitleWithSymbolLogo(e)));if(-1!==t){const e=this._titleContainers[t];if(e){const t=this._symbolLogoRenderer.getElement();t&&e.insertBefore(t,e.firstChild)}}}else this._symbolLogoRenderer=null},this._model=e,this._parentEl=t,this._disabled=this._model.disabled().spawn(),this._disabled.subscribe(this._updateDisabledState),this._disabledOnInterval=this._model.disabledOnInterval().spawn(),this._disabledOnInterval.subscribe(this._updateDisabledOnIntervalState.bind(this)),this._selected=this._model.selected().spawn(),this._selected.subscribe(this._updateSelectedState.bind(this)),this._loading=this._model.loading().spawn(),this._loading.subscribe(function(e,t){let i=0;return s=>{clearTimeout(i),s?e():i=setTimeout(e,t)}}(this._updateLoadingState,700)),this._isTitleHidden=this._model.isTitleHidden().spawn(),this._isRowHidden=this._model.isRowHidden().spawn(),this._isTitleHidden.subscribe(this._updateShowTitles.bind(this)),this._isRowHidden.subscribe(this._updateShowLine.bind(this)),this._titlesStatesSpawn=this._model.titles().spawn(),this._titlesStatesSpawn.subscribe(this._titlesCollectionChanged.bind(this)),this._values=this._model.values().spawn(),this._values.subscribe(this._updateValues.bind(this)),this._createValuesSpawns(),this._addValuesSpawnsSubscriptions(),e.symbolLogoViewModel().subscribe(this._updateSymbolLogoRenderer),this._updateSymbolLogoRenderer(e.symbolLogoViewModel().value()),this._actionsSpawnArray=this._model.actions().map((e=>({visible:e.visible.spawn(),title:void 0===e.title?null:e.title.spawn()})));for(let e=0;e<this._actionsSpawnArray.length;e++){this._actionsSpawnArray[e].visible.subscribe(this._updateActionVisibilities.bind(this,e));const t=this._actionsSpawnArray[e].title;null!==t&&t.subscribe(this._updateActionTitle.bind(this,e))}this._withActions=i.withActions,this._isMultipleLayout=i.isMultipleLayout.spawn(),this._customTextColor=i.customTextColor.spawn(),this._customTextColor.subscribe(this._updateCustomTextColor.bind(this)),this._render(),this._updateStates(),this._updateShowTitles(),this._updateShowValues(),this._updateShowLine(),this._loader=K((0,n.ensureNotNull)(this._valuesParentEl),{className:ae.loader}),this._withActions&&(this._toggleHiddenActions=i.toggleHiddenActions,this._showActionsHandler=(0,M.wrapHandlerWithPreventEvent)(this._showActions.bind(this)),this._hideActionsHandler=(0,M.wrapHandlerWithPreventEvent)(this._hideActions.bind(this)),this._selectedSourceHandler=(0,C.defaultPreventedHandler)(this._model.setSourceSelected.bind(this._model)),null!==this._titlesWrapperEl&&(ce||(this._titlesWrapperEl.addEventListener("mouseenter",this._showActionsHandler),this._titlesWrapperEl.addEventListener("mouseleave",this._hideActionsHandler)),
this._mouseEventHandlers.push(new C.MouseEventHandler(this._titlesWrapperEl,{mouseDoubleClickEvent:this._model.onShowSettings.bind(this._model),doubleTapEvent:this._model.onShowSettings.bind(this._model),mouseClickEvent:this._selectedSourceHandler,tapEvent:this._selectedSourceHandler}))),null===this._actionAdditionalWrapperEl||null===this._actionsParentEl||ce||(this._actionAdditionalWrapperEl.addEventListener("mouseenter",this._showActionsHandler),this._actionAdditionalWrapperEl.addEventListener("mouseleave",this._hideActionsHandler),this._actionsParentEl.addEventListener("contextmenu",(e=>{e.preventDefault(),e.stopPropagation()}))))}destroy(){if(this._toggleHiddenActions=null,this._disabled.destroy(),this._disabledOnInterval.destroy(),this._selected.destroy(),this._loading.destroy(),this._isTitleHidden.destroy(),this._isRowHidden.destroy(),this._customTextColor.destroy(),this._loader?.destroy(),this._isMultipleLayout.destroy(),this._model.symbolLogoViewModel().unsubscribe(this._updateSymbolLogoRenderer),this._symbolLogoRenderer?.destroy(),null!==this._disableTimeout&&clearTimeout(this._disableTimeout),this._accessibleTitleButtons=[],this._accessibleActionButtons=[],this._statusesWidgetDestroy?.(),this._titlesStatesSpawn.destroy(),null!==this._titlesWrapperEl){for(const e of this._mouseEventHandlers)e.destroy();this._titleContainers=[],this._titleElements=[],this._withActions&&null!==this._selectedSourceHandler&&null!==this._showActionsHandler&&null!==this._hideActionsHandler&&(ce||(this._titlesWrapperEl.removeEventListener("mouseenter",this._showActionsHandler),this._titlesWrapperEl.removeEventListener("mouseleave",this._hideActionsHandler))),this._titlesWrapperEl=null}for(const e of this._actionsSpawnArray){e.visible.destroy();const t=e.title;null!==t&&t.destroy()}if(this._actionElements=[],null!==this._actionAdditionalWrapperEl&&(this._withActions&&null!==this._showActionsHandler&&null!==this._hideActionsHandler&&!ce&&(this._actionAdditionalWrapperEl.removeEventListener("mouseenter",this._showActionsHandler),this._actionAdditionalWrapperEl.removeEventListener("mouseleave",this._hideActionsHandler)),this._actionAdditionalWrapperEl=null),this._actionsParentEl=null,this._removeValuesSpawnsSubscriptions(),this._values.destroy(),null!==this._valuesParentEl&&(this._valuesElements=[],this._valuesParentEl=null),this._hideInvisibleHover?.destroy(),this._hideValues?.destroy(),null!==this._resizeObserver&&(this._resizeObserver.disconnect(),this._resizeObserver=null),null!==this._el){const e=this._el.parentNode;e?.removeChild(this._el),this._el=null}}getElement(){return this._el}getHeight(){return null===this._el?null:24}updateMode(e,t){this._rowMode===e&&this._titlesMode===t&&null!==this._allButtonsWidth||(this._rowMode!==e&&(this._rowMode=e,this._updateActionsVisibilitiesByMode()),this._titlesMode!==t&&(this._titlesMode=t,this._updateTitlesVisibilitiesByMode()),this._updateAllButtonsWidth())}accessibleButtons(){
return this._isRowHidden.value()?[]:[...this._accessibleTitleButtons,...this._accessibleActionButtons].filter((e=>!e.classList.contains(X.blockHidden)))}showActions(){null===this._el||this._el.classList.contains(ae.withAction)||this._showActions()}hideActions(){null!==this._el&&this._el.classList.contains(ae.withAction)&&this._hideActions()}_updateActionsVisibilitiesByMode(){}_updateTitlesVisibilitiesByMode(){}_render(){this._renderTitles(),this._renderActions(),this._renderValues();const e=this._customTextColor.value()||"";this._el=document.createElement("div"),this._el.classList.toggle(ae.withCustomTextColor,Boolean(e)),he(this._el,this._loading.value()),this._firstBlockWrapper=document.createElement("div"),this._firstBlockWrapper.classList.add(ae.noWrapWrapper),this._firstBlockWrapper.appendChild((0,n.ensureNotNull)(this._titlesWrapperEl)),null!==this._actionsParentEl&&this._firstBlockWrapper.appendChild(this._actionsParentEl),this._el.appendChild(this._firstBlockWrapper),this._el.appendChild((0,n.ensureNotNull)(this._valuesParentEl)),this._parentEl.append(this._el)}_renderTitles(){null===this._titlesWrapperEl&&(this._titlesWrapperEl=document.createElement("div"),this._titlesWrapperEl.classList.add(ae.titlesWrapper));for(const e of this._titlesStatesSpawn.value())N(e)?this._renderTitlesGroup(e):this._renderSimpleTitle(e)}_renderTitlesGroup(e){const t=document.createElement("div");t.classList.add(ae.titlesGroupWrapper),e.items.forEach((e=>this._renderSimpleTitle(e,t))),(0,n.ensureNotNull)(this._titlesWrapperEl).appendChild(t)}_renderSimpleTitle(e,t){const{title:i,tooltip:s,onClick:o}=e,l=o,a=this._getAttributesForTitleState(e),r=i??"",d=this._customTextColor.value()||"",u=document.createElement("div");u.classList.add(ae.titleWrapper,ae.withDot),u.style.color=d,a?.className&&u.classList.add(a.className),a?.titleId&&(u.dataset.name=a.titleId),void 0!==s&&(u.classList.add("apply-common-tooltip"),u.setAttribute("title",s));const c=document.createElement(l?"button":"div");if(c.classList.add(ae.title),void 0!==o){u.classList.add(ae.withAction);const e=e=>{this._selectedSourceHandler?.(e),o(),l&&c.blur()};this._mouseEventHandlers.push(new C.MouseEventHandler(u,{mouseClickEvent:e,tapEvent:_.CheckMobile.any()?void 0:e},{ignoreClickAndTapOnDblClickOrDblTap:!0}))}if(l){const e=c;this._makeItemAccessible(e,o,s??""),this._accessibleTitleButtons.push(e)}if(r.length>0?c.appendChild(document.createTextNode(r)):(u.classList.add(X.blockHidden),c.classList.add(X.blockHidden)),u.appendChild(c),this._isTitleWithSymbolLogo(e)){const e=this._symbolLogoRenderer?.getElement();e&&u.insertBefore(e,u.firstChild)}(t??(0,n.ensureNotNull)(this._titlesWrapperEl)).appendChild(u),this._titleContainers.push(u),this._titleElements.push(c)}_makeItemAccessible(e,t,i){""!==i&&e.setAttribute("aria-label",i),e.type="button",e.classList.add(ae.accessible),e.tabIndex=-1;const s=t=>{switch(t.type){case"roving-tabindex:main-element":e.tabIndex=0;break;case"roving-tabindex:secondary-element":e.tabIndex=-1}};e.addEventListener("roving-tabindex:main-element",s),
e.addEventListener("roving-tabindex:secondary-element",s),e.addEventListener("keydown",(e=>{const i=(0,c.hashFromEvent)(e);13!==i&&32!==i||(e.preventDefault(),t(e))}))}_renderActions(){if(!this._withActions)return;null===this._actionsParentEl&&(this._actionsParentEl=document.createElement("div"),this._actionsParentEl.classList.add(ae.buttonsWrapper),this._actionsParentEl.dataset.name="actions",this._parentEl.append(this._actionsParentEl),this._actionAdditionalWrapperEl=document.createElement("div"),this._actionAdditionalWrapperEl.classList.add(ae.buttons),this._actionsParentEl.appendChild(this._actionAdditionalWrapperEl));const e=(0,n.ensureNotNull)(this._actionAdditionalWrapperEl);this._model.actions().forEach((t=>{const i=void 0===t.disableAccessibility,s={iconSize:v.trackingModeIsAvailable?"large":"small",tag:i?"button":"div",buttonClassName:ae.button,wrapIconClassName:ae.buttonIcon,hiddenClassName:X.blockHidden,blurOnClick:!!i||void 0},o=(0,x.createActionElement)(t,s);if(i){const e=o;this._makeItemAccessible(e,(e=>{t.action(e)}),t.title?.value()??""),this._accessibleActionButtons.push(e)}this._actionElements.push(o),e.appendChild(o)}))}_initWrappersIfNotInitialized(){return null===this._valuesParentEl&&(this._valuesParentEl=document.createElement("div"),this._valuesParentEl.classList.add(ae.valuesWrapper),this._valuesAdditionalWrapperEl=document.createElement("div"),this._valuesAdditionalWrapperEl.classList.add(ae.valuesAdditionalWrapper),this._valuesParentEl.appendChild(this._valuesAdditionalWrapperEl)),(0,n.ensureNotNull)(this._valuesAdditionalWrapperEl)}_isWidthButtonsMode(){return null!==this._el&&(this._el.classList.contains(ae.withAction)||this._disabled.value()||this._selected.value())}_isTitleHiddenByMode(e){return!1}_updateStates(e){this._updateDisabledState(),this._updateDisabledOnIntervalState(),this._updateSelectedState(),this._updateLoadingState(),e&&this._clearDisableState()}_updateValuesHTMLElHandler(e,t){const i=(0,n.ensure)(this._valuesElements[e].value);(0,g.updateTextNode)(i,t),this._updateShowValues()}_updateValueColorHandler(e,t=""){(0,n.ensure)(this._valuesElements[e].value).style.color=t}_updateValueVisibleHandler(e,t){const i=(0,n.ensure)(this._valuesElements[e].value).closest(`.${ae.valueItem}`);null!==i&&i.classList.toggle(X.blockHidden,!t),this._updateShowValues()}_updateShowLine(){null!==this._el&&this._el.classList.toggle(X.blockHidden,this._isRowHidden.value())}_titlesCollectionChanged(){null!==this._titlesWrapperEl&&(this._titlesWrapperEl.innerHTML=""),this._accessibleTitleButtons=[],this._titleContainers=[],this._titleElements=[],this._renderTitles(),this._updateTitlesVisibilitiesByMode()}_createValuesSpawns(){this._valuesSpawnArray=this._values.value().map((e=>({value:e.value.spawn(),color:e.color.spawn(),visible:e.visible.spawn(),title:e.title.spawn()})))}_removeValuesSpawnsSubscriptions(){for(const e of this._valuesSpawnArray)e.value.destroy(),e.color.destroy(),e.visible.destroy(),e.title.destroy();this._valuesSpawnArray=[]}_addValuesSpawnsSubscriptions(){
for(let e=0;e<this._valuesSpawnArray.length;e++){const t=this._valuesSpawnArray[e];t.value.subscribe(this._updateValuesHTMLElHandler.bind(this,e)),t.color.subscribe(this._updateValueColorHandler.bind(this,e)),t.visible.subscribe(this._updateValueVisibleHandler.bind(this,e)),t.title.subscribe(this._updateValuesTitleHTMLElHandler.bind(this,e))}}_updateShowValues(){function e(e){if(!e)return;const t=Array.from(e.children).every((e=>e.classList.contains(X.blockHidden)));e.classList.toggle(X.blockHidden,t)}e(this._valuesAdditionalWrapperEl),e(this._valuesParentEl)}_addStatusesWidget(e){this._hideInvisibleHover=e.visibility().spawn(),this._hideInvisibleHover.subscribe(this._updateHideInvisibleHoverMode.bind(this),{callWithLast:!0}),this._hideValues=(0,l.combine)(((e,t)=>e||t),e.dataSourceErrorStatusShown.weakReference(),e.isSymbolInvalidStatusShown.weakReference()),this._hideValues.subscribe(this._updateHideValuesMode.bind(this),{callWithLast:!0}),this._statusesWrapper=document.createElement("div"),this._statusesWrapper.classList.add(ae.statusesWrapper),this._statusesWidgetState=e,this._disabled.value()?this._statusesWidgetDestroy=(0,w.statusesPillRenderer)({container:this._statusesWrapper,statuses:e.visibleModels(),tooltip:e.tooltip(),theme:pe}):(this._statusesWidgetDestroy?.(),this._statusesWidgetDestroy=void 0),(0,n.ensureNotNull)(this._firstBlockWrapper).appendChild(this._statusesWrapper),this._updateStatusWidgetVisibility(this._disabled.value()),this._resizeObserver=new ResizeObserver(this._handlerRestrictTitleWidth.bind(this)),null!==this._actionsParentEl&&this._resizeObserver.observe(this._actionsParentEl),this._resizeObserver.observe(this._statusesWrapper)}_updateTitleMaxWidth(){if(null===this._firstBlockWrapper)return;const e=this._allButtonsWidth||0,t=(this._lastActionsWrapperWidth||0)+(this._lastStatusesWrapperWidth||0);this._isWidthButtonsMode()?this._firstBlockWrapper.style.maxWidth=`calc(100% - ${Math.max(e,t)}px)`:this._firstBlockWrapper.style.maxWidth=t>0?`calc(100% - ${t}px)`:""}_updateAllButtonsWidth(){this._allButtonsWidth=this._getButtonsCount()*E+1,this._updateTitleMaxWidth()}_updateHideInvisibleHoverMode(e){null!==this._el&&this._el.classList.toggle(ae.hideInvisibleHover,e)}_updateHideValuesMode(e){null!==this._el&&this._el.classList.toggle(ae.hideValues,e)}_showActions(){if(null===this._el||!this._withActions)return;this._el.classList.add(ae.withAction),this._toggleHiddenActions?.(!0);const e=this._valuesParentEl?.offsetTop===this._titlesWrapperEl?.offsetTop;this._el.classList.toggle(ae.withTail,e),this._updateTitleMaxWidth()}_hideActions(){null!==this._el&&this._withActions&&(this._el.classList.remove(ae.withAction),this._toggleHiddenActions?.(!1),null!==this._valuesParentEl&&this._valuesParentEl.classList.remove(ae.withTail),this._updateTitleMaxWidth())}_handlerRestrictTitleWidth(e){if(null===this._actionsParentEl||null===this._firstBlockWrapper)return;let t=null,i=null;for(const s of e)s.target===this._statusesWrapper&&(t=s.contentRect.width),
s.target===this._actionsParentEl&&(i=s.contentRect.width);t===this._lastStatusesWrapperWidth&&i===this._lastActionsWrapperWidth||(null!==t&&(this._lastStatusesWrapperWidth=t),null!==i&&(this._lastActionsWrapperWidth=i),this._updateTitleMaxWidth())}_clearDisableState(){null!==this._el&&(this._el.classList.remove(ae.eyeLoading),this._el.classList.remove(ae.disabled),this._updateStatusWidgetVisibility(this._disabled.value()),this._updateTitleMaxWidth())}_updateDisabledOnIntervalState(){this._el?.classList.toggle(ae.disabledOnInterval,this._disabledOnInterval.value())}_updateSelectedState(){null!==this._el&&this._withActions&&this._el.classList.toggle(ae.selected,this._selected.value())}_updateShowTitles(){null!==this._titlesWrapperEl&&(this._titlesWrapperEl.classList.toggle(X.blockHidden,this._isTitleHidden.value()),null!==this._actionsParentEl&&this._actionsParentEl.classList.toggle(X.blockHidden,this._isTitleHidden.value()))}_updateValues(){this._removeValuesSpawnsSubscriptions(),this._createValuesSpawns(),null!==this._valuesParentEl&&null!==this._valuesAdditionalWrapperEl&&(this._valuesElements=[],this._valuesAdditionalWrapperEl.innerHTML=""),this._renderValues(),this._addValuesSpawnsSubscriptions(),this._updateShowValues()}_updateActionVisibilities(e){null!==this._actionsParentEl&&this._actionsParentEl.querySelectorAll(`.${ae.button}`)[e].classList.toggle(X.blockHidden,!this._actionsSpawnArray[e].visible.value())}_updateActionTitle(e){const t=this._actionsSpawnArray[e].title;if(null===this._actionsParentEl||null===t)return;const i=this._actionsParentEl.querySelectorAll(`.${ae.button}`)[e];i.setAttribute("title",t.value()),i.hasAttribute("aria-label")&&i.setAttribute("aria-label",t.value()),i.dispatchEvent(new CustomEvent("common-tooltip-update"))}_updateCustomTextColor(){const e=this._customTextColor.value()||"";for(const t of this._titleContainers)null!==t&&(t.style.color=e);const t=(0,n.ensureNotNull)(this._valuesParentEl).querySelectorAll(`.${ae.valueTitle}`);for(let i=0;i<t.length;i++)t[i].style.color=e;(0,n.ensureNotNull)(this._el).classList.toggle(ae.withCustomTextColor,Boolean(e))}_updateStatusWidgetVisibility(e){null!==this._statusesWrapper&&(e?(this._statusesWidgetDestroy?.(),this._statusesWidgetDestroy=void 0):this._statusesWidgetDestroy=(0,w.statusesPillRenderer)({container:this._statusesWrapper,statuses:this._statusesWidgetState?.visibleModels()??new L.WatchedValue([]).readonly(),tooltip:this._statusesWidgetState?.tooltip()??new L.WatchedValue("").readonly(),theme:pe}))}_isTitleWithSymbolLogo(e){return 8===e.id||0===e.id}}const ge=_.isSafari?"click":"auxclick";class me extends _e{constructor(e,t,i){super(e,t,i),this._wheelClickHandler=null,this._canUpdateRowVisibility=!0,this._globalRowVisibility=this._model.globalVisibility().spawn(),this._globalRowVisibility.subscribe(this._updateShowLine.bind(this),{callWithLast:!0}),this._has5Buttons=this._model.isAbleShowSourceCode().spawn(),this._has5Buttons.subscribe(this._update5ButtonsStyles.bind(this),{callWithLast:!0}),
this._updateStates(!this._disabled.value()),i.statusesWidgetState&&this._addStatusesWidget(i.statusesWidgetState),this._selected.subscribe(this._updateTitleMaxWidth.bind(this)),i.withActions&&(this._wheelClickHandler=this._onWheelClicked.bind(this),null!==this._titlesWrapperEl&&this._titlesWrapperEl.addEventListener(ge,this._wheelClickHandler))}destroy(){this._has5Buttons.destroy(),this._globalRowVisibility&&this._globalRowVisibility.destroy(),null!==this._wheelClickHandler&&null!==this._titlesWrapperEl&&this._titlesWrapperEl.removeEventListener(ge,this._wheelClickHandler),super.destroy()}accessibleButtons(){return this._globalRowVisibility.value()?super.accessibleButtons():[]}_updateActionsVisibilitiesByMode(){if(!this._withActions)return;const e=this._model.actions(),t=[];let i=[];if(2===this._rowMode||1===this._rowMode)e[0].visible.value()&&t.push(this._actionElements[0]),e[this._actionElements.length-1].visible.value()&&t.push(this._actionElements[this._actionElements.length-1]),i=this._actionElements.slice(1,this._actionElements.length-1);else for(let i=0;i<this._actionElements.length-1;i++)e[i].visible.value()&&t.push(this._actionElements[i]);i.forEach((e=>e.classList.toggle(X.blockHidden,!0))),t.forEach((e=>e.classList.toggle(X.blockHidden,!1)))}_updateShowLine(){if(null===this._el||!this._canUpdateRowVisibility)return;const e=!this._globalRowVisibility.value();e?this._el.classList.toggle(X.blockHidden,e):super._updateShowLine()}_getButtonsCount(){switch(this._rowMode){case 4:return this._has5Buttons.value()?5:4;case 3:return 3;default:return 2}}_render(){super._render();const e=(0,n.ensureNotNull)(this._el);e.classList.add(ae.item,ae.study),e.dataset.name="legend-source-item",e.dataset.entityId=this._model.getSource().id(),e.setAttribute("role","toolbar")}_getAttributesForTitleState(e){return 7===e.id||8===e.id?{titleId:"legend-source-title",className:ae.mainTitle}:9===e.id?{titleId:"legend-source-description",className:ae.inputTitle}:null}_renderValues(){const e=this._initWrappersIfNotInitialized(),t=this._values.value();for(const i of t){const t=document.createElement("div");t.dataset.testIdValueTitle=i.title.value(),t.classList.add(ae.valueItem),t.classList.toggle(X.blockHidden,!i.visible.value());const s=document.createElement("div");s.classList.add(ae.valueValue),s.style.color=i.color.value()||"",s.appendChild(document.createTextNode(i.value.value()));const o=i.title.value();void 0!==o&&(s.classList.add("apply-common-tooltip"),s.title=o),t.appendChild(s),this._valuesElements.push({value:s}),e.appendChild(t)}}_updateValuesTitleHTMLElHandler(e,t=""){const i=(0,n.ensure)(this._valuesElements[e].value);i.classList.toggle("apply-common-tooltip",0!==t.length),i.title=t}_update5ButtonsStyles(e){null!==this._el&&(this._el.classList.toggle(ae.has5Buttons,e),this._updateAllButtonsWidth())}_onWheelClicked(e){1===e.button&&this._model.onRemoveSource()}}class be extends _e{constructor(e,t,i){super(e,t,i),this._clientHeight=null,this._updateLinkedState=()=>{(0,
n.ensureNotNull)(this._el).classList.toggle(ae.linked,Boolean(this._linked?.value())),this._updateTitleMaxWidth()},this._flagged=this._model.flagged().spawn(),this._flagged.subscribe(this._updateFlaggedState.bind(this)),this._linked=this._model.linked().spawn(),this._updateLinkedState&&this._linked.subscribe(this._updateLinkedState.bind(this),{callWithLast:!0}),this._updateStates(),i.statusesWidgetState&&this._addStatusesWidget(i.statusesWidgetState),this._selected.subscribe(this._updateTitleMaxWidth.bind(this))}destroy(){super.destroy(),this._flagged?.destroy(),this._linked?.destroy()}getHeight(){return null===this._el?null:(null===this._clientHeight&&(this._clientHeight=this._el.clientHeight,0===this._clientHeight&&(this._clientHeight=null)),this._clientHeight)}_updateActionsVisibilitiesByMode(){if(!this._withActions)return;const e=[];let t=[];const i=this._model.actions();if(1===this._rowMode)i[this._actionElements.length-1].visible.value()&&e.push(this._actionElements[this._actionElements.length-1]),t=this._actionElements.slice(0,this._actionElements.length-1);else for(let t=0;t<this._actionElements.length;t++)i[t].visible.value()&&e.push(this._actionElements[t]);t.forEach((e=>e.classList.toggle(X.blockHidden,!0))),e.forEach((e=>e.classList.toggle(X.blockHidden,!1)))}_updateTitlesVisibilitiesByMode(){this._hideTitleAndItsContainerIfRequired(3),this._hideTitleAndItsContainerIfRequired(4),this._hideTitleAndItsContainerIfRequired(2)}_isTitleHiddenByMode(e){const t=e.id;return 2!==t&&3!==t&&4!==t?super._isTitleHiddenByMode(e):2===t&&this._isMultipleLayout.value()?1===this._titlesMode:3!==this._titlesMode}_hideTitleAndItsContainerIfRequired(e){const t=this._getTitleIndexByDataName(e);if(-1===t)return;const i=this._titlesStatesSpawn.value()[t],s=this._titleContainers[t],o=this._titleElements[t],n=this._isTitleHiddenByMode(i);s?.classList.toggle(X.blockHidden,n),o?.classList.toggle(X.blockHidden,n)}_getButtonsCount(){return 1===this._rowMode?1:4}_render(){super._render();const e=(0,n.ensureNotNull)(this._el);e.classList.add(ae.item,ae.series),e.classList.toggle(ae.onlyOneButtonCanBeStick,this._model.isOneButtonCanBeStick()),e.dataset.name="legend-series-item",e.setAttribute("role","toolbar")}_updateStates(){super._updateStates(),this._updateFlaggedState(),this._updateLinkedState?.()}_renderValues(){const e=this._initWrappersIfNotInitialized(),t=this._values.value();for(const i of t){const t=document.createElement("div");t.dataset.testIdValueTitle=i.title.value(),t.classList.add(ae.valueItem),t.classList.toggle(X.blockHidden,!i.visible.value()),t.classList.toggle(ae.unimportant,i.unimportant.value());const s=document.createElement("div"),o=i.title.value()||"",n=this._customTextColor.value()||"";s.classList.add(ae.valueTitle),s.classList.toggle(X.blockHidden,0===o.length),s.appendChild(document.createTextNode(o)),s.style.color=n,t.appendChild(s);const l=document.createElement("div");l.classList.add(ae.valueValue),l.style.color=i.color.value()||"",l.appendChild(document.createTextNode(i.value.value())),t.appendChild(l),
this._valuesElements.push({title:s,value:l}),e.appendChild(t)}}_getAttributesForTitleState(e){switch(e.id){case 0:return{titleId:"legend-source-title",className:ae.mainTitle};case 1:return{titleId:"legend-source-description",className:ae.descTitle};case 2:return{titleId:"legend-source-interval",className:ae.intervalTitle};case 3:return{titleId:"legend-source-provider",className:ae.providerTitle};case 4:return{titleId:"legend-source-exchange",className:ae.exchangeTitle};case 5:return{titleId:"legend-source-style",className:ae.styleTitle};case 6:return{titleId:"legend-source-price-source",className:ae.priceSourceTitle}}return null}_updateValuesTitleHTMLElHandler(e,t=""){const i=(0,n.ensure)(this._valuesElements[e].title);(0,g.updateTextNode)(i,t),i.classList.toggle(X.blockHidden,0===t.length),this._updateShowValues()}_isWidthButtonsMode(){return null!==this._el&&(void 0!==this._flagged&&Boolean(this._flagged.value())||this._linked?.value()||super._isWidthButtonsMode())}_updateFlaggedState(){if(void 0===this._flagged)return;(0,n.ensureNotNull)(this._el).classList.toggle(ae.flagged,Boolean(this._flagged.value())),this._updateTitleMaxWidth()}_getTitleIndexByDataName(e){return this._titlesStatesSpawn.value().findIndex((t=>t.id===e))}}var ve=i(947036),fe=i(662920),we=i(65300),ye=i(736885);const Se=(0,y.mergeThemes)(S.DEFAULT_STATUS_RENDERER_THEME,{statusesWrap:ae.statusesWrapper__statuses});class Ce{constructor(e,t,i){this._wrapperTogger=null,this._el=null,this._counterEl=null,this._arrowIconEL=null,this._objectTreeEl=null,this._loader=K(null),this._mode=0,this._accessibleButtons=[],this._parentEl=e,this._themedColor=t.spawn(),this._themedColor.subscribe(this._updateThemedColor.bind(this)),this._showCollapserWithOneIndicator=i.showCollapserWithOneIndicator.spawn(),this._showCollapserWithOneIndicator.subscribe(this._updateVisibility.bind(this)),this._sourceCount=i.visibleDataSourceCount.spawn(),this._sourceCount.subscribe((()=>{this._updateSourceCount(),this._updateVisibility()})),this._isStateOpen=i.isDataSourcesCollapsed.spawn(),this._isStateOpen.subscribe((()=>{this._updateState(),this._updateVisibility()})),this._isMainPane=i.isMainPane.spawn(),this._isMainPane.subscribe(this._updateObjectTreeVisibility.bind(this)),this._isPaneCollapsed=i.isPaneCollapsed.spawn(),this._isPaneCollapsed.subscribe(this._updateVisibility.bind(this)),this._combinedStatusWidgetEl=document.createElement("div"),this._combinedStatusesWidgetState=i.combinedStatusesWidgetState,this._combinedStatusesWidgetVisibility=this._combinedStatusesWidgetState.visibility().spawn(),this._combinedStatusesWidgetVisibility.subscribe(this._updateVisibility.bind(this)),this._render(),this._updateState(),this._updateVisibility(),this._updateThemedColor(this._themedColor.value()),this._updateObjectTreeVisibility(this._isMainPane.value()),this._isLoaderVisible=(0,l.combine)(((e,t)=>!e&&t[0]),this._isStateOpen.weakReference(),i.hasLoadingDataSources.weakReference()),this._isLoaderVisible.subscribe(this._loader.toggleVisibility,{callWithLast:!0}),
this._toggleStateHandler=e=>{null!==this._el&&(e.cancelable&&e.preventDefault(),e instanceof KeyboardEvent||this._el?.blur(),1!==this._mode?i.onCollapseDataSources():i.onShowObjectsTreeDialog())},null!==this._el&&(this._el.addEventListener("touchend",this._toggleStateHandler),this._el.addEventListener("click",this._toggleStateHandler),this._el.addEventListener("contextmenu",(e=>{e.preventDefault(),e.stopPropagation()}))),this._updateSourceCount()}destroy(){this._isLoaderVisible.destroy(),this._loader.destroy(),this._isPaneCollapsed.destroy(),this._sourceCount.destroy(),this._isStateOpen.destroy(),this._showCollapserWithOneIndicator.destroy(),this._combinedStatusesWidgetVisibility.destroy(),this._combinedStatusesWidgetDestroy?.(),null!==this._objectTreeEl&&(this._objectTreeEl=null),this._arrowIconEL=null,this._counterEl=null,null!==this._el&&(this._el.removeEventListener("touchend",this._toggleStateHandler),this._el.removeEventListener("click",this._toggleStateHandler),this._el.innerHTML="",this._el=null)}accessibleButtons(){return null===this._el||this._el.classList.contains(ae.onlyOneSourceShown)&&1!==this._mode?[]:this._accessibleButtons}setMode(e){this._mode=e?1:0,this._updateTooltip()}_render(){this._wrapperTogger=document.createElement("div"),this._wrapperTogger.classList.add(ae.togglerWrapper),this._el=document.createElement("button"),this._el.className=`${ae.toggler} apply-common-tooltip`;const e=this._el;e.type="button",e.classList.add(ae.accessible),e.tabIndex=-1;const t=t=>{if(null!==e)switch(t.type){case"roving-tabindex:main-element":e.tabIndex=0;break;case"roving-tabindex:secondary-element":e.tabIndex=-1}};e.addEventListener("roving-tabindex:main-element",t),e.addEventListener("roving-tabindex:secondary-element",t),e.addEventListener("keydown",(e=>{const t=(0,c.hashFromEvent)(e);13!==t&&32!==t||(e.preventDefault(),this._toggleStateHandler(e))})),this._accessibleButtons.push(e),this._arrowIconEL=document.createElement("div"),this._arrowIconEL.classList.add(ae.iconArrow),this._arrowIconEL.innerHTML=v.trackingModeIsAvailable?fe:ve,this._el.appendChild(this._arrowIconEL),this._objectTreeEl=document.createElement("div"),this._objectTreeEl.classList.add(ae.objectTree),this._objectTreeEl.innerHTML=v.trackingModeIsAvailable?ye:we,this._el.appendChild(this._objectTreeEl),this._counterEl=document.createElement("div"),this._counterEl.classList.add(ae.counter),this._counterEl.appendChild(document.createTextNode(String(this._sourceCount.value()))),this._el.appendChild(this._counterEl),this._wrapperTogger.appendChild(this._el),this._combinedStatusWidgetEl.classList.add(ae.statusesWrapper),this._wrapperTogger.appendChild(this._combinedStatusWidgetEl),!this._isStateOpen.value()&&this._combinedStatusesWidgetVisibility.value()?this._combinedStatusesWidgetDestroy=(0,w.statusesPillRenderer)({container:this._combinedStatusWidgetEl,statuses:this._combinedStatusesWidgetState.visibleModels(),tooltip:this._combinedStatusesWidgetState.tooltip(),theme:Se}):(this._combinedStatusesWidgetDestroy?.(),
this._combinedStatusesWidgetDestroy=void 0),this._parentEl.appendChild(this._wrapperTogger),this._loader.mountTo(this._wrapperTogger)}_updateThemedColor(e){if(null!==this._el)if(e.length>0){const[t,i,s]=(0,u.parseRgb)(e);this._el.style.backgroundColor=(0,u.rgbaToString)([t,i,s,(0,u.normalizeAlphaComponent)(.8)])}else this._el.style.removeProperty("background-color")}_updateSourceCount(){const e=this._sourceCount.value(),t=(0,n.ensureNotNull)(this._counterEl);(0,g.updateTextNode)(t,String(e)),t.classList.toggle(X.blockHidden,e<=1),this._parentEl.classList.toggle(ae.saveArrowWidth,e<=1)}_updateVisibility(){const e=this._sourceCount.value(),t=(0,n.ensureNotNull)(this._el),i=1===e&&!this._showCollapserWithOneIndicator.value()&&(this._isStateOpen.value()||!this._combinedStatusesWidgetVisibility.value()),s=e<1||this._isPaneCollapsed.value()&&(this._isMainPane.value()||this._isStateOpen.value());t.classList.toggle(X.blockHidden,!!s),t.classList.toggle(ae.onlyOneSourceShown,i),(0,n.ensureNotNull)(this._wrapperTogger).classList.toggle(X.blockHidden,i),!this._isStateOpen.value()&&this._combinedStatusesWidgetVisibility.value()?this._combinedStatusesWidgetDestroy=(0,w.statusesPillRenderer)({container:this._combinedStatusWidgetEl,statuses:this._combinedStatusesWidgetState.visibleModels(),tooltip:this._combinedStatusesWidgetState.tooltip(),theme:Se}):(this._combinedStatusesWidgetDestroy?.(),this._combinedStatusesWidgetDestroy=void 0)}_updateState(){const e=!this._isStateOpen.value();this._parentEl.classList.toggle(ae.closed,e),this._updateTooltip(),D((e?"Hide":"Show")+" not main sources")}_tooltip(){if(1===this._mode)return T.t(null,void 0,i(685786));const e=this._sourceCount.value(),t=T.t(null,{plural:"Hide indicators legend",count:e},i(946960)),s=T.t(null,{plural:"Show indicators legend",count:e},i(436553));return this._isStateOpen.value()?t:s}_updateTooltip(){if(null!==this._el){const e=this._tooltip();this._el.setAttribute("title",e),this._el.setAttribute("aria-label",e),this._el.dispatchEvent(new CustomEvent("common-tooltip-update"))}}_updateObjectTreeVisibility(e){(0,n.ensureNotNull)(this._el).classList.toggle(ae.objectsTreeCanBeShown,e)}}const Ee=p.enabled("object_tree_legend_mode"),Le=[27,9,37,39,38,40],xe=(0,y.mergeThemes)(S.DEFAULT_STATUS_RENDERER_THEME,{statusesWrap:ae.statusesWrapper__statuses});class Me{constructor(e,t){this._mode=4,this._renderToggler=null,this._mainDataSourceRenderer=null,this._dataSourceRenderers=[],this._parentEl=document.createElement("div"),this._mainDataSourceEl=null,this._dataSourcesEl=null,this._dataSourcesAdditionalWrapperEl=null,this._collapsedDataSourcesWrapperEl=null,this._collapsedDataSourcesEl=null,this._outsideEventForCollapsedTooltip=null,this._onKeyboardNavigationActivationBound=this._onKeyboardNavigationActivation.bind(this),this._onIsDataSourcesCollapsedBound=this._onIsDataSourcesCollapsed.bind(this),this._focusEventAbortController=null,this._toggleHiddenActionsTimoutID=null,this._loader=K(null),this._toggleHiddenActions=e=>{
this._toggleHiddenActionsTimoutID&&(clearTimeout(this._toggleHiddenActionsTimoutID),this._toggleHiddenActionsTimoutID=null),e?this._parentEl.classList.toggle(ae.legend_withHiddenActions,e):this._toggleHiddenActionsTimoutID=setTimeout((()=>this._parentEl.classList.toggle(ae.legend_withHiddenActions,e)),100)},this._options=e,this._togglerOptions=t,this._isStudiesLegendHidden=e.isStudiesLegendHidden.spawn(),this._isStudiesLegendHidden.subscribe(this._updateLegendVisibility.bind(this)),this._isAllLegendHidden=e.isAllLegendHidden.spawn(),this._isAllLegendHidden.subscribe(this._updateLegendVisibility.bind(this)),this._updateLegendVisibility(),this._hideAllExceptFirstLine=e.hideAllExceptFirstLine.spawn(),this._hideAllExceptFirstLine.subscribe(this._updateAllHiddenExeptFirstLine.bind(this)),this._themedColor=e.themedColor.spawn(),this._themedColor.subscribe(this._setCustomBg.bind(this)),this._showBackground=e.showBackground.spawn(),this._showBackground.subscribe(this._setCustomBg.bind(this)),this._backgroundTransparency=e.backgroundTransparency.spawn(),this._backgroundTransparency.subscribe(this._setCustomBg.bind(this)),this._collapsedDataSourcesCountSpawn=e.collapsedDataSourcesCount.spawn(),this._collapsedDataSourcesCountSpawn.subscribe(this._updateCollapsedSourcesCount.bind(this)),this._collapsedDataSourcesStatusWidgetElement=document.createElement("div"),this._collapsedStatusesWidgetState=e.combinedStatusesWidgetState,this._collapsedStatusesWidgetVisibility=this._collapsedStatusesWidgetState.visibility().spawn(),this._collapsedStatusesWidgetVisibility.subscribe((()=>this._updateCollapsedSourcesCount(this._collapsedDataSourcesCountSpawn.value()))),this._showCollapsedDataSourcesTooltipHandler=this._showCollapsedDataSourcesTooltip.bind(this),this._parentEl.classList.add(ae.legend),this._parentEl.classList.toggle(ae.noWrap,!v.trackingModeIsAvailable),this._parentEl.classList.toggle(ae.noActions,!this._options.withActions),this._parentEl.classList.toggle(ae.touchMode,v.trackingModeIsAvailable),this._parentEl.classList.toggle(ae.wrappable,!this._hideAllExceptFirstLine.value()),this._parentEl.dataset.name="legend",this._parentEl.setAttribute("data-tooltip-show-on-focus","true"),this._parentEl.style.setProperty("--legend-source-item-button-width",`${E}px`);const i=t=>{t.preventDefault(),e.showLegendWidgetContextMenu(t)};this._mouseEventHandler=new C.MouseEventHandler(this._parentEl,{contextMenuEvent:i,touchContextMenuEvent:i}),window.addEventListener("keyboard-navigation-activation",this._onKeyboardNavigationActivationBound),this._parentEl.addEventListener("keydown",this._handleKeyDown.bind(this)),this._options.onLayoutChanged.subscribe(this,this._onLayoutChanged),this._isLoaderVisible=(0,l.combine)((e=>e[1]),e.hasLoadingDataSources.weakReference()),this._isLoaderVisible.subscribe(this._loader.toggleVisibility,{callWithLast:!0})}destroy(){this._isLoaderVisible.destroy(),this._loader.destroy(),this._focusEventAbortController?.abort();const e=document.activeElement;let t=-1
;if(Me._wasKeyboardNavigationActivated&&e instanceof HTMLButtonElement){null!==this._getRowRendererByChild(e)&&(t=(0,b.queryTabbableElements)(document.body).indexOf(e))}if(this._collapsedStatusesWidgetDestroy?.(),this._isStudiesLegendHidden.destroy(),this._isAllLegendHidden.destroy(),this._hideAllExceptFirstLine.destroy(),this._themedColor.destroy(),this._showBackground.destroy(),this._backgroundTransparency.destroy(),this._collapsedDataSourcesCountSpawn.destroy(),this._collapsedStatusesWidgetVisibility.destroy(),v.trackingModeIsAvailable&&null!==this._collapsedDataSourcesWrapperEl&&this._collapsedDataSourcesWrapperEl.removeEventListener("touchend",this._showCollapsedDataSourcesTooltipHandler),this._outsideEventForCollapsedTooltip&&this._outsideEventForCollapsedTooltip(),null!==this._dataSourcesAdditionalWrapperEl&&(this._dataSourcesAdditionalWrapperEl.innerHTML="",this._dataSourcesAdditionalWrapperEl=null),null!==this._dataSourcesEl&&(this._dataSourcesEl.innerHTML="",this._dataSourcesEl=null),this._togglerOptions.isDataSourcesCollapsed.unsubscribe(this._onIsDataSourcesCollapsedBound),null!==this._renderToggler&&(this._renderToggler.destroy(),this._renderToggler=null),null!==this._mainDataSourceRenderer&&(this._mainDataSourceRenderer.destroy(),this._mainDataSourceRenderer=null),0!==this._dataSourceRenderers.length){for(const e of this._dataSourceRenderers)e.destroy();this._dataSourceRenderers=[]}if(this._mouseEventHandler.destroy(),this._parentEl.innerHTML="",delete this._parentEl,window.removeEventListener("keyboard-navigation-activation",this._onKeyboardNavigationActivationBound),-1!==t){let e;window.dispatchEvent(new CustomEvent("keyboard-navigation-activation",{bubbles:!0}));const i=(0,b.queryTabbableElements)(document.body);e=t===i.length?i[0]:i[t],e&&e.focus()}}addCustomWidget(e,t){if(0===t.block){this._renderMainDataSourceEl();const i=(0,n.ensureNotNull)(this._mainDataSourceEl);1===t.position&&e.renderTo(i,i.firstChild),0===t.position&&e.renderTo(i)}if(1===t.block){this._renderDataSourcesEl();const i=(0,n.ensureNotNull)(this._dataSourcesAdditionalWrapperEl);1===t.position&&e.renderTo(i,i.firstChild),0===t.position&&e.renderTo(i)}}firstTitle(){return this._parentEl.firstElementChild}getElement(){return this._parentEl}updateMode(e){const t=Ee&&e<133?1:e<205?2:e<222?3:4,i=e<192?1:e<442?2:3;this._mode=t,null!==this._mainDataSourceRenderer&&this._mainDataSourceRenderer.updateMode(t,i);for(const e of this._dataSourceRenderers)e.updateMode(t,i);this._parentEl.classList.toggle(ae.medium,3===t),this._parentEl.classList.toggle(ae.minimized,2===t),this._parentEl.classList.toggle(ae.micro,1===t),null!==this._renderToggler&&this._renderToggler.setMode(1===t);const s=!this._hideAllExceptFirstLine.value()&&(v.trackingModeIsAvailable||e<542);this._parentEl.classList.toggle(ae.directionColumn,s),this._parentEl.classList.toggle(ae.hideUniportantValueItems,!_.CheckMobile.any()&&e<=272)}getMainSourceHeight(){return null===this._mainDataSourceRenderer?0:this._mainDataSourceRenderer.getHeight()}getDataSourceHeight(){
return 0===this._dataSourceRenderers.length?0:this._dataSourceRenderers[0].getHeight()}_renderMainDataSourceEl(){null===this._mainDataSourceEl&&(this._mainDataSourceEl=document.createElement("div"),this._mainDataSourceEl.classList.add(ae.legendMainSourceWrapper),this._parentEl.insertBefore(this._mainDataSourceEl,this._dataSourcesEl))}_renderDataSourcesEl(){null===this._dataSourcesEl&&(this._dataSourcesEl=document.createElement("div"),this._dataSourcesEl.classList.add(ae.sourcesWrapper),this._renderToggle(this._dataSourcesEl),this._dataSourcesAdditionalWrapperEl=document.createElement("div"),this._dataSourcesAdditionalWrapperEl.classList.add(ae.sources),this._dataSourcesEl.appendChild(this._dataSourcesAdditionalWrapperEl),this._renderCollapsedCounter(this._dataSourcesAdditionalWrapperEl),this._parentEl.appendChild(this._dataSourcesEl))}_renderToggle(e){this._options.showToggleButton&&(this._renderToggler=new Ce(e,this._options.themedColor,this._togglerOptions))}_onIsDataSourcesCollapsed(e){if(e){const e=this._getAllAccessibleButtons();if(0===e.filter((e=>e.tabIndex>=0)).length){const t=this._getRowRendererByChild(e[0]);t&&this._makeRowElementTheMainOne(e[0],t)}return}if(0!==(this._mainDataSourceRenderer?.accessibleButtons()||[]).filter((e=>e.tabIndex>=0)).length)return;const t=[];this._dataSourceRenderers.forEach((e=>t.push(...e.accessibleButtons())));const i=t.filter((e=>e.tabIndex>=0));if(0!==i.length){this._focusEventAbortController&&this._focusEventAbortController.abort(),i.forEach((e=>(0,m.becomeSecondaryElement)(e)));let e=null,t=null;if(this._mainDataSourceRenderer){const i=this._mainDataSourceRenderer.accessibleButtons();i.length>0&&(e=i[0],t=this._mainDataSourceRenderer)}null===e&&this._renderToggler&&(e=this._renderToggler.accessibleButtons()[0],t=this._renderToggler),e&&t&&this._makeRowElementTheMainOne(e,t)}}_renderCollapsedCounter(e){this._collapsedDataSourcesWrapperEl=document.createElement("div"),this._collapsedDataSourcesWrapperEl.className=`${ae.item} ${ae.last}`,this._collapsedDataSourcesEl=document.createElement("span"),this._collapsedDataSourcesEl.className=`${ae.text} apply-common-tooltip`,this._collapsedDataSourcesWrapperEl.append(this._collapsedDataSourcesEl),this._collapsedDataSourcesStatusWidgetElement.classList.add(ae.statusesWrapper),this._collapsedDataSourcesWrapperEl.appendChild(this._collapsedDataSourcesStatusWidgetElement),e.append(this._collapsedDataSourcesWrapperEl),v.trackingModeIsAvailable&&this._collapsedDataSourcesWrapperEl.addEventListener("touchend",this._showCollapsedDataSourcesTooltipHandler);const t=this._collapsedDataSourcesCountSpawn.value();this._updateCollapsedSourcesCount(t),this._loader.mountTo(this._collapsedDataSourcesWrapperEl)}_showCollapsedDataSourcesTooltip(){(0,f.showOnElement)(this._collapsedDataSourcesEl,{text:this._options.collapsedDataSourcesTitle.value()}),this._addOutsideEventForHideTooltip()}_addOutsideEventForHideTooltip(){null!==this._outsideEventForCollapsedTooltip&&this._outsideEventForCollapsedTooltip(),this._outsideEventForCollapsedTooltip=(0,
h.addOutsideEventListener)(new CustomEvent("timestamp").timeStamp,this._collapsedDataSourcesWrapperEl,(()=>{null!==this._outsideEventForCollapsedTooltip&&this._outsideEventForCollapsedTooltip(),(0,f.hide)()}),window.document,{touchEnd:!0})}_updateCollapsedSourcesCount(e){if(null===this._collapsedDataSourcesWrapperEl||null===this._collapsedDataSourcesEl)return;const t=0===e;this._collapsedDataSourcesWrapperEl.classList.toggle(X.blockHidden,t),!t&&this._collapsedStatusesWidgetVisibility.value()?this._collapsedStatusesWidgetDestroy=(0,w.statusesPillRenderer)({container:this._collapsedDataSourcesStatusWidgetElement,statuses:this._collapsedStatusesWidgetState.visibleModels(),tooltip:this._collapsedStatusesWidgetState.tooltip(),theme:xe}):(this._collapsedStatusesWidgetDestroy?.(),this._collapsedStatusesWidgetDestroy=void 0),t||((0,g.updateTextNode)(this._collapsedDataSourcesEl,`+${e}`),this._collapsedDataSourcesEl.setAttribute("title",this._options.collapsedDataSourcesTitle.value()))}_updateLegendVisibility(){let e;const t=Me._wasKeyboardNavigationActivated&&(this._isAllLegendHidden.value()||this._isStudiesLegendHidden.value());if(t){e=this._getAllAccessibleButtons().filter((e=>e.tabIndex>=0))[0]}if(this._parentEl.classList.toggle(X.blockHidden,this._isAllLegendHidden.value()),null!==this._dataSourcesEl&&this._dataSourcesEl.classList.toggle(X.blockHidden,this._isStudiesLegendHidden.value()),t){const t=this._getAllAccessibleButtons();if(e&&t.includes(e))return;if(e&&(0,m.becomeSecondaryElement)(e),0!==t.length){const e=this._getRowRendererByChild(t[0]);e&&this._makeRowElementTheMainOne(t[0],e)}}}_updateAllHiddenExeptFirstLine(){this._parentEl.classList.toggle(ae.wrappable,!this._hideAllExceptFirstLine.value())}_setCustomBg(){const e=this._showBackground.value(),t=this._themedColor.value(),i=this._backgroundTransparency.value();let s="";if(e){const[e,o,n]=(0,u.parseRgb)(t);s=(0,u.rgbaToString)([e,o,n,(0,u.normalizeAlphaComponent)(1-i/100)])}this._parentEl.style.color=s}_onLayoutChanged(e){const{newMainSource:t,removedDataSources:i,addedDataSources:s,movedDataSources:o}=e,n=document.activeElement;let l=-1,a=-1;const r=null===this._mainDataSourceRenderer&&0===this._dataSourceRenderers.length;if(Me._wasKeyboardNavigationActivated&&n instanceof HTMLButtonElement){const e=this._getRowRenderers(),o=e.find((e=>e.accessibleButtons().includes(n)));if(void 0!==o){const r=o===this._mainDataSourceRenderer&&null===t,d=o instanceof me&&i.includes(this._dataSourceRenderers.indexOf(o));if(r||d){l=e.indexOf(o);const r=(0,b.queryTabbableElements)(document.body).indexOf(n);a=0!==s.length||(void 0!==t||null!==this._mainDataSourceRenderer)&&null!==t||i.length!==this._dataSourceRenderers.length&&0!==this._dataSourceRenderers.length?r+1:r}}}void 0!==t&&(null!==t?this._addMainDataSource(t.model,t.statusesWidgetState):(this._mainDataSourceRenderer?.destroy(),this._mainDataSourceRenderer=null));const d=[];if(o.forEach((e=>{d.push({renderer:this._dataSourceRenderers[e.oldIndex],newIndex:e.newIndex})})),d.sort(((e,t)=>e.newIndex-t.newIndex)),
i.forEach((e=>{this._dataSourceRenderers.splice(e,1)[0].destroy()})),0!==s.length&&(this._renderDataSourcesEl(),s.forEach((e=>{this._addDataSource(e.model,e.statusesWidgetState,e.index)}))),0!==d.length&&(this._renderDataSourcesEl(),d.forEach((e=>{this._moveDataSource(e.renderer,e.newIndex)}))),Me._wasKeyboardNavigationActivated&&r&&(null!==this._mainDataSourceRenderer||this._dataSourceRenderers.length)&&window.dispatchEvent(new CustomEvent("keyboard-navigation-activation",{bubbles:!0})),-1!==l){let e,t;const i=this._getRowRenderers();for(;l<i.length;){const s=i[l],o=s.accessibleButtons();if(o.length>0){e=o[0],t=s;break}l++}if(e&&t)this._changeFocusElement(e,t);else if(-1!==a){window.dispatchEvent(new CustomEvent("keyboard-navigation-activation",{bubbles:!0}));const t=(0,b.queryTabbableElements)(document.body);e=a===t.length?t[0]:t[a],e&&(n&&(0,m.becomeSecondaryElement)(n),e.focus())}}}_addMainDataSource(e,t){this._renderMainDataSourceEl(),this._mainDataSourceRenderer=new be(e,(0,n.ensureNotNull)(this._mainDataSourceEl),{withActions:this._options.withActions,customTextColor:this._options.customTextColor,statusesWidgetState:t,isMultipleLayout:this._options.isMultipleLayout,toggleHiddenActions:this._toggleHiddenActions}),this._updateLegendVisibility()}_addDataSource(e,t,i){const s=(0,n.ensureNotNull)(this._dataSourcesAdditionalWrapperEl),o=new me(e,s,{withActions:this._options.withActions,customTextColor:this._options.customTextColor,statusesWidgetState:t,isMultipleLayout:this._options.isMultipleLayout,toggleHiddenActions:this._toggleHiddenActions}),l=(0,n.ensureNotNull)(o.getElement());if(null!==l){let e=this._dataSourceRenderers[i];void 0!==e?s.insertBefore(l,e.getElement()):(e=this._dataSourceRenderers[i-1],void 0!==e&&s.insertBefore(l,(0,n.ensureNotNull)(e.getElement()).nextSibling))}this._dataSourceRenderers.splice(i,0,o),this._updateLegendVisibility()}_moveDataSource(e,t){const i=this._dataSourceRenderers.indexOf(e);if(-1===i||t===i)return;const s=(0,n.ensureNotNull)(this._dataSourcesAdditionalWrapperEl),o=(0,n.ensureNotNull)(e.getElement());let l=this._dataSourceRenderers[t];void 0!==l?s.insertBefore(o,l.getElement()):(l=this._dataSourceRenderers[t-1],void 0!==l&&s.insertBefore(o,(0,n.ensureNotNull)(l.getElement()).nextSibling)),this._dataSourceRenderers.splice(i,1),this._dataSourceRenderers.splice(t,0,e)}_onKeyboardNavigationActivation(){Me._wasKeyboardNavigationActivated=!0,this._togglerOptions.isDataSourcesCollapsed.unsubscribe(this._onIsDataSourcesCollapsedBound),this._togglerOptions.isDataSourcesCollapsed.subscribe(this._onIsDataSourcesCollapsedBound);const e=this._getAllAccessibleButtons(),t=e.filter((e=>e.tabIndex>=0));if(0===t.length){const[t]=e.filter((e=>e.hasAttribute("tabIndex")));if(void 0===t)return;const i=this._getRowRendererByChild(t);if(null===i)return;this._makeRowElementTheMainOne(t,i)}if(t.length>1){const[,...e]=t;for(const t of e)(0,m.becomeSecondaryElement)(t)}}_handleKeyDown(e){if(e.defaultPrevented)return;const t=(0,c.hashFromEvent)(e);if(!Le.includes(t))return
;const i=document.activeElement;if(!(i instanceof HTMLButtonElement))return;const s=this._getRowRendererByChild(i);if(null===s)return;if(27===t)return void i.blur();const o=s.accessibleButtons(),n=o.indexOf(i);if(0===o.length||-1===n)return;const l=t=>{e.preventDefault();const i=this._getRowRenderers(),o=i.indexOf(s);let n,l,a="blockNext"===t?o+1:o-1;for(;a>=0&&a<i.length;){const e=i[a],s=e.accessibleButtons();if(0!==s.length){n=e,l=s;break}a="blockNext"===t?a+1:a-1}n&&l&&this._changeFocusElement(l[0],n)},a=(0,b.mapKeyCodeToDirection)(t);switch(a){case"inlinePrev":e.preventDefault(),this._changeFocusElement(0!==n?o[n-1]:o[o.length-1],s);break;case"inlineNext":e.preventDefault(),this._changeFocusElement(n!==o.length-1?o[n+1]:o[0],s);break;case"blockPrev":case"blockNext":l(a)}}_subscribeElementToFocusEvents(e,t){this._focusEventAbortController=new AbortController,e.addEventListener("focusin",(()=>{this._focusEventAbortController=new AbortController,e.addEventListener("focusout",(i=>{const s=i.relatedTarget;null!==s&&s instanceof HTMLButtonElement&&t.accessibleButtons().includes(s)||(this._subscribeElementToFocusEvents(e,t),t instanceof Ce||t.hideActions())}),{once:!0,signal:this._focusEventAbortController.signal}),this._options.onLegendRowFocused(),t instanceof Ce||t.showActions()}),{once:!0,signal:this._focusEventAbortController.signal})}_makeRowElementTheMainOne(e,t){this._subscribeElementToFocusEvents(e,t),(0,m.becomeMainElement)(e)}_changeFocusElement(e,t){document.activeElement&&(0,m.becomeSecondaryElement)(document.activeElement),this._makeRowElementTheMainOne(e,t),e.focus()}_getRowRenderers(){let e=[];return this._mainDataSourceRenderer&&e.push(this._mainDataSourceRenderer),this._dataSourcesEl&&!this._dataSourcesEl.classList.contains(X.blockHidden)&&(this._togglerOptions.isDataSourcesCollapsed.value()&&1!==this._mode&&(e=e.concat(this._dataSourceRenderers)),this._renderToggler&&0!==this._dataSourceRenderers.length&&e.push(this._renderToggler)),e}_getAllAccessibleButtons(){const e=[];return this._getRowRenderers().forEach((t=>{e.push(...t.accessibleButtons())})),e}_getRowRendererByChild(e){return this._getRowRenderers().find((t=>t.accessibleButtons().includes(e)))??null}}Me._wasKeyboardNavigationActivated=!1;var Ae=i(242651),ke=i(288789),Ve=i(626185),We=i(791613),Te=i(560420),He=i(959015),Be=i(94196),De=i(861814),Pe=i(787540),Ie=i(172073),Ne=i(257381),Re=i(145889),ze=i(333898);class Oe{constructor({linkingGroupIndex:e,isLinkingAvailable:t,onClickHandler:s,setLinkingGroupIndex:o}){this._actionVisible=new r.WatchedValue(!1),this._menuShown=!1,this._isDestroyed=!1,this._linkingModeSubscription=e=>{if(null===e)return void(this._legendActionButtonElem.innerHTML=Be);const t=document.createElement("img");t.src=(0,Pe.getTwemojiUrl)(Re.icons[e].icon,"svg"),t.width=t.height=18,this._legendActionButtonElem.replaceChildren(t)},this._setLinkingGroupIndexImpl=async e=>{this._setLinkingGroupIndex(e===this._linkingGroupIndex.value()?null:e),this._menuShown&&Ne.ContextMenuManager.hideAll()},this._showContextMenu=async e=>{
e.preventDefault();const t=e.currentTarget;if(!(t&&t instanceof HTMLElement))return;if(this._onClickHandler?.(),this._menuShown)return void Ne.ContextMenuManager.hideAll();const i=await this._getActions();if(0===i.length)return;const{left:s,bottom:o}=t.getBoundingClientRect();await Ne.ContextMenuManager.showMenu(i,{clientX:s,clientY:o},{returnFocus:!0,takeFocus:!0,isKeyboardEvent:!("touches"in e)&&(0,k.isKeyboardClick)(e)},{menuName:"SymbolIntervalChartSyncingMenu"},(()=>{this._menuShown=!1})),this._menuShown=!0},this._linkingGroupIndex=e.spawn(),this._isLinkingAvailable=t.spawn(),this._onClickHandler=s,this._setLinkingGroupIndex=o;const n=this._legendActionButtonElem=document.createElement("span");n.className=ze.legendActionButton,this._action={icon:n,title:new r.WatchedValue(T.t(null,void 0,i(211831))),action:this._showContextMenu,visible:this._actionVisible.readonly(),className:ae.linking,dataset:{name:"legend-layout-chart-sync-action"}},this._linkingGroupIndex.subscribe(this._linkingModeSubscription,{callWithLast:!0}),this._isLinkingAvailable.subscribe((e=>this._actionVisible.setValue(e)),{callWithLast:!0})}destroy(){this._isDestroyed=!0,this._linkingGroupIndex.destroy(),this._isLinkingAvailable.destroy(),this._menuShown&&Ne.ContextMenuManager.hideAll()}getAction(){return this._action}async _getActions(){const[e,{LayoutChartsSyncContextMenuTitle:t},{LayoutChartsSyncContextMenuItem:s}]=await Promise.all([Promise.resolve().then(i.t.bind(i,50959,19)),Promise.all([i.e(44032),i.e(39759),i.e(52186),i.e(30158),i.e(14570),i.e(53093),i.e(10184)]).then(i.bind(i,728102)),Promise.all([i.e(44032),i.e(39759),i.e(52186),i.e(30158),i.e(14570),i.e(53093),i.e(10184)]).then(i.bind(i,209886))]);if(this._isDestroyed)return[];const o=Re.icons.map((({icon:e},t)=>new Ie.Action({actionId:"Chart.LinkingGroupSync.ChangeGroup",options:{label:e,checkable:!0,checked:this._linkingGroupIndex.value()===t,onExecute:()=>this._setLinkingGroupIndexImpl(t)}})));this._linkingGroupIndex.subscribe((e=>{o.forEach(((t,i)=>{t.update({checked:i===e})}))}));return[new Ie.Action({actionId:"Chart.LinkingGroupSync",options:{icon:De,label:T.t(null,void 0,i(104086)),subItems:o},customActionOptions:{jsxLabel:e.createElement(e.Fragment,null,e.createElement(t,null),e.createElement(s,{active:this._linkingGroupIndex,icons:Re.icons,onClick:this._setLinkingGroupIndexImpl})),doNotCloseOnClick:!0,noInteractive:!0}})]}}var Fe=i(182124),Ue=i(533699),Ge=i(607546),Ze=i(849204),qe=i(900210),$e=i(850117);const je=new $e.CircularCacheBuffer(100);class Xe{constructor(e,t){this._symbolLogoUrls=new r.WatchedValue([]),this._quoteDataForLogos=null,this._logoDataUpdated=()=>{const e=this.symbol(),t=this._logoData.value();t&&e&&je.set(e,t);const i=je.get(e);this._quoteDataForLogos=(0,d.merge)(i??{},this._logoData.value()??{}),this._symbolLogoUrls.setValue((0,Ge.removeUsdFromCryptoPairLogos)((0,Ge.resolveLogoUrls)(this._quoteDataForLogos,Ze.LogoSize.Medium)))},this._logoModel=e,this._isLogoVisible=(0,qe.createWVFromGetterAndSubscription)((()=>t.showLogo.value()),t.showLogo),
this._logoData=this._logoModel.logoData().spawn(),this._logoData.subscribe(this._logoDataUpdated,{callWithLast:!0})}destroy(){this._isLogoVisible.destroy(),this._logoModel.destroy()}isSymbolLogoVisible(){return this._isLogoVisible}symbolLogoUrls(){return this._symbolLogoUrls}symbol(){return this._logoModel.symbol()}update(){this._logoModel.update()}}function Ke(e,t){return new Xe(e,t)}var Je=i(395081),Qe=i(735566);const Ye=(0,Qe.getLogger)("Chart.LegendWidget");function et(e){const t={};for(const i of["logoid","currency-logoid","base-currency-logoid"])if(i in e){const s=i;t[s]=e[s]}return t}class tt{constructor(e){this._logoData=new r.WatchedValue(null),this._prevSymbol="",this._source=e,this._source.quotesProvider().quotesUpdate().subscribe(this,this._onQuoteSymbolDataUpdated),this.update()}destroy(){this._source.quotesProvider().quotesUpdate().unsubscribeAll(this)}symbol(){return this._source.symbol()}logoData(){return this._logoData}update(){const e=this.symbol();this._prevSymbol!==e&&(this._prevSymbol=e,this._onSourceSymbolChange())}_onQuoteSymbolDataUpdated(e,t){const i=t.values;!this._source.symbolSameAsCurrent(e.values.pro_name)||void 0===i.logoid&&void 0===i["currency-logoid"]&&void 0===i["base-currency-logoid"]||this._logoData.setValue(et(i))}async _onSourceSymbolChange(){const e=this.symbol();let t=null;try{this._logoData.setValue(null),t=await this._source.quotesProvider().quotesSnapshot(e)}catch(e){Ye.logError(`Quote snapshot error: ${e}`)}finally{this.symbol()===e&&(null===t?this._logoData.setValue(null,!0):this._logoData.setValue(et(t)))}}_onSourceSymbolResolved(){0}}var it=i(754336),st=i(841674),ot=i(387258),nt=i(645534);const lt=T.t(null,void 0,i(437117)),at=T.t(null,void 0,i(44454)),rt=T.t(null,void 0,i(13865)),dt=T.t(null,void 0,i(963245)),ut=T.t(null,void 0,i(102569)),ct=p.enabled("legend_inplace_edit"),ht=p.enabled("show_hide_button_in_legend"),pt=p.enabled("hide_resolution_in_legend"),_t=p.enabled("marked_symbols"),gt=!_.CheckMobile.any();class mt extends Z{constructor(e,t,i,s,o){super(e,t,i,s,o),this._symbolMarker=null,this._symbolMarkerIcon=null,this._flagged=new r.WatchedValue(null),this._symbolAction=null,this._symbolForMarker=null,this._isOneButtonCanBeStick=!1,this._layoutChartSyncLegendRenderer=null,this._isChartLinked=new r.WatchedValue(!1).readonly().spawn(),gt&&(this._isLayoutChartSyncVisible=(0,l.combine)(((e,t,i)=>e&&(t||i)),this._model.isMultipleLayout().weakReference(),this._model.chartWidgetCollectionLock().symbol.weakReference(),this._model.chartWidgetCollectionLock().interval.weakReference()),this._isChartLinked=(0,l.combine)(((e,t)=>t&&null!==e),this._model.model().linkingGroupIndex().weakReference(),(this._isLayoutChartSyncVisible||new r.WatchedValue(!1)).weakReference())),this._createActions(),this._updateSymbolMarker();const n=this._model.model().properties().childs().paneProperties.childs().legendProperties.childs();this._symbolLogoViewModel.setValue(Ke(new tt(t),n)),n.showSeriesTitle.subscribe(this,(()=>{this._isTitleHidden.setValue(this._getTitleHiddenValue())})),
this._isPriceSourceHidden=(0,ke.createWVFromGetterAndSubscription)((()=>!n.showPriceSource.value()),n.showPriceSource),this._valuesVisibleProperty=(0,ke.combineProperty)(((e,t,i,s)=>`${e}:${t}:${i}:${s}`),n.showSeriesOHLC.weakReference(),n.showBarChange.weakReference(),n.showVolume.weakReference(),n.showLastDayChange.weakReference()),this._valuesVisibleProperty.subscribe(null,(()=>{this.update(),this._isValuesHidden.setValue(this._getValuesHiddenValue())})),this.update(),this._source.statusWV().subscribe(this._updateLoadingStatus)}destroy(){gt&&(this._layoutChartSyncLegendRenderer?.destroy(),this._isChartLinked.destroy(),this._isLayoutChartSyncVisible?.destroy()),super.destroy(),this._model.model().properties().childs().paneProperties.childs().legendProperties.childs().showSeriesTitle.unsubscribeAll(this),this._source.statusWV().unsubscribe(this._updateLoadingStatus),this._valuesVisibleProperty.destroy(),this._isPriceSourceHidden.destroy(),this._symbolMarker?.destroy()}flagged(){return this._flagged}linked(){return this._isChartLinked}onShowSettings(){this._source.userEditEnabled()&&this._callbacks.showGeneralChartProperties(Je.TabNames.symbol)}isOneButtonCanBeStick(){return this._isOneButtonCanBeStick}_updateTitles(){const e=(0,n.ensureNotNull)(this._source.statusView()).getSplitTitle(),t=[],i=this._getChangeSymbolCallback();let s=null;""!==(0,Ae.clean)(e.title,!0)&&(s={title:(0,Ae.clean)(e.title,!0),id:0,tooltip:i?dt:void 0,onClick:i},t.push(s));const o=(0,Ae.clean)(e.description,!0);""!==o&&t.push({title:o,id:1,tooltip:i?dt:void 0,onClick:i});const l=(0,Ae.clean)(e.interval,!0);if(""!==l&&!pt){const e=this._getChangeResolutionCallback();t.push({title:l,id:2,tooltip:e?ut:void 0,onClick:e})}const a=(0,Ae.clean)(e.provider,!0);""!==a&&t.push({title:a,id:3});const r=(0,Ae.clean)(e.listedExchange,!0);""!==r&&t.push({title:r,id:4});const d=(0,Ae.clean)(e.chartStyle,!0);""!==d&&t.push({title:d,id:5});const u=this._isPriceSourceHidden.value()?"":(0,Ae.clean)(e.priceSource,!0);""!==u&&t.push({title:u,id:6}),this._titles.setValue(t)}_updateValues(){const e=this._source.legendView(),t=this._values.value(),i=e.marketTitle(),s=e.marketTitle().length>0,o=e.items();if(0===t.length||t.length!==o.length+1){const e={value:new r.WatchedValue(""),color:new r.WatchedValue(""),visible:new r.WatchedValue(s),title:new r.WatchedValue(i),unimportant:new r.WatchedValue(!1)},t=o.map((e=>({value:new r.WatchedValue(e.value()),color:new r.WatchedValue(R(e.color())),visible:new r.WatchedValue(e.visible()),title:new r.WatchedValue(e.title()),unimportant:new r.WatchedValue(e.unimportant())})));this._values.setValue([e].concat(t))}else{t[0].title.setValue(i),t[0].visible.setValue(s);for(let e=0;e<o.length;e++){const i=o[e];t[e+1].value.setValue(i.value()),t[e+1].color.setValue(R(i.color())),t[e+1].visible.setValue(i.visible()),t[e+1].title.setValue(i.title())}}}_updateStates(){super._updateStates(),this._updateSymbolMarker()}_getDisabledOnIntervalState(){return!1}_getTitleHiddenValue(){
return!this._model.model().properties().childs().paneProperties.childs().legendProperties.childs().showSeriesTitle.value()}_getValuesHiddenValue(){return!this._hasValues()||!this._valuesVisibleProperty.value().split(":").some((e=>"true"===e))}_getChangeSymbolCallback(){if(ct&&!p.enabled("disable_legend_inplace_symbol_change"))return void 0===this._changeSymbolCallback&&(this._changeSymbolCallback=async()=>{const e=this._model.mainSeries(),t=e.symbol(),i=e.properties().childs().shortName.value(),s="option"===e.symbolInfo()?.type,o=e.symbolInfo()?.pro_name;let n=e.isSpread()?t:i||t||"";if(p.enabled("symbol_search_option_chain_selector")&&s&&o){const e=await(0,Fe.resolveUnderlyingSymbol)(o);e&&(n={type:"option",value:o,underlying:e})}(0,Te.showDialog)({defaultValue:n,enableOptionsChain:p.enabled("symbol_search_option_chain_selector")})}),this._changeSymbolCallback}_getChangeResolutionCallback(){if(ct&&!p.enabled("disable_legend_inplace_resolution_change"))return void 0===this._changeResolutionCallback&&(this._changeResolutionCallback=()=>{(0,We.showChangeIntervalDialogAsync)({initVal:this._model.mainSeries().interval(),selectOnInit:!0})}),this._changeResolutionCallback}_createActions(){if(_t&&this._options.symbolMarkerEnabled){const e=document.createElement("div");e.classList.add(ae.markerContainer),this._symbolMarkerIcon=e,this._symbolAction={icon:e,action:this._symbolActionHandler.bind(this),visible:new r.WatchedValue(!0),className:ae.flag,title:new r.WatchedValue(this._getMarkerTitle()),dataset:{name:"legend-flag-action"}},this._actions.push(this._symbolAction)}if(gt&&this._isLayoutChartSyncVisible&&(this._layoutChartSyncLegendRenderer=new Oe({linkingGroupIndex:this._model.model().linkingGroupIndex().readonly(),setLinkingGroupIndex:e=>this._model.setLinkingGroupIndex(e),isLinkingAvailable:this._isLayoutChartSyncVisible,onClickHandler:()=>this.setSourceSelected()}),this._actions.push(this._layoutChartSyncLegendRenderer.getAction())),ht){const e=(0,Ve.convertPropertyToWatchedValue)((0,ke.combineProperty)((e=>!e),this._source.properties().childs().visible.weakReference())),t={icon:new Map([["large",st],["small",it]]),action:(0,M.wrapHandlerWithPreventEvent)(this.onToggleDisabled.bind(this)),visible:e,className:ae.eye,title:new r.WatchedValue(this._getEyeTitle()),dataset:{name:"legend-show-hide-action"}};this._actions.push(t),this._disabled.subscribe((()=>{t.title?.setValue(this._getEyeTitle())}))}this._actions.push({icon:new Map([["large",nt],["small",ot]]),action:this._moreActionHandler.bind(this),visible:new r.WatchedValue(!0),title:new r.WatchedValue(lt),dataset:{name:"legend-more-action"}})}_getMarkerTitle(){return null!==this._symbolMarker?this._symbolMarker.isMarked()?rt:at:""}_symbolActionHandler(e){(0,M.preventDefault)(e),null!==this._symbolMarker&&(this._updateSymbolMarker(),e instanceof KeyboardEvent&&this._symbolMarker.toggle(e),D("Change flag state"))}_updateSymbolMarker(){if(_t&&this._options.symbolMarkerEnabled){const e=(0,n.ensureNotNull)(this._symbolAction),t=(0,
n.ensureNotNull)(this._symbolMarkerIcon),i=this._model.model().mainSeries().symbolInfo()?.pro_name??this._model.model().mainSeries().symbol();this._symbolMarker?this._symbolForMarker!==i&&(this._symbolMarker.bindTo(i,t),this._symbolForMarker=i):(this._symbolMarker=(0,He.createSymbolMarkerStandalone)({symbol:i,container:t,specialImage:Ue,className:ae.flagWrapper,onMarkedChanged:()=>this._updateSymbolMarker()}),this._symbolForMarker=i),this._flagged.setValue(this._symbolMarker.isMarked());(0,n.ensureDefined)(e.title).setValue(this._getMarkerTitle())}else this._isOneButtonCanBeStick=!0}}var bt=i(128090),vt=i(269794),ft=i(319259),wt=i(678949),yt=i(186335),St=i(271587),Ct=i(251954),Et=i(791488),Lt=i(779923),xt=i(583637),Mt=i(236791),At=i(34882),kt=i(337073),Vt=i(30556),Wt=i(591104);const Tt=(0,Qe.getLogger)("Chart.LegendWidget"),Ht=T.t(null,void 0,i(232514)),Bt=T.t(null,void 0,i(787142)),Dt=T.t(null,void 0,i(767410)),Pt=T.t(null,void 0,i(437117)),It=T.t(null,void 0,i(974759)),Nt=T.t(null,void 0,i(963245)),Rt=p.enabled("study_buttons_in_legend"),zt=p.enabled("show_hide_button_in_legend"),Ot=p.enabled("property_pages"),Ft=p.enabled("format_button_in_legend"),Ut=p.enabled("delete_button_in_legend"),Gt=p.enabled("legend_inplace_edit");class Zt extends Z{constructor(e,t,i,s,o){super(e,t,i,s,o),this._error=new r.WatchedValue(!1),this._isAbleShowSourceCode=new r.WatchedValue(!1),this._isAbleShowSourceCodeInner=new r.WatchedValue(!1).spawn(),this._pineAction=null,this._pineActionVisible=null,this._globalVisibility=new r.WatchedValue(!0),this._updateSymbolLogoModel(),this._createActions();const n=this._model.model().properties().childs().paneProperties.childs().legendProperties.childs(),l=[n.showSeriesTitle,n.showStudyTitles];for(const e of l)e.subscribe(this,(()=>{this._isTitleHidden.setValue(this._getTitleHiddenValue())}));const a=[n.showSeriesOHLC,n.showBarChange,n.showStudyValues,n.showLastDayChange,n.showSeriesLegendCloseOnMobile];for(const e of a)e.subscribe(this,(()=>{this._isValuesHidden.setValue(this._getValuesHiddenValue())}));this.update(),Ct.subscribe(Et.TV_SCRIPT_DELETED,this.update,this),this._updateAbleShowSourceCode()}destroy(){super.destroy();const e=this._model.model().properties().childs().paneProperties.childs().legendProperties.childs();e.showSeriesTitle.unsubscribeAll(this),e.showStudyTitles.unsubscribeAll(this),e.showSeriesOHLC.unsubscribeAll(this),e.showBarChange.unsubscribeAll(this),e.showStudyValues.unsubscribeAll(this),e.showLastDayChange.unsubscribeAll(this),e.showSeriesLegendCloseOnMobile.unsubscribeAll(this),this._isAbleShowSourceCodeInner.destroy(),Ct.unsubscribe(Et.TV_SCRIPT_DELETED,this.update,this)}error(){return this._error.readonly()}isAbleShowSourceCode(){return this._isAbleShowSourceCode}onRemoveSource(){if(this._source.isUserDeletable()){if((0,bt.isStudy)(this._source)&&this._source.hasChildren()){const e=this._source.getAllChildren().map((e=>e.name(!0)));(0,vt.showDeleteStudyTreeConfirm)(e,this._model.removeSource.bind(this._model,this._source,!1))
}else this._model.removeSource(this._source,!1);D("Remove sources")}}async onShowSourceCode(){{const e=this._source.pineSourceCodeModel?.()??Promise.resolve(null);if(e)try{const t=await e;if(this._destroyed)return;t?.isAbleShowSourceCode().value()&&(t.showPineSourceCode(),D("Open source code for pine scripts"))}catch(e){Tt.logError(`${e}`),(0,Lt.showWarning)({title:T.t(null,void 0,i(212388)),text:T.t(null,void 0,i(327527)),buttonText:T.t(null,void 0,i(515462))})}}}setGlobalVisibility(e){this._globalVisibility.setValue(e)}globalVisibility(){return this._globalVisibility.readonly()}getFullTitle(){return this._titles.value().map((e=>N(e)?e.items.map((e=>e.title)).join(" "):e.title)).join(" ")}getSource(){return this._source}_updateTitles(){const e=(0,n.ensureNotNull)(this._source.statusView()),t=e.getSplitTitle(),i=[],s=(0,Ae.clean)(t[0],!0);if(""!==s){const t=this._getChangeSymbolCallback();i.push({title:s,id:t?8:7,tooltip:t?Nt:e.titleTooltip(),onClick:t})}const o=[];(e.getInputsTitles()??[]).forEach((e=>{const t=(0,Ae.clean)(e.value,!0);""!==t&&o.push({title:t,tooltip:e.title,id:9})})),0!==o.length&&i.push({id:9,items:o}),this._titles.setValue(i)}_updateValues(){const e=this._source.legendView();if(null===e)return;if(0===e.items().length)return;const t=this._values.value();if(0===t.length){const t=e.items().map((e=>({value:new r.WatchedValue(e.value()),color:new r.WatchedValue(R(e.color())),visible:new r.WatchedValue(e.visible()),unimportant:new r.WatchedValue(e.unimportant()),title:new r.WatchedValue(e.title())})));this._values.setValue(t)}else{const i=e.items();for(let e=0;e<i.length;e++){const s=t[e],o=i[e];s.value.setValue(o.value()),s.color.setValue(R(o.color())),s.visible.setValue(o.visible()),s.title.setValue(o.title())}}}_updateStates(){super._updateStates(),void 0!==this._error&&this._error.setValue(Boolean(this._source.isFailed()))}_getTitleHiddenValue(){const e=this._model.model().properties().childs().paneProperties.childs().legendProperties.childs();return this._isSymbolLikeStudy()?!e.showSeriesTitle.value():!e.showStudyTitles.value()}_getDisabledOnIntervalState(){return!(!(0,bt.isStudy)(this._source)&&!(0,bt.isStudyStub)(this._source))&&!this._source.isActualInterval()}_getValuesHiddenValue(){if(!this._hasValues())return!0;const e=this._model.model().properties().childs().paneProperties.childs().legendProperties.childs();return this._isSymbolLikeStudy()?!e.showSeriesOHLC.value()&&!e.showBarChange.value()&&!e.showLastDayChange.value():!e.showStudyValues.value()}_isSymbolLikeStudy(){return(0,bt.isCompareOrOverlayStudy)(this._source)}_getChangeSymbolCallback(){const e=this._source;if(Gt&&(0,wt.isSymbolSourceWithQuotesProvider)(e))return void 0===this._changeSymbolCallback&&(this._changeSymbolCallback=()=>{let t=null;const i=t=(0,yt.loadNewSymbolSearch)().then((async s=>{if(i!==t)return;const o=e.symbol(),n=(0,oe.safeShortName)(o),l="spread"===e.symbolInfo()?.type,a="option"===e.symbolInfo()?.type,r=e.symbolInfo()?.pro_name;let d=l?o:n||o||"";if(p.enabled("symbol_search_option_chain_selector")&&a&&r){
const e=await(0,Fe.resolveUnderlyingSymbol)(r);e&&(d={type:"option",value:r,underlying:e})}const u=(0,St.getSymbolSearchCompleteOverrideFunction)();s.showSymbolSearchItemsDialog({onSearchComplete:t=>{u(t[0].symbol,t[0].result).then((t=>{this._model.setSymbol(e,t.symbol)}))},dialogTitle:Nt,defaultValue:d,enableOptionsChain:p.enabled("symbol_search_option_chain_selector"),showSpreadActions:p.enabled("show_spread_operators")&&p.enabled("studies_symbol_search_spread_operators")})}))}),this._changeSymbolCallback}async _updateAbleShowSourceCode(){if(Rt&&this._options.canShowSourceCode&&!this._options.readOnlyMode){const e=this._source.pineSourceCodeModel?.()??Promise.resolve(null);if(e){const t=await e;if(this._destroyed)return;this._isAbleShowSourceCodeInner.destroy(),this._isAbleShowSourceCodeInner=t?.isAbleShowSourceCode().spawn()??new r.WatchedValue(!1).spawn(),this._isAbleShowSourceCodeInner.subscribe((e=>{this._updateVisibilityPineAction(e)}),{callWithLast:!0})}}}_updateVisibilityPineAction(e){null!==this._pineActionVisible&&(this._pineActionVisible.setValue(e),this._isAbleShowSourceCode.setValue(e))}_createActions(){if(!this._options.readOnlyMode){if(this._pineActionVisible=new r.WatchedValue(!1),this._pineAction={icon:new Map([["large",kt],["small",At]]),action:(0,M.wrapHandlerWithPreventEvent)(this.onShowSourceCode.bind(this)),disableAccessibility:!0,visible:this._pineActionVisible.readonly(),title:new r.WatchedValue(Bt),dataset:{name:"legend-pine-action"}},zt){const e=new r.WatchedValue(!this._getDisabledOnIntervalState()),t={icon:new Map([["large",st],["small",it]]),action:(0,M.wrapHandlerWithPreventEvent)(this.onToggleDisabled.bind(this)),visible:e.readonly(),className:ae.eye,title:new r.WatchedValue(this._getEyeTitle()),dataset:{name:"legend-show-hide-action"}};this._actions.push(t),this._disabled.subscribe((()=>{t.title?.setValue(this._getEyeTitle())}));const i=new r.WatchedValue(this._getDisabledOnIntervalState()),s={icon:new Map([["large",st],["small",it]]),action:(0,M.wrapHandlerWithPreventEvent)(this.onShowSettings.bind(this,Je.TabNames.visibility)),visible:i.readonly(),className:ae.intervalEye,title:new r.WatchedValue(It),dataset:{name:"legend-interval-show-hide-action"}};this._actions.push(s),this._disabledOnInterval.subscribe((t=>{i.setValue(t),e.setValue(!t)}))}if(Ot&&Ft&&(!(0,bt.isStudy)(this._source)||new ft.MetaInfoHelper(this._source.metaInfo()).hasUserEditableOptions())){const e=new r.WatchedValue(this._getIsEditable()),t={icon:new Map([["large",Mt],["small",xt]]),action:(0,M.wrapHandlerWithPreventEvent)((()=>this.onShowSettings())),visible:e.readonly(),title:new r.WatchedValue(Ht),dataset:{name:"legend-settings-action"}};this._actions.push(t),this._isEditable.subscribe((t=>{e.setValue(t)}))}if(((0,bt.isStudy)(this._source)||(0,bt.isStudyStub)(this._source))&&Rt&&this._options.canShowSourceCode&&this._actions.push(this._pineAction),Ut){const e=new r.WatchedValue(this._getIsEditable()),t={icon:new Map([["large",Wt],["small",Vt]]),action:(0,
M.wrapHandlerWithPreventEvent)(this.onRemoveSource.bind(this)),visible:e.readonly(),title:new r.WatchedValue(Dt),dataset:{name:"legend-delete-action"}};this._actions.push(t),this._isEditable.subscribe((t=>{e.setValue(t)}))}this._actions.push({icon:new Map([["large",nt],["small",ot]]),action:this._moreActionHandler.bind(this),visible:this._isEditable.spawn(),title:new r.WatchedValue(Pt),dataset:{name:"legend-more-action"}})}}_updateSymbolLogoModel(){if(this._symbolLogoViewModel.value()?.destroy(),(0,wt.isSymbolSourceWithQuotesProvider)(this._source)){const e=this._model.model().properties().childs().paneProperties.childs().legendProperties.childs(),t=Ke(new tt(this._source),e);this._symbolLogoViewModel.setValue(t)}else this._symbolLogoViewModel.setValue(null)}}var qt=i(388741),$t=i(916013),jt=i(16241),Xt=i(830101),Kt=i(798218);function Jt(e,t,i){e.setProperty(t,!t.value(),i)}const Qt=new H.TranslatedString("change symbol description visibility",T.t(null,void 0,i(288167))),Yt=new H.TranslatedString("change open market status visibility",T.t(null,void 0,i(196227))),ei=new H.TranslatedString("change chart values visibility",T.t(null,void 0,i(479637))),ti=new H.TranslatedString("change last day change visibility",T.t(null,void 0,i(66307))),ii=new H.TranslatedString("change bar change visibility",T.t(null,void 0,i(927426))),si=new H.TranslatedString("change indicator titles visibility",T.t(null,void 0,i(463050))),oi=new H.TranslatedString("change indicator inputs visibility",T.t(null,void 0,i(775663))),ni=new H.TranslatedString("change indicator values visibility",T.t(null,void 0,i(749583))),li=new H.TranslatedString("change volume values visibility",T.t(null,void 0,i(796201))),ai=(new H.TranslatedString("change symbol field visibility",T.t(null,void 0,i(412050))),T.t(null,void 0,i(14771))),ri=T.t(null,void 0,i(825765)),di=T.t(null,void 0,i(845639)),ui=T.t(null,void 0,i(672423)),ci=T.t(null,void 0,i(810842)),hi=T.t(null,void 0,i(937644)),pi=T.t(null,void 0,i(407511)),_i=T.t(null,void 0,i(233828)),gi=T.t(null,void 0,i(151353)),mi=(T.t(null,void 0,i(923079)),(0,jt.appendEllipsis)(T.t(null,void 0,i(232514)))),bi=(e,t)=>e?e.dataset[t]?e.dataset[t]:e.parentElement?bi(e.parentElement,t):null:null;var vi=i(62538),fi=i(124943),wi=i(642413),yi=i(933214),Si=i(567035),Ci=i(790188),Ei=i(838373),Li=i(79304),xi=i(199241);const Mi=T.t(null,void 0,i(610319)),Ai=T.t(null,void 0,i(407681)),ki=T.t(null,void 0,i(964730)),Vi=new Map([[!0,new Map([["small",Ei],["medium",Li],["large",Li]])],[!1,new Map([["small",""],["medium",""],["large",""]])]]),Wi=new Map([[!0,xi.hasError],[!1,null]]),Ti=new Map([[!0,Mi],[!1,null]]),Hi=new Map([[!0,Mi],[!1,null]]),Bi=new Map([[!0,Ci.colorsPalette["color-invalid-symbol"]],[!1,null]]),Di=new Map([[!0,[Ai]],[!1,null]]),Pi=new Map([[!0,[ki]],[!1,null]]);function Ii(e){switch(e){case 0:return Di;case 1:return Pi;default:throw new Error("Unknown CombinedStatusWidgetType")}}var Ni=i(302588),Ri=i(257979)
;const zi=T.t(null,void 0,i(448758)),Oi=T.t(null,void 0,i(889181)),Fi=T.t(null,void 0,i(592663)),Ui=new Map([[!0,new Map([["small",Ni],["medium",Ri],["large",Ri]])],[!1,new Map([["small",""],["medium",""],["large",""]])]]),Gi=new Map([[!0,xi.updateAvailable],[!1,null]]),Zi=new Map([[!0,zi],[!1,null]]),qi=new Map([[!0,zi],[!1,null]]),$i=new Map([[!0,Ci.colorsPalette["color-deep-blue-a400"]],[!1,null]]),ji=new Map([[!0,[Oi]],[!1,null]]),Xi=new Map([[!0,[Fi]],[!1,null]]);function Ki(e){switch(e){case 0:return ji;case 1:return Xi;default:throw new Error("Unknown CombinedStatusWidgetType")}}class Ji extends Si.StatusesWidgetStateBase{constructor(e,t){super(t),this._dataSourceStatusWidgets=[],this._hasErrorStatus=null,this._hasUpdateStatus=null,this._hasErrorViewModel=null,this._hasUpdateViewModel=null,this._updateVisibility=()=>{const e=0===this.visibleModels().value().length;this._visibility.setValue(!e)},this._type=e}destroy(){this._hasErrorViewModel?.destroy(),this._hasUpdateViewModel?.destroy(),super.destroy()}addStatusWidget(e){this._dataSourceStatusWidgets.push(e),this._recreateHasErrorStatus(),this._recreateHasUpdateStatus(),this._createStatusesWidgetStates()}clear(){this._dataSourceStatusWidgets=[],this._hasErrorStatus?.destroy(),this._hasErrorStatus=null,this._hasUpdateStatus?.destroy(),this._hasUpdateStatus=null}async _createStatusesWidgetStates(){const e=this._hasErrorStatus;null!==e&&(null===this._hasErrorViewModel?(this._hasErrorViewModel=new yi.BooleanStatusViewModel(e,{classNameMap:Wi,htmlMap:Ii(this._type),iconMap:Vi,size:this._size,titleColorMap:Bi,titleMap:Hi,tooltipMap:Ti}),this._addStatusViewModelsInfos({visible:this._hasErrorViewModel.visible().spawn(),model:this._hasErrorViewModel})):this._hasErrorViewModel.updateStatus(e));const t=this._hasUpdateStatus;null!==t&&(null===this._hasUpdateViewModel?(this._hasUpdateViewModel=new yi.BooleanStatusViewModel(t,{classNameMap:Gi,htmlMap:Ki(this._type),iconMap:Ui,size:this._size,titleColorMap:$i,titleMap:qi,tooltipMap:Zi}),this._addStatusViewModelsInfos({visible:this._hasUpdateViewModel.visible().spawn(),model:this._hasUpdateViewModel})):this._hasUpdateViewModel.updateStatus(t))}_recreateHasErrorStatus(){this._hasErrorStatus?.destroy();const e=(0,l.combine)((e=>this._dataSourceStatusWidgets.map((e=>e.dataSourceErrorStatusShown.weakReference()))),new L.WatchedValue(this._dataSourceStatusWidgets).weakReference());this._hasErrorStatus=(0,l.accumulate)((e=>e.some((e=>e))),e.ownership())}_recreateHasUpdateStatus(){this._hasUpdateStatus?.destroy();const e=(0,l.combine)((e=>this._dataSourceStatusWidgets.map((e=>e.dataUpdatedModeShown.weakReference()))),new L.WatchedValue(this._dataSourceStatusWidgets).weakReference());this._hasUpdateStatus=(0,l.accumulate)((e=>e.some((e=>e))),e.ownership())}}var Qi=i(62802),Yi=i(633161);const es={readOnlyMode:!1,contextMenu:{settings:!0,mainSeries:!0,studies:!0,showOpenMarketStatus:!1},symbolMarkerEnabled:!1,showToggleButton:!0,canShowSourceCode:!1,statusesWidgets:{sourceStatusesEnabled:!1,sourceStatuses:{errorSolution:!0},
marketStatusEnabled:!1,marketStatus:{preMarketSolution:!0,postMarketSolution:!0},dataUpdateModeEnabled:!1,dataUpdateMode:{subscriptionFullInfo:!0},dataProblemEnabled:!1}},ts=p.enabled("hide_legend_by_default"),is=p.enabled("fundamental_widget"),ss=p.enabled("legend_context_menu"),os=2*parseInt(ae.marginlegendhoriz);class ns{constructor(e,t,i,s,n,u,c,h){this._mainSeriesViewModel=null,this._dataSourceViewModels=[],this._sourcesIds=[],this._visibleDataSourceCount=new r.WatchedValue(0),this._themedColor=new r.WatchedValue(""),this._mainSeriesRowHidden=null,this._dataSourceRowsHidden=[],this._customWidgetsVisibilities=[],this._allLegendHidden=new r.WatchedValue(!1),this._studiesLegendHidden=new r.WatchedValue(!1),this._showCollapserWithOneIndicator=new r.WatchedValue(!1),this._dataSourcesLoadingStatuses=new r.WatchedValue([]),this._customWidgetsHeights=[],this._onLegendVisibilityToggled=null,this._availableHeight=0,this._collapsedDataSourcesCount=new r.WatchedValue(0),this._collapsedDataSourcesTitle=new r.WatchedValue(""),this._mainSeriesStatusesWidgetState=null,this._dataSourceStatusesWidgetStates=[],this._statusProviders=new Map,this._size=null,this._customLegendWidgetsFactoriesMap=new Map,this._customLegendWidgetsMap=new Map,this._margin=0,this._layoutChanged=new a.Delegate,this._model=e,this._paneWidget=t,this._options=(0,d.merge)((0,d.clone)(es),c),this._callbacks=h,this._mainSeriesViewModelsOptions={readOnlyMode:this._options.readOnlyMode,symbolMarkerEnabled:this._options.symbolMarkerEnabled},this._dataSourceViewModelsOptions={...this._mainSeriesViewModelsOptions,canShowSourceCode:this._options.canShowSourceCode},this._backgroundThemeName=i;const p=this._showLegendCalculatedProperty();if(this._isDataSourcesCollapsed=new r.WatchedValue(p.value()),p.subscribe(this,(()=>{this._isDataSourcesCollapsed.setValue(p.value())})),ts&&!Qi.getBool("legend.isVisibilityToggled")){const e=this._showLegendOriginalProperty();this._onLegendVisibilityToggled=this._setLegendVisibilityToggled.bind(this),e.setValue(!1),e.subscribe(this,this._onLegendVisibilityToggled)}const _=new r.WatchedValue(this._getCustomTextColorValue()),g=this._model.model().properties().childs();g.scalesProperties.childs().textColor.subscribe(this,(()=>{_.setValue(this._getCustomTextColorValue())}));const m=g.paneProperties.childs().legendProperties.childs().showBackground,b=new r.WatchedValue(m.value());m.subscribe(this,(()=>{b.setValue(m.value())}));const v=g.paneProperties.childs().legendProperties.childs().backgroundTransparency,f=new r.WatchedValue(v.value());v.subscribe(this,(()=>{f.setValue(v.value())})),this._hideNotMainSources=s,this._hideNotMainSources.subscribe(this._updateLegendVisibilities.bind(this)),this._hideAllExceptFirstLine=n,this._hideAllExceptFirstLine.subscribe(this._updateCollapsedSourcesMode.bind(this)),this._hideWholeLegend=u,this._hideWholeLegend.subscribe(this._updateLegendVisibilities.bind(this)),this._isPaneMain=new r.WatchedValue(this._getIsPaneMainValue()),this._updateCollapsedSourcesModeThrottle=(0,
o.default)(this._updateCollapsedSourcesMode.bind(this),100),this._isPaneMain.subscribe((e=>this._showCollapserWithOneIndicator.setValue(e)),{callWithLast:!0}),this._collapsedStatusesWidgetState=new Ji(1,this._options.statusesWidgets),this._toggledStatusesWidgetState=new Ji(0,this._options.statusesWidgets),this._hasLoadingDataSources=(0,l.accumulate)(((e,t)=>{const i=e.some(Boolean);return[i,!!i&&e.includes(!0,-t)]}),this._dataSourcesLoadingStatuses.weakReference(),this._collapsedDataSourcesCount.weakReference()),this._renderer=new Me({isMultipleLayout:this._model.isMultipleLayout(),withActions:!this._options.readOnlyMode,showToggleButton:this._options.showToggleButton,isStudiesLegendHidden:this._studiesLegendHidden.readonly(),isAllLegendHidden:this._allLegendHidden.readonly(),customTextColor:_.readonly(),themedColor:this._themedColor.readonly(),showBackground:b.readonly(),backgroundTransparency:f.readonly(),collapsedDataSourcesCount:this._collapsedDataSourcesCount.readonly(),collapsedDataSourcesTitle:this._collapsedDataSourcesTitle.readonly(),combinedStatusesWidgetState:this._collapsedStatusesWidgetState,showLegendWidgetContextMenu:this.onShowLegendWidgetContextMenu.bind(this),hideAllExceptFirstLine:this._hideAllExceptFirstLine,onLegendRowFocused:this._callbacks.onLegendRowFocused,onLayoutChanged:this._layoutChanged,hasLoadingDataSources:this._hasLoadingDataSources},{showCollapserWithOneIndicator:this._showCollapserWithOneIndicator.readonly(),visibleDataSourceCount:this._visibleDataSourceCount.readonly(),isDataSourcesCollapsed:this._isDataSourcesCollapsed.readonly(),hasLoadingDataSources:this._hasLoadingDataSources,isMainPane:this._isPaneMain.readonly(),onCollapseDataSources:this.onCollapseDataSources.bind(this),onShowObjectsTreeDialog:this._callbacks.showObjectsTreeDialog,isPaneCollapsed:this._paneWidget.visuallyCollapsed(),combinedStatusesWidgetState:this._toggledStatusesWidgetState})}destroy(){this._hasLoadingDataSources.destroy(),this._backgroundThemeName.release(),this._hideNotMainSources.release(),this._hideAllExceptFirstLine.release(),this._hideWholeLegend.release(),this._sourcesIds=[],null!==this._mainSeriesViewModel&&this._destroyMainDataSource();for(const[,e]of this._statusProviders)e.destroy();for(const e of this._dataSourceViewModels)e.destroy();this._dataSourceViewModels=[],this._collapsedStatusesWidgetState.destroy(),this._toggledStatusesWidgetState.destroy();for(const e of this._dataSourceStatusesWidgetStates)e.destroy();this._dataSourceStatusesWidgetStates=[],this._clearSubscriptions();for(const e of Array.from(this._customLegendWidgetsMap.keys()))this._destroyCustomWidgetFromLayerBlock(e);this._customLegendWidgetsMap.clear(),this._renderer.destroy(),delete this._renderer,this._showLegendCalculatedProperty().unsubscribeAll(this),this._showLegendOriginalProperty().unsubscribeAll(this);const e=this._model.model().properties().childs();e.scalesProperties.childs().textColor.unsubscribeAll(this),e.paneProperties.childs().legendProperties.childs().showBackground.unsubscribeAll(this),
e.paneProperties.childs().legendProperties.childs().backgroundTransparency.unsubscribeAll(this),this._dataSourcesLoadingStatuses.setValue([])}addCustomWidgetToLegend(e,t){const i=this._customLegendWidgetsFactoriesMap.get(t.block)||new Map,s=i.get(t.position)||[];s.push(e),i.set(t.position,s),this._customLegendWidgetsFactoriesMap.set(t.block,i),this.updateLayout(),this._updateCustomWidgetModeBySize()}onShowLegendWidgetContextMenu(e,t){if(this._options.readOnlyMode||!ss)return Promise.resolve();D("Show legend context menu");const i=new Map;for(const e of Array.from(this._customLegendWidgetsMap.keys())){const t=(0,n.ensureDefined)(this._customLegendWidgetsMap.get(e)),s=new Map;for(const e of Array.from(t.keys())){const i=(0,n.ensureDefined)(t.get(e)),o=s.get(e)||[];for(const e of i)o.push(...e.contextMenuActions());s.set(e,o)}i.set(e,s)}return function(e,t,i,s,o,n){const l=[],a=s.get(0);if(void 0!==a){const e=a.get(1);void 0!==e&&e.length>0&&(l.push(...e),l.push(new Ie.Separator))}const r=e.model().properties().childs().paneProperties.childs().legendProperties.childs();l.push(new Ie.Action({actionId:"Chart.Legend.ToggleSymbolVisibility",options:{checkable:!0,checked:r.showSeriesTitle.value(),label:ai,statName:"Show/Hide Symbol",onExecute:()=>Jt(e,r.showSeriesTitle,Qt)}})),t.showOpenMarketStatus&&"market"===e.mainSeries().marketStatusModel().status().value()&&!(0,qt.isEconomicSymbol)(e.mainSeries().symbolInfo())&&l.push(new Ie.Action({actionId:"Chart.Legend.ToggleOpenMarketStatusVisibility",options:{checkable:!0,checked:$t.showMarketOpenStatusProperty.value(),label:ri,statName:"Show/Hide Open market status",onExecute:()=>Jt(e,$t.showMarketOpenStatusProperty,Yt)}})),l.push(new Ie.Action({actionId:"Chart.Legend.ToggleOhlcValuesVisibility",options:{checkable:!0,checked:r.showSeriesOHLC.value(),label:di,statName:"Show/Hide chart values",onExecute:()=>Jt(e,r.showSeriesOHLC,ei)}}));const d=e.mainSeries().style(),u=12!==d&&20!==d;if(u&&!Xt.alwaysShowLastPriceAndLastDayChange&&l.push(new Ie.Action({actionId:"Chart.Legend.ToggleBarChangeValuesVisibility",options:{checkable:!0,checked:r.showBarChange.value(),label:ci,statName:"Show/Hide Bar Change Values",onExecute:()=>Jt(e,r.showBarChange,ii)}})),20!==d&&l.push(new Ie.Action({actionId:"Chart.Legend.ToggleVolumeVisibility",options:{checkable:!0,checked:r.showVolume.value(),label:hi,statName:"Show/Hide Volume",onExecute:()=>Jt(e,r.showVolume,li)}})),u&&(Xt.lastDayChangeAvailable||Xt.alwaysShowLastPriceAndLastDayChange)){const t=Xt.alwaysShowLastPriceAndLastDayChange?r.showBarChange:r.showLastDayChange;l.push(new Ie.Action({actionId:"Chart.Legend.ToggleLastDayChangeValuesVisibility",options:{checkable:!0,checked:t.value(),label:ui,statName:"Show/Hide Last day change values",onExecute:()=>Jt(e,t,ti)}}))}if(l.push(new Ie.Separator),void 0!==a){const e=a.get(0);void 0!==e&&e.length>0&&(l.push(...e),l.push(new Ie.Separator))}const c=s.get(1);if(void 0!==c){const e=c.get(1);void 0!==e&&e.length>0&&(l.push(...e),l.push(new Ie.Separator))}if(e.model().priceDataSources().some((e=>!(0,
wt.isActingAsSymbolSource)(e)&&e.showInObjectTree()))&&(l.push(new Ie.Action({actionId:"Chart.Legend.ToggleIndicatorTitlesVisibility",options:{checkable:!0,checked:r.showStudyTitles.value(),label:pi,statName:"Show/Hide Indicator Titles",onExecute:()=>Jt(e,r.showStudyTitles,si)}})),l.push(new Ie.Action({actionId:"Chart.Legend.ToggleIndicatorArgumentsVisibility",options:{checkable:!0,checked:r.showStudyArguments.value(),label:_i,statName:"Show/Hide Indicator Arguments",onExecute:()=>Jt(e,r.showStudyArguments,oi)}})),l.push(new Ie.Action({actionId:"Chart.Legend.ToggleIndicatorValuesVisibility",options:{checkable:!0,checked:r.showStudyValues.value(),label:gi,statName:"Show/Hide Indicator Values",onExecute:()=>Jt(e,r.showStudyValues,ni)}}))),void 0!==c){const e=c.get(0);void 0!==e&&e.length>0&&(l.push(...e),l.push(new Ie.Separator))}t.settings&&(l[l.length-1]instanceof Ie.Separator||l.push(new Ie.Separator),l.push(new Kt.ActionWithStandardIcon({actionId:"Chart.Dialogs.ShowGeneralSettings.LegendTab",options:{label:mi,iconId:"Settings",statName:"Settings...",onExecute:()=>i(Je.TabNames.legend)}})));const h=bi(o.target,"entityId"),p={menuName:"LegendPropertiesContextMenu",detail:{type:h?"study":"series",id:h??"_seriesId"}};return Ne.ContextMenuManager.showMenu(l,o,{statName:"LegendContextMenu"},p,n)}(this._model,this._options.contextMenu,this._callbacks.showGeneralChartProperties,i,e,t)}onCollapseDataSources(){const e=this._showLegendOriginalProperty();e.setValue(!e.value())}updateLayout(){const e=this._paneWidget.state().sourcesByGroup().legendViewSources().filter((e=>null!==e.statusView()&&e.isDisplayedInLegend())).reverse(),t=this._sourcesIds,i=this._model.mainSeries(),s=e.indexOf(i);let o;if(-1!==s){if(e.splice(s,1),!is&&null===this._mainSeriesViewModel){const e=new mt(this._model,i,this._mainSeriesViewModelsOptions,this._callbacks,this._options.contextMenu);this._mainSeriesViewModel=e;const t=new vi.MainDataSourceStatusesWidgetState(this._statusSourceAdapter(i),this._model,this._options.statusesWidgets);this._mainSeriesStatusesWidgetState=t,o={model:e,statusesWidgetState:t}}}else null!==this._mainSeriesViewModel&&(o=null,this._destroyMainDataSource(),this._destroyCustomWidgetFromLayerBlock(0));const l=e.map((e=>e.instanceId()));this._sourcesIds=l;const a=[],r=new Map,d=[],u=[],c=this._dataSourceViewModels,h=this._dataSourceStatusesWidgetStates;let p=t.length-1;for(;p>=0;){const e=t[p],i=l.indexOf(e);if(-1===i){a.push(p),c[p].destroy(),h[p].destroy();const t=this._statusProviders.get(e);t&&(t.destroy(),this._statusProviders.delete(e))}else p!==i&&(r.set(e,{model:c[p],statusesWidgetState:h[p]}),d.push({oldIndex:p,newIndex:i}));p--}const _=[],g=[];for(let i=0;i<l.length;i++){const s=l[i];let o,a;if(r.has(s)){const e=(0,n.ensureDefined)(r.get(s));o=e.model,a=e.statusesWidgetState}else if(t[i]===s)o=c[i],a=h[i];else{const t=e[i];o=new Zt(this._model,t,this._dataSourceViewModelsOptions,this._callbacks,this._options.contextMenu),
a=new fi.DataSourceStatusesWidgetState(this._statusSourceAdapter(t),this._model,this._options.statusesWidgets),u.push({model:o,statusesWidgetState:a,index:i})}_.push(o),g.push(a)}this._dataSourceViewModels=_,this._dataSourceStatusesWidgetStates=g,0===this._dataSourceViewModels.length&&this._destroyCustomWidgetFromLayerBlock(1),this._dataSourceViewModels.length&&this._recalculateLoadingDataSources(),this._recreateSubscriptions(),this._isPaneMain.setValue(this._getIsPaneMainValue()),this.update();const m=a.length||u.length||d.length;if((void 0!==o||m)&&this._layoutChanged.fire({newMainSource:o,removedDataSources:a,addedDataSources:u,movedDataSources:d}),-1!==s&&this._addCustomWidgetForLayerBlock(0),this._dataSourceViewModels.length>0&&this._addCustomWidgetForLayerBlock(1),this._updateWidgetModeBySize(),m){this._updateCollapsedSourcesMode(),this._toggledStatusesWidgetState.clear();for(const e of this._dataSourceStatusesWidgetStates)this._toggledStatusesWidgetState.addStatusWidget(e)}}update(){null!==this._mainSeriesViewModel&&this._mainSeriesViewModel.update();for(const e of this._dataSourceViewModels)e.update()}updateThemedColors(e){null===e&&(e=(0,Yi.getStdThemedValue)("chartProperties.paneProperties.background",this._backgroundThemeName.value())),this._themedColor.setValue(e||"")}firstTitle(){return this._renderer.firstTitle()}getElement(){return this._renderer.getElement()}addMargin(e){if(this._margin===e)return;this._margin=e;this._renderer.getElement().style.maxWidth=0===this._margin?"":`calc(100% - ${this._margin+os}px)`,this._updateWidgetModeBySize()}updateWidgetModeBySize(e){this._size=e,this._updateWidgetModeBySize()}_statusSourceAdapter(e){const t=e.instanceId();let i=this._statusProviders.get(t);return void 0===i&&(i=e!==this._model.mainSeries()?new wi.ChartModelStatusSourceAdapter(e,this._model.model()):new wi.ChartModelMainSeriesStatusSourceAdapter(this._model.mainSeries(),this._model.model()),this._statusProviders.set(t,i)),i}_updateWidgetModeBySize(){this._updateWidgetModeByWidth(),this._updateWidgetModeByHeight(),this._updateCustomWidgetModeBySize()}_updateWidgetModeByWidth(){if(null===this._size)return;const e=this._availableWidth();this._renderer.updateMode(e),this._paneWidget.hasState()&&this._paneWidget.state().containsMainSeries()&&this._model.mainSeries().setTextSourceIsAlwaysTickerRestrictionEnabled(e<=132)}_updateWidgetModeByHeight(){null!==this._size&&(this._availableHeight=.8*this._size.height,this._updateCollapsedSourcesModeThrottle())}_updateCustomWidgetModeBySize(){if(null===this._size)return;const e=(0,s.size)({width:this._availableWidth(),height:this._size.height});for(const t of Array.from(this._customLegendWidgetsMap.values()))for(const i of Array.from(t.values()))for(const t of i)t.updateWidgetModeBySize(e)}_destroyMainDataSource(){(0,n.ensureNotNull)(this._mainSeriesStatusesWidgetState).destroy(),this._mainSeriesStatusesWidgetState=null;(0,n.ensureNotNull)(this._mainSeriesViewModel).destroy(),this._mainSeriesViewModel=null}_updateCollapsedSourcesMode(){
const e=this._dataSourceViewModels.length,t=this._hideAllExceptFirstLine.value(),i=null!==this._mainSeriesViewModel;if(this._collapsedStatusesWidgetState.clear(),this._availableHeight>0&&e>2){const s=Number(this._renderer.getMainSourceHeight()),o=this._renderer.getDataSourceHeight(),n=this._getCustomWidgetsHeight();if(null!==o){const l=Math.floor((this._availableHeight-s-n)/o),a=Math.max(l,2)-1;if(e>a+1){let s="";for(let o=0;o<e;o++){const e=o<a;this._dataSourceViewModels[o].setGlobalVisibility(e&&(!t||0===o&&!i)),e||(s+=`${0===s.length?"":", "}${this._dataSourceViewModels[o].getFullTitle()}`,this._collapsedStatusesWidgetState.addStatusWidget(this._dataSourceStatusesWidgetStates[o]))}return this._collapsedDataSourcesTitle.setValue(s),void this._collapsedDataSourcesCount.setValue(e-a)}}}for(let e=0;e<this._dataSourceViewModels.length;++e)this._dataSourceViewModels[e].setGlobalVisibility(!t||0===e&&!i);this._collapsedDataSourcesCount.setValue(0),this._collapsedDataSourcesTitle.setValue("")}_getCustomWidgetsHeight(){let e=0;for(const t of Array.from(this._customLegendWidgetsMap.values()))for(const i of Array.from(t.values()))for(const t of i)e+=t.height().value();return e}_getCustomTextColorValue(){const e=this._model.model().properties().childs().scalesProperties.childs().textColor.value();for(const t of(0,Yi.getStdThemeNames)())if((0,Yi.isStdThemedDefaultValue)("chartProperties.scalesProperties.textColor",e,t))return null;return e}_clearSubscriptions(){null!==this._mainSeriesRowHidden&&(this._mainSeriesRowHidden.destroy(),this._mainSeriesRowHidden=null);for(const e of this._dataSourceRowsHidden)e.destroy();this._dataSourceRowsHidden=[];for(const e of this._customWidgetsVisibilities)e.destroy();this._customWidgetsVisibilities=[];for(const e of this._customWidgetsHeights)e.destroy();this._customWidgetsHeights=[]}_recreateSubscriptions(){this._clearSubscriptions(),null!==this._mainSeriesViewModel&&(this._mainSeriesRowHidden=this._mainSeriesViewModel.isRowHidden().spawn(),this._mainSeriesRowHidden.subscribe(this._updateLegendVisibilities.bind(this)));for(const e of this._dataSourceViewModels){const t=e.isRowHidden().spawn();this._dataSourceRowsHidden.push(t),t.subscribe(this._updateVisibleDataSourceCount.bind(this)),t.subscribe(this._updateLegendVisibilities.bind(this))}for(const e of Array.from(this._customLegendWidgetsMap.values()))for(const t of Array.from(e.values()))for(const e of t){const t=e.visibility().spawn();this._customWidgetsVisibilities.push(t),t.subscribe(this._updateLegendVisibilities.bind(this));const i=e.height().spawn();this._customWidgetsHeights.push(i),i.subscribe(this._updateCollapsedSourcesMode.bind(this))}this._updateVisibleDataSourceCount(),this._updateLegendVisibilities()}_recalculateLoadingDataSources(){this._dataSourcesLoadingStatuses.setValue(this._dataSourceViewModels.map((e=>e.loading().weakReference())))}_updateLegendVisibilities(){if(this._hideWholeLegend.value())return void this._allLegendHidden.setValue(!0)
;const e=0!==this._dataSourceRowsHidden.length&&this._dataSourceRowsHidden.every((e=>e.value())),t=this._hideNotMainSources.value()||e;this._studiesLegendHidden.setValue(t);const i=null===this._mainSeriesRowHidden||this._mainSeriesRowHidden.value(),s=this._customWidgetsVisibilities.some((e=>e.value()));this._allLegendHidden.setValue(e&&i&&!s)}_updateVisibleDataSourceCount(){const e=this._dataSourceRowsHidden.filter((e=>!e.value())).length;this._visibleDataSourceCount.setValue(e)}_setLegendVisibilityToggled(){Qi.setValue("legend.isVisibilityToggled",!0);this._showLegendOriginalProperty().unsubscribe(this,(0,n.ensureNotNull)(this._onLegendVisibilityToggled))}_getIsPaneMainValue(){return this._paneWidget.containsMainSeries()}_showLegendCalculatedProperty(){return this._model.model().showLegend()}_showLegendOriginalProperty(){return this._model.model().properties().childs().paneProperties.childs().legendProperties.childs().showLegend}_addCustomWidgetForLayerBlock(e){const t=this._customLegendWidgetsFactoriesMap.get(e);if(void 0===t)return;const i=this._customLegendWidgetsMap.get(e)||new Map;let s=!1;for(const o of Array.from(t.keys())){const n=i.get(o)||[],l=t.get(o)||[];for(let t=n.length;t<l.length;t++){const i=l[t](this._model.model(),this._backgroundThemeName.spawnOwnership(),this._hideAllExceptFirstLine.weakReference());n.push(i),this._renderer.addCustomWidget(i,{block:e,position:o}),s=!0}s&&i.set(o,n)}s&&this._customLegendWidgetsMap.set(e,i)}_destroyCustomWidgetFromLayerBlock(e){const t=this._customLegendWidgetsMap.get(e);if(void 0!==t){for(const e of Array.from(t.values()))for(const t of e)t.destroy();t.clear(),this._customLegendWidgetsMap.delete(e)}}_availableWidth(){return null===this._size?0:Math.max(0,this._size.width-this._margin-os)}}},377200:(e,t,i)=>{"use strict";i.r(t),i.d(t,{PaneControlsWidget:()=>j});var s=i(345848),o=i(444372),n=i(470316),l=i(68777),a=i(790024),r=i(128090),d=i(650151),u=i(724377),c=i(127785),h=i(778785),p=i(479443),_=i(244784),g=i(233465);class m{constructor(e,t,i){this._parentEl=document.createElement("div"),this._listActionsWrapperEl=null,this._listActionsElements={},this._actionsSpawns={},this._onMouseEnterLeaveEventHandler=null,this._mouseOverWidget=!1,this._wrapEl=e,this._onMouseEnterLeaveEventHandler=this._onMouseEnterLeaveEvent.bind(this),this._wrapEl.addEventListener("mouseenter",this._onMouseEnterLeaveEventHandler),this._wrapEl.addEventListener("mouseleave",this._onMouseEnterLeaveEventHandler),this._actions=t,this._globalVisibility=i.globalVisibility.spawn(),this._globalVisibility.subscribe(this._updatePaneControlsWidgetVisibility.bind(this)),this._visibilityType=i.visibilityType.spawn(),this._visibilityType.subscribe(this._updatePaneControlsWidgetVisibility.bind(this)),this._separatorSelected=i.separatorSelected.spawn(),this._separatorSelected.subscribe(this._updatePaneControlsWidgetVisibility.bind(this)),this._maximized=i.maximized.spawn(),this._maximized.subscribe(this._updatePaneControlsWidgetVisibility.bind(this)),
this._doNotSwitchToContextMenuMode=i.doNotSwitchToContextMenuMode,this._themedColor=i.themedColor.spawn(),this._themedColor.subscribe(this._updateThemedColor.bind(this));for(const[e,t]of Object.entries(this._actions)){const i=e;this._actionsSpawns[i]={visible:t.visible.spawn(),title:void 0===t.title?null:t.title.spawn()},this._actionsSpawns[i].visible.subscribe(this._updateActionVisibilities.bind(this,i));const s=this._actionsSpawns[i].title;null!==s&&s.subscribe(this._updateActionTitle.bind(this,i))}this._render(),this._updatePaneControlsWidgetVisibility(),this._updateThemedColor(this._themedColor.value()),this._parentEl.classList.toggle(_.touchMode,p.trackingModeIsAvailable),this._parentEl.addEventListener("contextmenu",(e=>e.preventDefault())),this._parentEl.setAttribute("aria-hidden","true"),this._wrapEl.matches(":hover")&&this._onMouseEnterLeaveEvent({type:"mouseenter"})}destroy(){this._visibilityType.destroy(),this._themedColor.destroy(),this._separatorSelected.destroy();for(const e of Object.keys(this._actionsSpawns)){const t=e;this._actionsSpawns[t].visible.destroy();const i=this._actionsSpawns[t].title;null!==i&&i.destroy()}null!==this._onMouseEnterLeaveEventHandler&&(this._wrapEl.removeEventListener("mouseenter",this._onMouseEnterLeaveEventHandler),this._wrapEl.removeEventListener("mouseleave",this._onMouseEnterLeaveEventHandler),this._onMouseEnterLeaveEventHandler=null),this._parentEl.remove(),this._parentEl.innerHTML="",delete this._parentEl}getElement(){return this._parentEl}bottomWithMargin(){const e=this._parentEl.classList.contains(_.touchMode)?Number(_.css_value_pane_controls_button_touch_size):Number(_.css_value_pane_controls_button_size);return 2*Number(_.css_value_pane_controls_margin_top)+e}updateWidgetModeByWidth(e){const t=!this._doNotSwitchToContextMenuMode.value()&&e<356,i=!this._doNotSwitchToContextMenuMode.value()&&e<666.65,s=(0,d.ensureNotNull)(this._listActionsWrapperEl),o=(0,d.ensureNotNull)(this._listActionsElements.more);s.classList.toggle(g.blockHidden,t||i),o.classList.toggle(g.blockHidden,t||!i||!this._actions.more.visible.value())}_render(){this._renderActions(),this._parentEl.classList.add(_.paneControls),this._wrapEl.append(this._parentEl)}_renderActions(){null===this._listActionsWrapperEl&&(this._listActionsWrapperEl=document.createElement("div"),this._listActionsWrapperEl.classList.add(_.buttons),this._parentEl.append(this._listActionsWrapperEl));const e={tag:"div",buttonClassName:_.button,wrapIconClassName:_.buttonIcon,hiddenClassName:g.blockHidden};this._listActionsElements.up=(0,c.createActionElement)(this._actions.up,e),this._listActionsElements.down=(0,c.createActionElement)(this._actions.down,e),this._listActionsElements.collapse=(0,c.createActionElement)(this._actions.collapse,e),this._listActionsElements.restore=(0,c.createActionElement)(this._actions.restore,e),this._listActionsElements.close=(0,c.createActionElement)(this._actions.close,e),this._listActionsElements.maximize=(0,c.createActionElement)(this._actions.maximize,e),this._listActionsElements.minimize=(0,
c.createActionElement)(this._actions.minimize,e),this._listActionsElements.restore.classList.add(_.button_activated),this._listActionsElements.minimize.classList.add(_.button_activated),this._listActionsWrapperEl.append(this._listActionsElements.up,this._listActionsElements.down,this._listActionsElements.close,this._listActionsElements.collapse,this._listActionsElements.restore,this._listActionsElements.maximize,this._listActionsElements.minimize),this._listActionsElements.more=(0,c.createActionElement)(this._actions.more,e),this._parentEl.append(this._listActionsElements.more)}_updateActionVisibilities(e,t){(0,d.ensureNotNull)(this._listActionsElements[e]).classList.toggle(g.blockHidden,!t)}_updateActionTitle(e,t){(0,d.ensureNotNull)(this._listActionsElements[e]).setAttribute("title",t)}_onMouseEnterLeaveEvent(e){this._mouseOverWidget="mouseenter"===e.type,"visibleOnMouseOver"===this._visibilityType.value()&&this._updatePaneControlsWidgetVisibility()}_updatePaneControlsWidgetVisibility(){let e,t=!1;switch(this._visibilityType.value()){case"alwaysOff":e=!1,t=!0;break;case"alwaysOn":e=this._globalVisibility.value();break;case"visibleOnMouseOver":case"visibleOnTapSelection":e=this._globalVisibility.value()&&this._mouseOverWidget}this._separatorSelected.value()&&"visibleOnTapSelection"===this._visibilityType.value()&&(e=!0),this._maximized.value()&&h.mobiletouch&&(e=!0),this._parentEl.classList.toggle(_.paneControls_hidden,!e),this._parentEl.classList.toggle(_.paneControls_forceHidden,!this._globalVisibility.value()||t)}_updateThemedColor(e){if(e.length>0){const[t,i,s]=(0,u.parseRgb)(e);this._parentEl.style.color=(0,u.rgbaToString)([t,i,s,(0,u.normalizeAlphaComponent)(.8)])}else this._parentEl.style.removeProperty("color")}}var b=i(172073),v=i(257381),f=i(430426),w=i(472899),y=i(648344),S=i(99539),C=i(520465),E=i(334763);const L=o.t(null,void 0,i(513930)),x=L,M=(0,n.humanReadableModifiers)(n.Modifiers.Mod)+L;var A=i(820028),k=i(633161),V=i(604286),W=i(37896),T=i(981020),H=i(756612),B=i(279526),D=i(682847),P=i(671402),I=i(142930);const N=o.t(null,void 0,i(866260)),R=o.t(null,void 0,i(407310)),z=o.t(null,void 0,i(274079)),O=o.t(null,void 0,i(90165)),F=o.t(null,void 0,i(512486)),U=o.t(null,void 0,i(565495)),G=o.t(null,void 0,i(394670)),Z=o.t(null,void 0,i(513930)),q=(0,V.hotKeySerialize)({keys:[""],text:Z}),$=(0,V.hotKeySerialize)({keys:[(0,n.humanReadableModifiers)(n.Modifiers.Mod,!1)],text:`{0} + ${Z}`});class j{constructor(e,t,i,s){this._actions={},this._moreCMShown=!1,this._themedColor=new A.WatchedValue(""),this._model=e,this._pane=t,this._closeButtonVisibility=new A.WatchedValue(this._getCloseButtonVisibility()),this._upButtonVisibility=new A.WatchedValue(this._getUpButtonVisibility()),this._downButtonVisibility=new A.WatchedValue(this._getDownButtonVisibility()),this._maximizeButtonVisibility=new A.WatchedValue(this._getMaximizeButtonVisibility()),this._minimizeButtonVisibility=new A.WatchedValue(this._getMinimizeButtonVisibility()),this._collapseButtonVisibility=(0,
l.combine)(((e,t,i)=>!e&&!t&&i),t.maximized().weakReference(),t.collapsed().weakReference(),t.collapsingAvailable().weakReference()),this._restoreButtonVisibility=(0,l.combine)(((e,t)=>!e&&t),t.maximized().weakReference(),t.collapsed().weakReference()),this._createActions(),this._visibilityTypeProperty=(0,a.actualBehavior)(),this._visibilityTypeProperty.subscribe(this,(e=>{this._visibilityType.setValue(e.value())})),this._visibilityType=new A.WatchedValue(this._visibilityTypeProperty.value()),this._isPaneMaximize=new A.WatchedValue(this._getIsPaneMaximizeValue()),this._isWidgetShow=new A.WatchedValue(this._getIsWidgetShow()),this._backgroundThemeName=i.backgroundThemeName,this._renderer=new m(s,this._actions,{visibilityType:this._visibilityType.readonly(),globalVisibility:this._isWidgetShow.readonly(),doNotSwitchToContextMenuMode:this._isPaneMaximize.readonly(),themedColor:this._themedColor.readonly(),separatorSelected:i.anySeparatorSelected,maximized:this._isPaneMaximize.readonly()})}destroy(){this._visibilityTypeProperty.unsubscribeAll(this),this._collapseButtonVisibility.destroy(),this._restoreButtonVisibility.destroy(),this._renderer.destroy()}getElement(){return this._renderer.getElement()}bottomWithMargin(){return this._renderer.bottomWithMargin()}action(){return this._actions}update(){this._updateButtonsVisibility(),this._isPaneMaximize.setValue(this._getIsPaneMaximizeValue()),this._isWidgetShow.setValue(this._getIsWidgetShow())}updateWidgetModeByWidth(e){this._renderer.updateWidgetModeByWidth(e)}updateThemedColors(e){null===e&&(e=(0,k.getStdThemedValue)("chartProperties.paneProperties.background",this._backgroundThemeName.value())),this._themedColor.setValue(e||"")}_updateButtonsVisibility(){this._closeButtonVisibility.setValue(this._getCloseButtonVisibility()),this._upButtonVisibility.setValue(this._getUpButtonVisibility()),this._downButtonVisibility.setValue(this._getDownButtonVisibility()),this._maximizeButtonVisibility.setValue(this._getMaximizeButtonVisibility()),this._minimizeButtonVisibility.setValue(this._getMinimizeButtonVisibility())}_createActions(){this._actions.up={icon:T,action:this._onUpDownButton.bind(this,"up"),visible:this._upButtonVisibility,title:new A.WatchedValue(R),className:_.up,dataset:{name:"pane-button-up"}},this._actions.down={icon:H,action:this._onUpDownButton.bind(this,"down"),visible:this._downButtonVisibility,title:new A.WatchedValue(z),className:_.down,dataset:{name:"pane-button-down"}},this._actions.close={icon:W,action:this._onCloseButton.bind(this),visible:this._closeButtonVisibility,title:new A.WatchedValue(N),dataset:{name:"pane-button-close"}},this._actions.maximize={icon:B,action:this._onToggleMaximizeButton.bind(this,"Maximize pane"),visible:this._maximizeButtonVisibility,title:new A.WatchedValue(O),hotKeyTitle:q,className:_.maximize,dataset:{name:"pane-button-maximize"}},this._actions.minimize={icon:B,action:this._onToggleMaximizeButton.bind(this,"Minimize pane"),visible:this._minimizeButtonVisibility,title:new A.WatchedValue(F),hotKeyTitle:q,className:_.minimize,
dataset:{name:"pane-button-minimize"}},this._actions.collapse={icon:P,action:this._onToggleCollapseButton.bind(this,"Collapse pane"),visible:this._collapseButtonVisibility,title:new A.WatchedValue(U),hotKeyTitle:$,className:_.collapse,dataset:{name:"pane-button-collapse"}},this._actions.restore={icon:I,action:this._onToggleCollapseButton.bind(this,"Restore pane"),visible:this._restoreButtonVisibility,title:new A.WatchedValue(F),hotKeyTitle:$,className:_.restore,dataset:{name:"pane-button-restore"}},this._actions.more={icon:D,action:this._showButtonsInContextMenu.bind(this),visible:new A.WatchedValue(!0),title:new A.WatchedValue(G),dataset:{name:"pane-button-more"}}}_getCloseButtonVisibility(){let e=!1;return this._pane.containsMainSeries()||this._pane.maximized().value()||(e=this._pane.dataSources().some((e=>(0,r.isStudy)(e)))),e}_onCloseButton(){this._trackEvent("Delete pane");const e=this._model.model().panes().indexOf(this._pane);this._model.removePane(e)}_getUpButtonVisibility(){const e=this._pane,t=this._model.model().panes().indexOf(e);return this._model.model().canMovePaneUp(t)}_getDownButtonVisibility(){const e=this._model.model().panes().indexOf(this._pane);return this._model.model().canMovePaneDown(e)}_onUpDownButton(e){this._trackEvent(`Move pane ${e}`);const t=this._model.model().panes().indexOf(this._pane);this._model.rearrangePanes(t,e)}_getMaximizeButtonVisibility(){return this._model.model().panes().length>1&&!this._pane.maximized().value()}_getMinimizeButtonVisibility(){return this._model.model().panes().length>1&&this._pane.maximized().value()}_onToggleMaximizeButton(e){this._trackEvent(e),this._model.toggleMaximizedPane(this._pane)}_onToggleCollapseButton(e){this._trackEvent(e),this._model.toggleCollapsedPane(this._pane)}_showButtonsInContextMenu(e){e.preventDefault(),this._moreCMShown||function(e,t,i){const s=[];if(e.maximize.visible.value()){const t=(0,d.ensure)(e.maximize.title),i=(0,d.ensureNotNull)(e.maximize.action);s.push(new b.Action({actionId:"Chart.PaneControls.MaximizePane",options:{icon:S,label:t.value(),statName:"Maximize Pane",shortcutHint:x,onExecute:()=>i()}}))}else if(e.minimize.visible.value()){const t=(0,d.ensure)(e.minimize.title),i=(0,d.ensureNotNull)(e.minimize.action);s.push(new b.Action({actionId:"Chart.PaneControls.MinimizePane",options:{icon:S,label:t.value(),statName:"Minimize Pane",shortcutHint:x,onExecute:()=>i()}}))}if(e.collapse.visible.value()){const t=(0,d.ensure)(e.collapse.title),i=(0,d.ensureNotNull)(e.collapse.action);s.push(new b.Action({actionId:"Chart.PaneControls.CollapsePane",options:{icon:C,label:t.value(),statName:"Collapse pane",shortcutHint:M,onExecute:()=>i()}}))}if(e.restore.visible.value()){const t=(0,d.ensure)(e.restore.title),i=(0,d.ensureNotNull)(e.restore.action);s.push(new b.Action({actionId:"Chart.PaneControls.RestorePane",options:{icon:E,label:t.value(),statName:"Restore pane",shortcutHint:M,onExecute:()=>i()}}))}if(e.up.visible.value()){const t=(0,d.ensure)(e.up.title),i=(0,d.ensureNotNull)(e.up.action);s.push(new b.Action({
actionId:"Chart.PaneControls.MovePaneUp",options:{icon:w,label:t.value(),statName:"Move pane up",onExecute:()=>i()}}))}if(e.down.visible.value()){const t=(0,d.ensure)(e.down.title),i=(0,d.ensureNotNull)(e.down.action);s.push(new b.Action({actionId:"Chart.PaneControls.MovePaneDown",options:{icon:y,label:t.value(),statName:"Move pane down",onExecute:()=>i()}}))}if(e.close.visible.value()){const t=(0,d.ensure)(e.close.title),i=(0,d.ensureNotNull)(e.close.action);s.push(new b.Action({actionId:"Chart.PaneControls.DeletePane",options:{icon:f,label:t.value(),statName:"Delete pane",onExecute:()=>i()}}))}const o=(0,d.ensureNotNull)(t.currentTarget).getBoundingClientRect();return v.ContextMenuManager.showMenu(s,{clientX:o.right,clientY:o.top+o.height+3,attachToXBy:"right"},void 0,void 0,i)}(this._actions,e,(()=>{this._moreCMShown=!1})).then((()=>{this._moreCMShown=!0}))}_getIsPaneMaximizeValue(){return this._pane.maximized().value()}_getIsWidgetShow(){return this._model.model().panes().length>1}_trackEvent(e){(0,s.trackEvent)("GUI","Pane action",e)}}},127785:(e,t,i)=>{"use strict";i.d(t,{createActionElement:()=>a});var s=i(343888),o=i(650151),n=i(536794),l=i(196726);function a(e,t){const{buttonClassName:i,wrapIconClassName:a,hiddenClassName:r,iconSize:d,blurOnClick:u}=t,c=document.createElement(t.tag);c.className=i,c.classList.toggle(r,!e.visible.value()),Object.assign(c.dataset,e.dataset),void 0!==e.className&&c.classList.add(e.className),void 0!==e.title&&(c.classList.add("apply-common-tooltip"),c.setAttribute("title",e.title.value()),void 0!==e.hotKeyTitle&&(c.dataset.tooltipHotkey=e.hotKeyTitle)),c.addEventListener("touchend",(0,l.wrapHandlerWithPreventEvent)(e.action)),c.addEventListener("mousedown",(t=>{0===t.button&&(e.action(t),u&&c.blur())}));const h=document.createElement("div");let p;return h.classList.add(a),p=(0,s.default)(e.icon)?e.icon.get((0,o.ensureDefined)(d))||"":e.icon,(0,n.isString)(p)?h.innerHTML=p:h.appendChild(p),c.appendChild(h),c}},503958:(e,t,i)=>{"use strict";i.d(t,{isCustomStudy:()=>o});const s={LinearRegression:!0,PivotPointsHighLow:!0,VbPSessions:!0,VbPSessionsRoughDetailed:!0,VbPPeriodic:!0,VbPAutoAnchored:!0,ZigZag:!0,TPOPeriodic:!0,TPOSessions:!0,VbPFixed:!0,PivotPointsStandard:!0,VbPVisible:!0,VbPAnchored:!0};function o(e){return e in s}},319259:(e,t,i)=>{"use strict";i.d(t,{MetaInfoHelper:()=>h,isStrategyInput:()=>_});var s=i(650151),o=i(735566),n=i(807958),l=i(974145),a=i(536794),r=i(479483);function d(e){return!e.groupId&&!e.isHidden&&e.id!==r.RangeDependentStudyInputNames.FirstBar&&e.id!==r.RangeDependentStudyInputNames.LastBar}var u=i(503958);const c=(0,o.getLogger)("Platform.GUI.PropertyDialog.Indicators.MetaInfo");class h{constructor(e){this._metaInfo=e}hasUserEditableInputs(){return this._metaInfo.inputs.some(d)}getUserEditableInputs(){return this._metaInfo.inputs.filter(d)}hasUserEditableProperties(){return n.StudyMetaInfo.isScriptStrategy(this._metaInfo)}hasUserEditableStyles(){const e=this._metaInfo;return e.plots.length>0||void 0!==e.bands||void 0!==e.filledAreas||(0,
u.isCustomStudy)(e.shortId)||n.StudyMetaInfo.isScriptStrategy(this._metaInfo)||Object.values(e.graphics).some((e=>void 0!==e))}getUserEditablePlots(){const e=new Set,t=this._metaInfo;return t.plots.filter((i=>{if((0,l.isColorerPlot)(i)||(0,l.isTextColorerPlot)(i)||(0,l.isDataOffsetPlot)(i)||(0,l.isOhlcColorerPlot)(i)||(0,l.isAlertConditionPlot)(i)||(0,l.isDataPlot)(i))return!1;if((0,l.isOhlcPlot)(i)){const o=i.target;if(e.has(o))return!1;e.add(o);const n=(0,s.ensureDefined)(t.ohlcPlots);return!(0,s.ensureDefined)(n[o]).isHidden}{const e=t.styles?t.styles[i.id]:void 0;return void 0===e||!e.isHidden}}))}hasUserEditableOptions(){return this.hasUserEditableInputs()||this.hasUserEditableProperties()||this.hasUserEditableStyles()}getStrategyProperties(){const e=this._metaInfo,t=e.inputs.filter(_),i={...p};for(const s of t){const t=s.internalID;i[t]=s,p.hasOwnProperty(t)||c.logWarn(`Unknown strategy input internal id ${t} in ${e.fullId}`)}return(0,a.clone)(i)}}const p={currency:void 0,backtest_fill_limits_assumption:void 0,calc_on_every_tick:void 0,calc_on_order_fills:void 0,commission_value:void 0,commission_type:void 0,initial_capital:void 0,pyramiding:void 0,slippage:void 0,default_qty_type:void 0,default_qty_value:void 0,margin_long:void 0,margin_short:void 0,use_bar_magnifier:void 0,process_orders_on_close:void 0,fill_orders_on_standard_ohlc:void 0};function _(e){return"strategy_props"===e.groupId}},206402:(e,t,i)=>{"use strict";i.d(t,{statusesPillRenderer:()=>l});var s=i(50959),o=i(632227),n=i(696107);function l(e){const{container:t,...i}=e;return o.render(s.createElement(n.StatusesPill,{...i}),t),()=>{o.unmountComponentAtNode(t)}}},271587:(e,t,i)=>{"use strict";i.d(t,{getSymbolSearchCompleteOverrideFunction:()=>o});let s=(e,t)=>Promise.resolve({symbol:e,name:e});function o(){return s}},787540:(e,t,i)=>{"use strict";i.d(t,{getTwemojiUrl:()=>o});var s=i(818438);function o(e,t){let i="";return s.default.parse(e,(e=>(i=s.default.base+("svg"===t?`svg/${e}.svg`:`72x72/${e}.png`),!1))),i}s.default.base="https://cdnjs.cloudflare.com/ajax/libs/twemoji/13.0.1/"},602948:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 18" width="18" height="18"><path fill="currentColor" d="M3.92 7.83 9 12.29l5.08-4.46-1-1.13L9 10.29l-4.09-3.6-.99 1.14Z"/></svg>'},689612:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 18" width="18" height="18"><path fill="currentColor" d="M7.83 3.92 12.28 9l-4.45 5.08-1.13-1L10.29 9l-3.6-4.09 1.14-.99Z"/></svg>'},23317:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 18" width="18" height="18"><path fill="currentColor" d="M14 10H4V8.5h10V10Z"/></svg>'},577576:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 18" width="18" height="18"><path fill="currentColor" d="M8.25 13.75v-9.5h1.5v9.5h-1.5Z"/><path fill="currentColor" d="M13.75 9.75h-9.5v-1.5h9.5v1.5Z"/></svg>'},964146:e=>{
e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 18" width="18" height="18"><path fill="currentColor" d="M14.5 8V3.5H10V2h6v6h-1.5Zm-11 2v4.5H8V16H2v-6h1.5Z"/></svg>'},776996:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 18" width="18" height="18"><path fill="currentColor" d="M11.5 2v4.5H16V8h-6V2h1.5Zm-5 14v-4.5H2V10h6v6H6.5Z"/></svg>'},678529:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 18" width="18" height="18"><path fill="currentColor" d="M7.45 3.5 12.48 9l-5.03 5.49 1.1 1.01L14.52 9 8.55 2.49 7.45 3.5Z"/><path fill="currentColor" d="m3.93 5.99 2.58 3-2.58 3.02 1.14.98 3.42-4-3.42-3.98L3.93 6Z"/></svg>'},593724:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 18" width="18" height="18"><path fill="currentColor" d="M10 6.38V8L6 5.5 10 3v1.85A5.25 5.25 0 1 1 3.75 10a.75.75 0 0 1 1.5 0A3.75 3.75 0 1 0 10 6.38Z"/></svg>'},460925:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 18" width="18" height="18"><path fill="currentColor" d="M12 4h3v1h-1.04l-.88 9.64a1.5 1.5 0 0 1-1.5 1.36H6.42a1.5 1.5 0 0 1-1.5-1.36L4.05 5H3V4h3v-.5C6 2.67 6.67 2 7.5 2h3c.83 0 1.5.67 1.5 1.5V4ZM7.5 3a.5.5 0 0 0-.5.5V4h4v-.5a.5.5 0 0 0-.5-.5h-3ZM5.05 5l.87 9.55a.5.5 0 0 0 .5.45h5.17a.5.5 0 0 0 .5-.45L12.94 5h-7.9Z"/></svg>'},94196:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 18" width="18" height="18"><path fill="currentColor" d="M10.31 4.13 8.3 6.14a.5.5 0 1 1-.7-.7l2.13-2.12a3.5 3.5 0 1 1 4.95 4.95l-2.11 2.11a.51.51 0 1 1-.73-.72l2-2a2.5 2.5 0 0 0-3.53-3.53Zm-2.14 9.3 2.01-2a.5.5 0 0 1 .7.69l-2.13 2.12A3.5 3.5 0 0 1 3.8 9.29l2.11-2.11a.51.51 0 0 1 .72.72l-2 2a2.5 2.5 0 0 0 3.54 3.54ZM11 7.02a.49.49 0 0 0-.69 0L7.47 9.87a.49.49 0 0 0 .68.69l2.86-2.86a.49.49 0 0 0 0-.7Z"/></svg>'},861814:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28"><path fill="currentColor" d="M15.08 5.75a5.07 5.07 0 0 1 7.17 7.17l-3.23 3.23-.7-.7 3.22-3.24a4.07 4.07 0 1 0-5.75-5.75l-3.23 3.23-.7-.71 3.22-3.23Zm-9.33 9.33a5.07 5.07 0 1 0 7.17 7.17l3.23-3.23-.7-.7-3.24 3.22a4.07 4.07 0 1 1-5.75-5.75l3.23-3.23-.71-.7-3.23 3.22Zm10.77-4.3-5.74 5.74.7.7 5.75-5.74-.71-.7Z"/></svg>'},366493:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28" fill="none"><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16.5 20L11 14.5 16.5 9"/></svg>'},379978:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 18" width="18" height="18" fill="none"><path stroke="currentColor" d="M8 5l3.5 3.5L8 12"/></svg>'},841674:e=>{
e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><g class="normal-eye"><path fill="currentColor" fill-rule="evenodd" d="M12 18c-3.07 0-6.21-1.95-7.92-6C5.78 7.95 8.93 6 12 6c3.08 0 6.22 1.95 7.92 6-1.7 4.05-4.84 6-7.92 6Zm8.93-6.19C19.1 7.31 15.59 5 12 5S4.9 7.32 3.08 11.8L3 12l.08.19C4.89 16.68 8.4 19 12 19c3.6 0 7.11-2.32 8.93-6.81l.07-.2-.07-.18ZM14 12a2 2 0 1 1-4 0 2 2 0 0 1 4 0Zm1 0a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"/></g><g class="crossed-eye"><path fill="currentColor" d="M12 19a8.47 8.47 0 0 1-3.87-.95l.75-.75c1 .47 2.07.7 3.12.7 3.08 0 6.22-1.95 7.92-6a11.18 11.18 0 0 0-2.25-3.49l.7-.7a12.28 12.28 0 0 1 2.56 4L21 12l-.07.19C19.1 16.68 15.59 19 12 19Zm-7.92-7c.6 1.42 1.37 2.58 2.26 3.49l-.7.7a12.28 12.28 0 0 1-2.56-4l-.08-.2.08-.18C4.89 7.31 8.4 5 12 5c1.33 0 2.65.32 3.88.94l-.75.75A7.45 7.45 0 0 0 12 6C8.93 6 5.8 7.96 4.08 12ZM12 15a3 3 0 0 1-.73-.09l.92-.92a2 2 0 0 0 1.8-1.8l.92-.92A3 3 0 0 1 12 15Zm-2.91-2.27.92-.91A2 2 0 0 1 11.8 10l.92-.92a3 3 0 0 0-3.64 3.64Zm9.08-7.66-13.1 13.1.77.76 13.09-13.1-.76-.76Z"/></g><g fill="none" class="loading-eye"><path stroke="currentColor" d="M20.46 12c-3.5 8.67-13.42 8.67-16.92 0 3.5-8.67 13.42-8.67 16.92 0Z"/></g><g fill="none" class="animated-loading-eye"><path stroke="currentColor" d="M14.5 12a2.5 2.5 0 1 0-2.5 2.5"/></g></svg>'},754336:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 18" width="18" height="18"><g class="normal-eye"><path fill="currentColor" fill-rule="evenodd" d="M12 9a3 3 0 1 1-6 0 3 3 0 0 1 6 0Zm-1 0a2 2 0 1 1-4 0 2 2 0 0 1 4 0Z"/><path fill="currentColor" d="M16.91 8.8C15.31 4.99 12.18 3 9 3 5.82 3 2.7 4.98 1.08 8.8L1 9l.08.2C2.7 13.02 5.82 15 9 15c3.18 0 6.3-1.97 7.91-5.8L17 9l-.09-.2ZM9 14c-2.69 0-5.42-1.63-6.91-5 1.49-3.37 4.22-5 6.9-5 2.7 0 5.43 1.63 6.92 5-1.5 3.37-4.23 5-6.91 5Z"/></g><g class="crossed-eye"><path fill="currentColor" d="M3.7 15 15 3.7l-.7-.7L3 14.3l.7.7ZM9 3c1.09 0 2.17.23 3.19.7l-.77.76C10.64 4.16 9.82 4 9 4 6.31 4 3.58 5.63 2.08 9a9.35 9.35 0 0 0 1.93 2.87l-.7.7A10.44 10.44 0 0 1 1.08 9.2L1 9l.08-.2C2.69 4.99 5.82 3 9 3Z"/><path fill="currentColor" d="M9 6a3 3 0 0 1 .78.1l-.9.9A2 2 0 0 0 7 8.87l-.9.9A3 3 0 0 1 9 6ZM11.9 8.22l-.9.9A2 2 0 0 1 9.13 11l-.9.9a3 3 0 0 0 3.67-3.68Z"/><path fill="currentColor" d="M9 14c-.82 0-1.64-.15-2.43-.45l-.76.76c1.02.46 2.1.7 3.19.7 3.18 0 6.31-1.98 7.92-5.81L17 9l-.08-.2a10.44 10.44 0 0 0-2.23-3.37l-.7.7c.75.76 1.41 1.71 1.93 2.87-1.5 3.37-4.23 5-6.92 5Z"/></g><g fill="none" class="loading-eye"><path stroke="currentColor" d="M16.45 9c-3.08 7.33-11.82 7.33-14.9 0 3.08-7.33 11.82-7.33 14.9 0Z"/></g><g fill="none" class="animated-loading-eye"><path stroke="currentColor" d="M11.5 9A2.5 2.5 0 1 0 9 11.5"/></g></svg>'},645534:e=>{
e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="M5.5 11a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3ZM3 12.5a2.5 2.5 0 1 1 5 0 2.5 2.5 0 0 1-5 0Zm9.5-1.5a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3ZM10 12.5a2.5 2.5 0 1 1 5 0 2.5 2.5 0 0 1-5 0Zm9.5-1.5a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3ZM17 12.5a2.5 2.5 0 1 1 5 0 2.5 2.5 0 0 1-5 0Z"/></svg>'},387258:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 18" width="18" height="18"><path fill="currentColor" fill-rule="evenodd" d="M3 10a1 1 0 1 0 0-2 1 1 0 0 0 0 2Zm0 1a2 2 0 1 0 0-4 2 2 0 0 0 0 4Zm6-1a1 1 0 1 0 0-2 1 1 0 0 0 0 2Zm0 1a2 2 0 1 0 0-4 2 2 0 0 0 0 4Zm7-2a1 1 0 1 1-2 0 1 1 0 0 1 2 0Zm1 0a2 2 0 1 1-4 0 2 2 0 0 1 4 0Z"/></svg>'},736885:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 18" width="18" height="18"><path fill="currentColor" d="M8.54.84a.8.8 0 0 1 .92 0l7.5 5.25a.8.8 0 0 1 0 1.32l-7.5 5.25a.8.8 0 0 1-.92 0L1.04 7.4a.8.8 0 0 1 0-1.32L8.54.84zM2.9 6.75L9 11.02l6.1-4.27L9 2.48 2.9 6.75z"/><path fill="currentColor" d="M.84 10.8a.8.8 0 0 1 1.12-.2L9 15.51l7.04-4.93a.8.8 0 0 1 .92 1.32l-7.5 5.25a.8.8 0 0 1-.92 0l-7.5-5.25a.8.8 0 0 1-.2-1.12z"/></svg>'},65300:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15 15" width="15" height="15"><path fill="currentColor" d="M7.23 2.58a.5.5 0 0 1 .54 0l5.5 3.5a.5.5 0 0 1 0 .84l-5.5 3.5a.5.5 0 0 1-.54 0l-5.5-3.5a.5.5 0 0 1 0-.84l5.5-3.5zM2.93 6.5L7.5 9.4l4.57-2.9L7.5 3.6 2.93 6.5z"/><path fill="currentColor" d="M1.58 9.23a.5.5 0 0 1 .69-.15L7.5 12.4l5.23-3.33a.5.5 0 0 1 .54.84l-5.5 3.5a.5.5 0 0 1-.54 0l-5.5-3.5a.5.5 0 0 1-.15-.69z"/></svg>'},337073:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="M6 7.5A2.5 2.5 0 0 1 8.5 5H10v1H8.5C7.67 6 7 6.67 7 7.5v1.15a3.5 3.5 0 0 1-1.93 3.13l-.45.22.45.22A3.5 3.5 0 0 1 7 15.35v1.15c0 .83.67 1.5 1.5 1.5H10v1H8.5A2.5 2.5 0 0 1 6 16.5v-1.15a2.5 2.5 0 0 0-1.38-2.23l-1.34-.67a.5.5 0 0 1 0-.9l1.34-.67A2.5 2.5 0 0 0 6 8.65V7.5ZM15.5 6H14V5h1.5A2.5 2.5 0 0 1 18 7.5v1.15c0 .94.54 1.8 1.38 2.23l1.34.67a.5.5 0 0 1 0 .9l-1.34.67A2.5 2.5 0 0 0 18 15.35v1.15a2.5 2.5 0 0 1-2.5 2.5H14v-1h1.5c.83 0 1.5-.67 1.5-1.5v-1.15a3.5 3.5 0 0 1 1.93-3.13l.45-.22-.45-.22A3.5 3.5 0 0 1 17 8.65V7.5c0-.83-.67-1.5-1.5-1.5Z"/></svg>'},34882:e=>{
e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 18" width="18" height="18"><path fill="currentColor" d="M7 14H5.5A1.5 1.5 0 0 1 4 12.5v-1A2.9 2.9 0 0 0 2.66 9l.18-.13A2.9 2.9 0 0 0 4 6.5V5.5C4 4.67 4.67 4 5.5 4H7V3H5.5A2.5 2.5 0 0 0 3 5.5V6.5a1.9 1.9 0 0 1-.77 1.58c-.42.32-.84.43-.85.44C1.3 8.54 1 8.65 1 9s.3.46.38.48c0 0 .43.12.85.44.4.3.77.8.77 1.58v1A2.5 2.5 0 0 0 5.5 15H7v-1Zm4-10h1.5c.83 0 1.5.67 1.5 1.5v1A2.9 2.9 0 0 0 15.34 9l-.18.13A2.9 2.9 0 0 0 14 11.5V12.5c0 .83-.67 1.5-1.5 1.5H11v1h1.5a2.5 2.5 0 0 0 2.5-2.5V11.5c0-.79.38-1.27.77-1.58.42-.32.84-.43.85-.44.08-.02.38-.13.38-.48s-.3-.46-.38-.48c0 0-.43-.12-.85-.44-.4-.3-.77-.8-.77-1.58v-1A2.5 2.5 0 0 0 12.5 3H11v1Z"/></svg>'},236791:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" fill-rule="evenodd" d="m5.12 12 3-6h7.76l3 6-3 6H8.12l-3-6ZM7.5 5h9l3.5 7-3.5 7h-9L4 12l3.5-7Zm6.5 7a2 2 0 1 1-4 0 2 2 0 0 1 4 0Zm1 0a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"/></svg>'},583637:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 18" width="18" height="18"><path fill="currentColor" fill-rule="evenodd" d="m3.1 9 2.28-5h7.24l2.28 5-2.28 5H5.38L3.1 9Zm1.63-6h8.54L16 9l-2.73 6H4.73L2 9l2.73-6Zm5.77 6a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0Zm1 0a2.5 2.5 0 1 1-5 0 2.5 2.5 0 0 1 5 0Z"/></svg>'},591104:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="M10.5 6a.5.5 0 0 0-.5.5V7h4v-.5a.5.5 0 0 0-.5-.5h-3ZM15 7h3v1h-1.04l-.88 9.64a1.5 1.5 0 0 1-1.5 1.36H9.42a1.5 1.5 0 0 1-1.5-1.36L7.05 8H6V7h3v-.5c0-.83.67-1.5 1.5-1.5h3c.83 0 1.5.67 1.5 1.5V7ZM8.05 8l.87 9.55a.5.5 0 0 0 .5.45h5.17a.5.5 0 0 0 .5-.45L15.94 8h-7.9Z"/></svg>'},671402:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15 15" width="15" height="15" fill="none"><path stroke="currentColor" d="M11 2 7.5 5 4 2" class="bracket-up"/><path stroke="currentColor" d="M4 13l3.5-3 3.5 3" class="bracket-down"/></svg>'},520465:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28" fill="none"><path stroke="currentColor" d="M20.53 3.73 14 9.33 7.47 3.73M7.47 24.27l6.53 -5.60 6.53 5.60"/></svg>'},648344:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28"><path fill="currentColor" d="M14 7v12.93l5.18-4.31.64.76-6.32 5.27-6.32-5.27.64-.76L13 19.93V7h1z"/></svg>'},99539:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28"><path fill="currentColor" d="M19.32 6H8.68A2.68 2.68 0 0 0 6 8.68V11h1V8.68C7 7.75 7.75 7 8.68 7h10.64c.93 0 1.68.75 1.68 1.68V11h1V8.68C22 7.2 20.8 6 19.32 6zM7 19.32c0 .93.75 1.68 1.68 1.68h10.64c.93 0 1.68-.75 1.68-1.68V17h1v2.32C22 20.8 20.8 22 19.32 22H8.68A2.68 2.68 0 0 1 6 19.32V17h1v2.32z"/></svg>'},334763:e=>{
e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28" fill="none"><path stroke="currentColor" d="m7.47 9.33 6.53 -5.60L20.53 9.33M20.53 18.67l-6.53 5.60L7.47 18.67"/></svg>'},430426:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28"><path fill="currentColor" d="M18 7h5v1h-2.01l-1.33 14.64a1.5 1.5 0 0 1-1.5 1.36H9.84a1.5 1.5 0 0 1-1.49-1.36L7.01 8H5V7h5V6c0-1.1.9-2 2-2h4a2 2 0 0 1 2 2v1Zm-6-2a1 1 0 0 0-1 1v1h6V6a1 1 0 0 0-1-1h-4ZM8.02 8l1.32 14.54a.5.5 0 0 0 .5.46h8.33a.5.5 0 0 0 .5-.46L19.99 8H8.02Z"/></svg>'},472899:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28"><path fill="currentColor" d="M13.5 6.35l6.32 5.27-.64.76L14 8.07V21h-1V8.07l-5.18 4.31-.64-.76 6.32-5.27z"/></svg>'},682847:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15 15" width="15" height="15"><circle fill="currentColor" cx="12.75" cy="7.5" r="1.25"/><circle fill="currentColor" cx="7.5" cy="7.5" r="1.25"/><circle fill="currentColor" cx="2.25" cy="7.5" r="1.25"/></svg>'},756612:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15 15" width="15" height="15"><path fill="currentColor" d="M11.83 8.88l-.66-.76L8 10.9V3H7v7.9L3.83 8.12l-.66.76 4.33 3.78 4.33-3.78z"/></svg>'},279526:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15 15" width="15" height="15" fill="none"><path fill="currentColor" d="M4.5 12A1.5 1.5 0 0 1 3 10.5V9H2v1.5A2.5 2.5 0 0 0 4.5 13h6a2.5 2.5 0 0 0 2.5-2.5V9h-1v1.5c0 .83-.67 1.5-1.5 1.5h-6z" class="bracket-up"/><path fill="currentColor" d="M4.5 3C3.67 3 3 3.67 3 4.5V6H2V4.5A2.5 2.5 0 0 1 4.5 2h6A2.5 2.5 0 0 1 13 4.5V6h-1V4.5c0-.83-.67-1.5-1.5-1.5h-6z" class="bracket-down"/></svg>'},142930:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15 15" width="15" height="15" fill="none"><path stroke="currentColor" d="m4 5 3.5-3L11 5" class="bracket-up"/><path stroke="currentColor" d="M11 10l-3.5 3L4 10" class="bracket-down"/></svg>'},37896:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15 15" width="15" height="15"><path fill="currentColor" d="M6.5 2a.5.5 0 0 0-.5.5V3h3v-.5a.5.5 0 0 0-.5-.5h-2ZM10 3h3v1h-1.05l-.86 8.65A1.5 1.5 0 0 1 9.59 14H5.4a1.5 1.5 0 0 1-1.49-1.35L3.05 4H2V3h3v-.5C5 1.67 5.67 1 6.5 1h2c.83 0 1.5.67 1.5 1.5V3ZM4.05 4l.86 8.55a.5.5 0 0 0 .5.45H9.6a.5.5 0 0 0 .5-.45L10.94 4h-6.9Z"/></svg>'},981020:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15 15" width="15" height="15"><path fill="currentColor" d="M11.83 6.12l-.66.76L8 4.1V12H7V4.1L3.83 6.88l-.66-.76L7.5 2.34l4.33 3.78z"/></svg>'},339750:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28" fill="none"><path stroke="currentColor" stroke-linecap="round" stroke-width="1.5" d="M7 15l5 5L23 9"/></svg>'},333765:e=>{
e.exports='<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18"><path fill="currentColor" d="M9.707 9l4.647-4.646-.707-.708L9 8.293 4.354 3.646l-.708.708L8.293 9l-4.647 4.646.708.708L9 9.707l4.646 4.647.708-.707L9.707 9z"/></svg>'},662920:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" width="16" height="16"><path fill="currentColor" d="M2.4 5.46a.8.8 0 0 1 1.14-.05L8 9.42l4.46-4.01a.8.8 0 0 1 1.08 1.18L8 11.58 2.47 6.59a.8.8 0 0 1-.06-1.13z"/></svg>'},947036:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15 15" width="15" height="15"><path fill="currentColor" d="M3.5 5.58c.24-.28.65-.3.92-.07L7.5 8.14l3.08-2.63a.65.65 0 1 1 .84.98L7.5 9.86 3.58 6.49a.65.65 0 0 1-.07-.91z"/></svg>'},542205:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 7 7" width="7" height="7"><path fill="currentColor" d="M3.5 7L7 4H4V0H3V4H0L3.5 7Z"/></svg>'},50119:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 9 7" width="9" height="7"><path fill="currentColor" d="M.5 3.5L4 0v3h5v1H4v3z"/></svg>'},24122:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path fill="currentColor" d="M4 8a4 4 0 1 0 8 0 4 4 0 1 0-8 0"/></svg>'},676809:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path fill="currentColor" fill-rule="evenodd" d="M0 8a8 8 0 1 0 16 0A8 8 0 1 0 0 8zm2 0a6 6 0 1 0 12 0A6 6 0 1 0 2 8zm2 0a4 4 0 1 0 8 0 4 4 0 1 0-8 0"/></svg>'},904799:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 14 12" width="14" height="12" fill="currentColor" focusable="false" preserveAspectRatio="none"><path d="M14 12l-4-6 4-6H0v12z"/></svg>'},533699:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 12" width="12" height="12" fill="none"><path fill="currentColor" d="M11.57 0H1a1 1 0 0 0-1 1v10a1 1 0 0 0 1 1h10.57a.5.5 0 0 0 .41-.78l-3.3-4.94a.5.5 0 0 1 0-.56l3.3-4.94a.5.5 0 0 0-.41-.78z"/></svg>'},362884:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 9 7" width="9" height="7"><path fill="currentColor" d="M8.5 3.5L5 0v3H0v1h5v3z"/></svg>'},250662:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 7 7" width="7" height="7"><path fill="currentColor" d="M3.5 0L0 3h3v4h1V3h3L3.5 0z"/></svg>'},818438:(e,t,i)=>{"use strict";i.d(t,{default:()=>s});const s=function(){var e={base:"https://twemoji.maxcdn.com/v/13.0.1/",ext:".png",size:"72x72",className:"emoji",convert:{fromCodePoint:function(e){var t="string"==typeof e?parseInt(e,16):e;if(t<65536)return a(t);return a(55296+((t-=65536)>>10),56320+(1023&t))},toCodePoint:v},onerror:function(){this.parentNode&&this.parentNode.replaceChild(r(this.alt,!1),this)},parse:function(t,i){i&&"function"!=typeof i||(i={callback:i});return("string"==typeof t?_:p)(t,{callback:i.callback||u,attributes:"function"==typeof i.attributes?i.attributes:m,base:"string"==typeof i.base?i.base:e.base,ext:i.ext||e.ext,size:i.folder||(s=i.size||e.size,"number"==typeof s?s+"x"+s:s),className:i.className||e.className,
onerror:i.onerror||e.onerror});var s},replace:b,test:function(e){i.lastIndex=0;var t=i.test(e);return i.lastIndex=0,t}},t={"&":"&amp;","<":"&lt;",">":"&gt;","'":"&#39;",'"':"&quot;"
},i=/(?:\ud83d\udc68\ud83c\udffb\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffc-\udfff]|\ud83d\udc68\ud83c\udffc\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb\udffd-\udfff]|\ud83d\udc68\ud83c\udffd\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb\udffc\udffe\udfff]|\ud83d\udc68\ud83c\udffe\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb-\udffd\udfff]|\ud83d\udc68\ud83c\udfff\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb-\udffe]|\ud83d\udc69\ud83c\udffb\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffc-\udfff]|\ud83d\udc69\ud83c\udffb\u200d\ud83e\udd1d\u200d\ud83d\udc69\ud83c[\udffc-\udfff]|\ud83d\udc69\ud83c\udffc\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb\udffd-\udfff]|\ud83d\udc69\ud83c\udffc\u200d\ud83e\udd1d\u200d\ud83d\udc69\ud83c[\udffb\udffd-\udfff]|\ud83d\udc69\ud83c\udffd\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb\udffc\udffe\udfff]|\ud83d\udc69\ud83c\udffd\u200d\ud83e\udd1d\u200d\ud83d\udc69\ud83c[\udffb\udffc\udffe\udfff]|\ud83d\udc69\ud83c\udffe\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb-\udffd\udfff]|\ud83d\udc69\ud83c\udffe\u200d\ud83e\udd1d\u200d\ud83d\udc69\ud83c[\udffb-\udffd\udfff]|\ud83d\udc69\ud83c\udfff\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb-\udffe]|\ud83d\udc69\ud83c\udfff\u200d\ud83e\udd1d\u200d\ud83d\udc69\ud83c[\udffb-\udffe]|\ud83e\uddd1\ud83c\udffb\u200d\ud83e\udd1d\u200d\ud83e\uddd1\ud83c[\udffb-\udfff]|\ud83e\uddd1\ud83c\udffc\u200d\ud83e\udd1d\u200d\ud83e\uddd1\ud83c[\udffb-\udfff]|\ud83e\uddd1\ud83c\udffd\u200d\ud83e\udd1d\u200d\ud83e\uddd1\ud83c[\udffb-\udfff]|\ud83e\uddd1\ud83c\udffe\u200d\ud83e\udd1d\u200d\ud83e\uddd1\ud83c[\udffb-\udfff]|\ud83e\uddd1\ud83c\udfff\u200d\ud83e\udd1d\u200d\ud83e\uddd1\ud83c[\udffb-\udfff]|\ud83e\uddd1\u200d\ud83e\udd1d\u200d\ud83e\uddd1|\ud83d\udc6b\ud83c[\udffb-\udfff]|\ud83d\udc6c\ud83c[\udffb-\udfff]|\ud83d\udc6d\ud83c[\udffb-\udfff]|\ud83d[\udc6b-\udc6d])|(?:\ud83d[\udc68\udc69]|\ud83e\uddd1)(?:\ud83c[\udffb-\udfff])?\u200d(?:\u2695\ufe0f|\u2696\ufe0f|\u2708\ufe0f|\ud83c[\udf3e\udf73\udf7c\udf84\udf93\udfa4\udfa8\udfeb\udfed]|\ud83d[\udcbb\udcbc\udd27\udd2c\ude80\ude92]|\ud83e[\uddaf-\uddb3\uddbc\uddbd])|(?:\ud83c[\udfcb\udfcc]|\ud83d[\udd74\udd75]|\u26f9)((?:\ud83c[\udffb-\udfff]|\ufe0f)\u200d[\u2640\u2642]\ufe0f)|(?:\ud83c[\udfc3\udfc4\udfca]|\ud83d[\udc6e\udc70\udc71\udc73\udc77\udc81\udc82\udc86\udc87\ude45-\ude47\ude4b\ude4d\ude4e\udea3\udeb4-\udeb6]|\ud83e[\udd26\udd35\udd37-\udd39\udd3d\udd3e\uddb8\uddb9\uddcd-\uddcf\uddd6-\udddd])(?:\ud83c[\udffb-\udfff])?\u200d[\u2640\u2642]\ufe0f|(?:\ud83d\udc68\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68|\ud83d\udc68\u200d\ud83d\udc68\u200d\ud83d\udc66\u200d\ud83d\udc66|\ud83d\udc68\u200d\ud83d\udc68\u200d\ud83d\udc67\u200d\ud83d[\udc66\udc67]|\ud83d\udc68\u200d\ud83d\udc69\u200d\ud83d\udc66\u200d\ud83d\udc66|\ud83d\udc68\u200d\ud83d\udc69\u200d\ud83d\udc67\u200d\ud83d[\udc66\udc67]|\ud83d\udc69\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d[\udc68\udc69]|\ud83d\udc69\u200d\ud83d\udc69\u200d\ud83d\udc66\u200d\ud83d\udc66|\ud83d\udc69\u200d\ud83d\udc69\u200d\ud83d\udc67\u200d\ud83d[\udc66\udc67]|\ud83d\udc68\u200d\u2764\ufe0f\u200d\ud83d\udc68|\ud83d\udc68\u200d\ud83d\udc66\u200d\ud83d\udc66|\ud83d\udc68\u200d\ud83d\udc67\u200d\ud83d[\udc66\udc67]|\ud83d\udc68\u200d\ud83d\udc68\u200d\ud83d[\udc66\udc67]|\ud83d\udc68\u200d\ud83d\udc69\u200d\ud83d[\udc66\udc67]|\ud83d\udc69\u200d\u2764\ufe0f\u200d\ud83d[\udc68\udc69]|\ud83d\udc69\u200d\ud83d\udc66\u200d\ud83d\udc66|\ud83d\udc69\u200d\ud83d\udc67\u200d\ud83d[\udc66\udc67]|\ud83d\udc69\u200d\ud83d\udc69\u200d\ud83d[\udc66\udc67]|\ud83c\udff3\ufe0f\u200d\u26a7\ufe0f|\ud83c\udff3\ufe0f\u200d\ud83c\udf08|\ud83c\udff4\u200d\u2620\ufe0f|\ud83d\udc15\u200d\ud83e\uddba|\ud83d\udc3b\u200d\u2744\ufe0f|\ud83d\udc41\u200d\ud83d\udde8|\ud83d\udc68\u200d\ud83d[\udc66\udc67]|\ud83d\udc69\u200d\ud83d[\udc66\udc67]|\ud83d\udc6f\u200d\u2640\ufe0f|\ud83d\udc6f\u200d\u2642\ufe0f|\ud83e\udd3c\u200d\u2640\ufe0f|\ud83e\udd3c\u200d\u2642\ufe0f|\ud83e\uddde\u200d\u2640\ufe0f|\ud83e\uddde\u200d\u2642\ufe0f|\ud83e\udddf\u200d\u2640\ufe0f|\ud83e\udddf\u200d\u2642\ufe0f|\ud83d\udc08\u200d\u2b1b)|[#*0-9]\ufe0f?\u20e3|(?:[\u2122\u265f]\ufe0f)|(?:\ud83c[\udc04\udd70\udd71\udd7e\udd7f\ude02\ude1a\ude2f\ude37\udf21\udf24-\udf2c\udf36\udf7d\udf96\udf97\udf99-\udf9b\udf9e\udf9f\udfcd\udfce\udfd4-\udfdf\udff3\udff5\udff7]|\ud83d[\udc3f\udc41\udcfd\udd49\udd4a\udd6f\udd70\udd73\udd76-\udd79\udd87\udd8a-\udd8d\udda5\udda8\uddb1\uddb2\uddbc\uddc2-\uddc4\uddd1-\uddd3\udddc-\uddde\udde1\udde3\udde8\uddef\uddf3\uddfa\udecb\udecd-\udecf\udee0-\udee5\udee9\udef0\udef3]|[\u203c\u2049\u2139\u2194-\u2199\u21a9\u21aa\u231a\u231b\u2328\u23cf\u23ed-\u23ef\u23f1\u23f2\u23f8-\u23fa\u24c2\u25aa\u25ab\u25b6\u25c0\u25fb-\u25fe\u2600-\u2604\u260e\u2611\u2614\u2615\u2618\u2620\u2622\u2623\u2626\u262a\u262e\u262f\u2638-\u263a\u2640\u2642\u2648-\u2653\u2660\u2663\u2665\u2666\u2668\u267b\u267f\u2692-\u2697\u2699\u269b\u269c\u26a0\u26a1\u26a7\u26aa\u26ab\u26b0\u26b1\u26bd\u26be\u26c4\u26c5\u26c8\u26cf\u26d1\u26d3\u26d4\u26e9\u26ea\u26f0-\u26f5\u26f8\u26fa\u26fd\u2702\u2708\u2709\u270f\u2712\u2714\u2716\u271d\u2721\u2733\u2734\u2744\u2747\u2757\u2763\u2764\u27a1\u2934\u2935\u2b05-\u2b07\u2b1b\u2b1c\u2b50\u2b55\u3030\u303d\u3297\u3299])(?:\ufe0f|(?!\ufe0e))|(?:(?:\ud83c[\udfcb\udfcc]|\ud83d[\udd74\udd75\udd90]|[\u261d\u26f7\u26f9\u270c\u270d])(?:\ufe0f|(?!\ufe0e))|(?:\ud83c[\udf85\udfc2-\udfc4\udfc7\udfca]|\ud83d[\udc42\udc43\udc46-\udc50\udc66-\udc69\udc6e\udc70-\udc78\udc7c\udc81-\udc83\udc85-\udc87\udcaa\udd7a\udd95\udd96\ude45-\ude47\ude4b-\ude4f\udea3\udeb4-\udeb6\udec0\udecc]|\ud83e[\udd0c\udd0f\udd18-\udd1c\udd1e\udd1f\udd26\udd30-\udd39\udd3d\udd3e\udd77\uddb5\uddb6\uddb8\uddb9\uddbb\uddcd-\uddcf\uddd1-\udddd]|[\u270a\u270b]))(?:\ud83c[\udffb-\udfff])?|(?:\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc65\udb40\udc6e\udb40\udc67\udb40\udc7f|\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc73\udb40\udc63\udb40\udc74\udb40\udc7f|\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc77\udb40\udc6c\udb40\udc73\udb40\udc7f|\ud83c\udde6\ud83c[\udde8-\uddec\uddee\uddf1\uddf2\uddf4\uddf6-\uddfa\uddfc\uddfd\uddff]|\ud83c\udde7\ud83c[\udde6\udde7\udde9-\uddef\uddf1-\uddf4\uddf6-\uddf9\uddfb\uddfc\uddfe\uddff]|\ud83c\udde8\ud83c[\udde6\udde8\udde9\uddeb-\uddee\uddf0-\uddf5\uddf7\uddfa-\uddff]|\ud83c\udde9\ud83c[\uddea\uddec\uddef\uddf0\uddf2\uddf4\uddff]|\ud83c\uddea\ud83c[\udde6\udde8\uddea\uddec\udded\uddf7-\uddfa]|\ud83c\uddeb\ud83c[\uddee-\uddf0\uddf2\uddf4\uddf7]|\ud83c\uddec\ud83c[\udde6\udde7\udde9-\uddee\uddf1-\uddf3\uddf5-\uddfa\uddfc\uddfe]|\ud83c\udded\ud83c[\uddf0\uddf2\uddf3\uddf7\uddf9\uddfa]|\ud83c\uddee\ud83c[\udde8-\uddea\uddf1-\uddf4\uddf6-\uddf9]|\ud83c\uddef\ud83c[\uddea\uddf2\uddf4\uddf5]|\ud83c\uddf0\ud83c[\uddea\uddec-\uddee\uddf2\uddf3\uddf5\uddf7\uddfc\uddfe\uddff]|\ud83c\uddf1\ud83c[\udde6-\udde8\uddee\uddf0\uddf7-\uddfb\uddfe]|\ud83c\uddf2\ud83c[\udde6\udde8-\udded\uddf0-\uddff]|\ud83c\uddf3\ud83c[\udde6\udde8\uddea-\uddec\uddee\uddf1\uddf4\uddf5\uddf7\uddfa\uddff]|\ud83c\uddf4\ud83c\uddf2|\ud83c\uddf5\ud83c[\udde6\uddea-\udded\uddf0-\uddf3\uddf7-\uddf9\uddfc\uddfe]|\ud83c\uddf6\ud83c\udde6|\ud83c\uddf7\ud83c[\uddea\uddf4\uddf8\uddfa\uddfc]|\ud83c\uddf8\ud83c[\udde6-\uddea\uddec-\uddf4\uddf7-\uddf9\uddfb\uddfd-\uddff]|\ud83c\uddf9\ud83c[\udde6\udde8\udde9\uddeb-\udded\uddef-\uddf4\uddf7\uddf9\uddfb\uddfc\uddff]|\ud83c\uddfa\ud83c[\udde6\uddec\uddf2\uddf3\uddf8\uddfe\uddff]|\ud83c\uddfb\ud83c[\udde6\udde8\uddea\uddec\uddee\uddf3\uddfa]|\ud83c\uddfc\ud83c[\uddeb\uddf8]|\ud83c\uddfd\ud83c\uddf0|\ud83c\uddfe\ud83c[\uddea\uddf9]|\ud83c\uddff\ud83c[\udde6\uddf2\uddfc]|\ud83c[\udccf\udd8e\udd91-\udd9a\udde6-\uddff\ude01\ude32-\ude36\ude38-\ude3a\ude50\ude51\udf00-\udf20\udf2d-\udf35\udf37-\udf7c\udf7e-\udf84\udf86-\udf93\udfa0-\udfc1\udfc5\udfc6\udfc8\udfc9\udfcf-\udfd3\udfe0-\udff0\udff4\udff8-\udfff]|\ud83d[\udc00-\udc3e\udc40\udc44\udc45\udc51-\udc65\udc6a\udc6f\udc79-\udc7b\udc7d-\udc80\udc84\udc88-\udca9\udcab-\udcfc\udcff-\udd3d\udd4b-\udd4e\udd50-\udd67\udda4\uddfb-\ude44\ude48-\ude4a\ude80-\udea2\udea4-\udeb3\udeb7-\udebf\udec1-\udec5\uded0-\uded2\uded5-\uded7\udeeb\udeec\udef4-\udefc\udfe0-\udfeb]|\ud83e[\udd0d\udd0e\udd10-\udd17\udd1d\udd20-\udd25\udd27-\udd2f\udd3a\udd3c\udd3f-\udd45\udd47-\udd76\udd78\udd7a-\uddb4\uddb7\uddba\uddbc-\uddcb\uddd0\uddde-\uddff\ude70-\ude74\ude78-\ude7a\ude80-\ude86\ude90-\udea8\udeb0-\udeb6\udec0-\udec2\uded0-\uded6]|[\u23e9-\u23ec\u23f0\u23f3\u267e\u26ce\u2705\u2728\u274c\u274e\u2753-\u2755\u2795-\u2797\u27b0\u27bf\ue50a])|\ufe0f/g,s=/\uFE0F/g,o=String.fromCharCode(8205),n=/[&<>'"]/g,l=/^(?:iframe|noframes|noscript|script|select|style|textarea)$/,a=String.fromCharCode
;return e;function r(e,t){return document.createTextNode(t?e.replace(s,""):e)}function d(e){return e.replace(n,g)}function u(e,t){return"".concat(t.base,t.size,"/",e,t.ext)}function c(e,t){for(var i,s,o=e.childNodes,n=o.length;n--;)3===(s=(i=o[n]).nodeType)?t.push(i):1!==s||"ownerSVGElement"in i||l.test(i.nodeName.toLowerCase())||c(i,t);return t}function h(e){return v(e.indexOf(o)<0?e.replace(s,""):e)}function p(e,t){for(var s,o,n,l,a,d,u,p,_,g,m,b,v,f=c(e,[]),w=f.length;w--;){for(n=!1,l=document.createDocumentFragment(),d=(a=f[w]).nodeValue,p=0;u=i.exec(d);){if((_=u.index)!==p&&l.appendChild(r(d.slice(p,_),!0)),b=h(m=u[0]),p=_+m.length,v=t.callback(b,t),b&&v){for(o in(g=new Image).onerror=t.onerror,g.setAttribute("draggable","false"),s=t.attributes(m,b))s.hasOwnProperty(o)&&0!==o.indexOf("on")&&!g.hasAttribute(o)&&g.setAttribute(o,s[o]);g.className=t.className,g.alt=m,g.src=v,n=!0,l.appendChild(g)}g||l.appendChild(r(m,!1)),g=null}n&&(p<d.length&&l.appendChild(r(d.slice(p),!0)),a.parentNode.replaceChild(l,a))}return e}function _(e,t){return b(e,(function(e){var i,s,o=e,n=h(e),l=t.callback(n,t);if(n&&l){for(s in o="<img ".concat('class="',t.className,'" ','draggable="false" ','alt="',e,'"',' src="',l,'"'),i=t.attributes(e,n))i.hasOwnProperty(s)&&0!==s.indexOf("on")&&-1===o.indexOf(" "+s+"=")&&(o=o.concat(" ",s,'="',d(i[s]),'"'));o=o.concat("/>")}return o}))}function g(e){return t[e]}function m(){return null}function b(e,t){return String(e).replace(i,t)}function v(e,t){for(var i=[],s=0,o=0,n=0;n<e.length;)s=e.charCodeAt(n++),o?(i.push((65536+(o-55296<<10)+(s-56320)).toString(16)),o=0):55296<=s&&s<=56319?o=s:i.push(s.toString(16));return i.join(t||"-")}}()}}]);