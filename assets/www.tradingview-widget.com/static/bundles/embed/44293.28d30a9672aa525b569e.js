"use strict";(self.webpackChunktradingview=self.webpackChunktradingview||[]).push([[44293],{528474:(t,e,i)=>{i.d(e,{blendColors:()=>o});var l=i(724377);const o=(t,e)=>(0,l.rgbaToString)((0,l.blendRgba)((0,l.parseRgba)(t),(0,l.parseRgba)(e)))},49430:(t,e,i)=>{i.d(e,{LollipopTooltipManager:()=>s});var l=i(650279),o=i(650151);class s{constructor(t,e){this._isDestroyed=!1,this._lollipopTooltipRenderer=null,this._activeLollipop=t,this._cardType=e,this._activeLollipop.subscribe((t=>{null===t&&this._destroyTooltip()}))}destroy(){this._destroyTooltip(),this._activeLollipop.release(),this._isDestroyed=!0}tryToHideTooltipByClickOutside(t,e,i){if(!this._isClickInsideTooltip(i)){if(void 0!==i){const o=e(t,i);if(null!==o&&(0,l.default)(o,this._activeLollipop.value()))return}this._activeLollipop.setValue(null)}}async showTooltip(t,e,l,s,n){const a=l();if(null===a||0===a.length)return;const{showLollipopTooltip:r}=await Promise.all([i.e(52742),i.e(83439),i.e(61681),i.e(61171),i.e(19190),i.e(39759),i.e(66032),i.e(52186),i.e(93240),i.e(45868),i.e(84030),i.e(40984),i.e(27290),i.e(63213),i.e(75329),i.e(2353),i.e(14514),i.e(82321),i.e(78017),i.e(49039)]).then(i.bind(i,413369)),h=await s();this._isDestroyed||((0,o.assert)(null===this._lollipopTooltipRenderer,"Lollipop tooltip renderer should be null before creating a new one"),this._lollipopTooltipRenderer=r({items:a,position:e,customCloseSubscriptions:n.customCloseSubscriptions,onClose:()=>n.onClose(t),onClickOutside:e=>n.onClickOutside(t,e),onSizeChanged:n.onSizeChanged,showScrollFades:!0,cardType:this._cardType,theme:h}))}_isClickInsideTooltip(t){return null!==this._lollipopTooltipRenderer&&void 0!==t&&this._lollipopTooltipRenderer.isClickInside(t)}_destroyTooltip(){this._lollipopTooltipRenderer?.hide(),this._lollipopTooltipRenderer=null}}},448381:(t,e,i)=>{function l(t,e,i=0){e.setValue(t.value());const l={};return t.subscribe(l,(t=>{e.setValue(t.value())})),1===i&&e.subscribe(l,(e=>{t.setValue(e.value())})),()=>{t.unsubscribeAll(l),1===i&&e.unsubscribeAll(l)}}i.d(e,{bindProperties:()=>l})},437199:(t,e,i)=>{i.d(e,{LollipopPaneView:()=>b});var l=i(650279),o=i(743068),s=i(650151),n=i(610555),a=i(536794),r=i(751094),h=i(312520),d=i(49430),p=i(731974),c=i(708162),_=i(398453),u=i(183634),y=i(960433),v=i(765935);class b{constructor(t,e){this._invalidated=!1,this._renderer=new c.CompositeRenderer,this._textWidthCache=new y.TextWidthCache,this._stylesCache=null,this._lollipops={},this._lollipopsCounter=0,this._activeLollipopInfo=new r.WatchedObject(null),this.onPaneBgChange=()=>{this._recreateStyles(this._model)},this._model=t,this._source=e,this._recreateStyles(t),t.backgroundColor().subscribe(this.onPaneBgChange),t.mainSeries().onSymbolIntervalChanged().subscribe(this,this._onSymbolOrIntervalChanged),this._lollipopTooltip=new d.LollipopTooltipManager(this._activeLollipopInfo.spawnOwnership()),this._activeLollipopInfo.subscribe((()=>{this._source.updateAllViewsAndRepaint()}))}destroy(){this._model.backgroundColor().unsubscribe(this.onPaneBgChange),
this._model.mainSeries().onSymbolIntervalChanged().unsubscribeAll(this),this._lollipopTooltip.destroy()}processClickInside(t,e,i){const l=this._lollipops[i];return!(!l||!l.visible)&&(this._lollipopMouseClickHandler(t,this._getLollipopRendererData(l),(0,o.size)({width:e.clientWidth,height:e.clientHeight}),{preventDefault:()=>{},target:e}),!0)}processClickOutside(t,e){this._lollipopTooltip.tryToHideTooltipByClickOutside(t,this._getActiveLollipopTooltipInfo.bind(this),e)}update(t){this._invalidated=!0}afterUpdate(t,e,i,l){}getStyle(t,e){let i=e;if(t.stack&&(i+="_stack:"+t.stack),"active"===i)return this._activeStyle;if("hovered"===i)return this._hoveredStyle;if("default"===i)return this._defaultStyle;if(this._stylesCache||(this._stylesCache={}),!this._stylesCache[i]){const l=(0,a.clone)("active"===e?this._activeStyle:"hovered"===e?this._hoveredStyle:this._defaultStyle);t.stack&&(l.lollipop.incHeight=25*t.stack),this._stylesCache[i]=l}return this._stylesCache[i]}hasTooltip(t){return!0}clearActiveLollipop(){this._activeLollipopInfo.setValue(null)}async _specialTooltipStyles(t){}_getY(){let t=0;const e=this._model.panes();for(let i=e.length;i--;){const l=e[i];l.containsMainSeries()&&(t+=l.height())}return t}_showBarLine(t){return this.hasTooltip(t)&&(t.hovered||this._isLollipopActive(t))}_getLollipopRendererData(t){const e=this._getLollipopStatus(t),i=this.getStyle(t,e);return{id:t.id,itemIndex:t.itemIndex,centerPoint:new n.Point(t.basePoint.x,t.basePoint.y-i.lollipop.bottom-i.lollipop.height/2-(i.lollipop.incHeight||0)),style:i,status:e}}_createRenderers(t){const{mediaSize:e}=t;for(const i of Object.values(this._lollipops))if(void 0!==i&&i.visible){const l=this._getLollipopStatus(i),o=this.getStyle(i,l),s={id:i.id,itemIndex:i.itemIndex,centerPoint:new n.Point(i.basePoint.x,i.basePoint.y-o.lollipop.bottom-o.lollipop.height/2-(o.lollipop.incHeight||0)),style:o,status:l},a={cursorType:v.PaneCursorType.Default,activeItem:{id:i.id,itemIndex:i.itemIndex},hideCrosshairLinesOnHover:!0,clickHandler:(i,l)=>this._lollipopMouseClickHandler(t,s,e,i),tapHandler:(i,l)=>this._lollipopMouseClickHandler(t,s,e,i)};if(this._renderer.append(this._createRendererForLollipop(s,a)),this._showBarLine(i)){const{strokeStyle:t,lineStyle:e,lineWidth:l}=o.barLine,s={color:t,linestyle:e,linewidth:l,x:i.basePoint.x,top:0,bottom:i.basePoint.y-o.lollipop.bottom-o.lollipop.height},n=new u.VerticalLineRenderer;n.setData(s),this._renderer.insert(n,0)}}}_recreateStyles(t){this._stylesCache=null}_createRendererForLollipop(t,e){return new _.LollipopRenderer(t,new p.HitTestResult(p.HitTarget.Custom,e),this._textWidthCache)}_onSymbolOrIntervalChanged(){this._lollipops={},this._lollipopsCounter=0,this._renderer.clear(),this._activeLollipopInfo.setValue(null)}async _lollipopMouseClickHandler(t,e,i,o){o.preventDefault();const a={id:e.id,itemIndex:e.itemIndex};if((0,l.default)(this._activeLollipopInfo.value(),a))return void this._activeLollipopInfo.setValue(null);this._activeLollipopInfo.setValue(a);const r={target:o.target,targetSize:i,
point:new n.Point(e.centerPoint.x,e.centerPoint.y-e.style.lollipop.height/2-8),marginTop:15},h=(0,s.ensureDefined)(this._lollipops[e.id]),d=this._model.timeScale();this._lollipopTooltip.showTooltip(t,r,(()=>this._createTooltipContent(h)),(()=>this._specialTooltipStyles(h)),{onClose:this.processClickOutside.bind(this),onClickOutside:(t,e)=>{this._source.onClickOutside?.(t,(0,s.ensureDefined)(e))},customCloseSubscriptions:[d.onScroll(),d.barSpacingChanged(),this._model.mainSeries().onSymbolIntervalChanged()],onSizeChanged:(0,s.ensureNotNull)(this._model.paneForSource(this._source)).onSizeChanged()})}_getLollipopStatus(t){return this._isLollipopActive(t)?"active":t.hovered?"hovered":"default"}_isLollipopActive(t){return null!==this._activeLollipopInfo.value()&&(0,l.default)(this._activeLollipopInfo.value(),{id:t.id,itemIndex:t.itemIndex})}_getActiveLollipopTooltipInfo(t,e){const i=(0,h.getClickPosition)(e);if(null===i)return null;const l=this.renderer(t)?.hitTest(new n.Point(i.x,i.y),t)?.data()?.activeItem??null;return null===l?null:l}}},398453:(t,e,i)=>{i.d(e,{LollipopRenderer:()=>h});var l=i(906453),o=i(610555),s=i(257145),n=i(338242),a=i(688857),r=i(65840);class h{constructor(t,e,i){this._data=t,this._hittest=e,this._textWidthCache=i}draw(t,e){const{horizontalPixelRatio:i,verticalPixelRatio:l}=e,s=this._data.centerPoint,n=Math.round(s.x*i),a=Math.round(s.y*l),r=Math.max(1,Math.floor(i))%2/2,h=Math.max(1,Math.floor(l))%2/2,d=new o.Point(n+r,a-h);this._drawLollipop(t,d,e),this._drawLabel(t,d,e)}hitTest(t){const e=(0,r.interactionTolerance)().esd,i=this._data.centerPoint.y-this._data.style.lollipop.height/2-e,s=this._data.centerPoint.x-this._data.style.lollipop.width/2-e,n=(0,o.box)(new o.Point(s,i),new o.Point(s+this._data.style.lollipop.width+2*e,i+this._data.style.lollipop.height+2*e));return(0,l.pointInBox)(t,n)?this._hittest:null}_drawLollipop(t,e,i){const l=this._data.style,{horizontalPixelRatio:o}=i,s=this._fillRadius(o);l.lollipop.fillCircle&&l.lollipop.backgroundColor&&this._drawFilledCircle(t,e,s,l.lollipop.backgroundColor);const n=Math.round(l.lollipop.lineWidth*o),a=s-Math.round(1*o+n/2);this._drawBorderLine(t,e,n,a),l.lollipop.fillCircle&&l.lollipop.fillStyle&&this._drawFilledCircle(t,e,a,l.lollipop.fillStyle)}_drawLabel(t,e,i){const l=this._data.style.lollipop.text,o=l.label;if(""===o)return;const{horizontalPixelRatio:s,verticalPixelRatio:n}=i;t.textAlign="center",t.textBaseline="middle",t.fillStyle=l.strokeStyle,t.font=l.font;const r=this._textWidthCache.yMidCorrection(t,o);t.translate(e.x,e.y+((l.deltaY||0)+r)*n),(0,a.drawScaled)(t,s,n,(()=>{t.fillText(o,0,0)}))}_fillRadius(t){const e=this._data.style,i=Math.max(1,Math.floor(t));let l=Math.round(e.lollipop.width*t);return l%2!=i%2&&(l+=1),l/2}_drawBorderLine(t,e,i,l){const o=this._data.style;t.strokeStyle=o.lollipop.strokeStyle,t.lineWidth=i,(0,n.setLineStyle)(t,s.LINESTYLE_SOLID),(0,n.createCircle)(t,e.x,e.y,l),t.stroke()}_drawFilledCircle(t,e,i,l){t.fillStyle=l,(0,n.createCircle)(t,e.x,e.y,i),t.fill()}}},183634:(t,e,i)=>{i.d(e,{
VerticalLineRenderer:()=>r});var l=i(731974),o=i(338242),s=i(65840),n=i(688857),a=i(320994);class r extends a.BitmapCoordinatesPaneRenderer{constructor(){super(...arguments),this._data=null,this._hitTest=new l.HitTestResult(l.HitTarget.MovePoint)}setData(t){this._data=t}setHitTest(t){this._hitTest=t}hitTest(t){if(null===this._data||null===this._hitTest)return null;const e=(0,s.interactionTolerance)().line,i=Math.abs(t.x-this._data.x)<=e+this._data.linewidth/2,l=void 0===this._data.top||this._data.top-t.y<=e,o=void 0===this._data.bottom||t.y-this._data.bottom<=e;return i&&l&&o?this._hitTest:null}_drawImpl(t){if(null===this._data||this._data.linewidth<=0)return;const{context:e,horizontalPixelRatio:i,verticalPixelRatio:l,mediaSize:s}=t;if(this._data.x<-this._data.linewidth/2||this._data.x>s.width+this._data.linewidth/2)return;e.lineCap="butt",e.strokeStyle=this._data.color,e.lineWidth=Math.max(1,Math.floor(this._data.linewidth*i)),void 0!==this._data.linestyle&&(0,o.setLineStyle)(e,this._data.linestyle);const a=void 0!==this._data.top?Math.max(this._data.top,0):0,r=void 0!==this._data.bottom?Math.min(this._data.bottom,s.height):s.height,h=Math.round(this._data.x*i),d=Math.floor(a*l),p=Math.ceil(r*l),c=this._data.excludeBoundaries;void 0!==c&&(0,n.addExclusionAreaByScope)(t,c),(0,o.drawVerticalLine)(e,h,d,p)}}}}]);